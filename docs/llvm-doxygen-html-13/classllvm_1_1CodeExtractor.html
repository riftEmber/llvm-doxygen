<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: llvm::CodeExtractor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLVM<span id="projectnumber">&#160;13.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacellvm.html">llvm</a></li><li class="navelem"><a class="el" href="classllvm_1_1CodeExtractor.html">CodeExtractor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classllvm_1_1CodeExtractor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">llvm::CodeExtractor Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Utility class for extracting code into a new function.  
 <a href="#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="CodeExtractor_8h_source.html">llvm/Transforms/Utils/CodeExtractor.h</a>&quot;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a493397e916c5ad9382c1a3d723148eef" id="r_a493397e916c5ad9382c1a3d723148eef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a493397e916c5ad9382c1a3d723148eef">CodeExtractor</a> (<a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> * &gt; BBs, <a class="el" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *DT=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classbool.html">bool</a> AggregateArgs=false, <a class="el" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *BFI=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classllvm_1_1BranchProbabilityInfo.html">BranchProbabilityInfo</a> *BPI=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *AC=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classbool.html">bool</a> AllowVarArgs=false, <a class="el" href="classbool.html">bool</a> <a class="el" href="classllvm_1_1ilist__node__impl.html">AllowAlloca</a>=false, std::string Suffix=&quot;&quot;)</td></tr>
<tr class="memdesc:a493397e916c5ad9382c1a3d723148eef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a code extractor for a sequence of blocks.  <br /></td></tr>
<tr class="separator:a493397e916c5ad9382c1a3d723148eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ae1b1aae5ec63bc2b6710f898cecc8" id="r_a52ae1b1aae5ec63bc2b6710f898cecc8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52ae1b1aae5ec63bc2b6710f898cecc8">CodeExtractor</a> (<a class="el" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;DT, <a class="el" href="classllvm_1_1Loop.html">Loop</a> &amp;L, <a class="el" href="classbool.html">bool</a> AggregateArgs=false, <a class="el" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *BFI=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classllvm_1_1BranchProbabilityInfo.html">BranchProbabilityInfo</a> *BPI=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, <a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *AC=<a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a>, std::string Suffix=&quot;&quot;)</td></tr>
<tr class="memdesc:a52ae1b1aae5ec63bc2b6710f898cecc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a code extractor for a loop body.  <br /></td></tr>
<tr class="separator:a52ae1b1aae5ec63bc2b6710f898cecc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8561c48aa0b397c37f9e071dad7df392" id="r_a8561c48aa0b397c37f9e071dad7df392"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classllvm_1_1Function.html">Function</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8561c48aa0b397c37f9e071dad7df392">extractCodeRegion</a> (<a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">CEAC</a>)</td></tr>
<tr class="memdesc:a8561c48aa0b397c37f9e071dad7df392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the extraction, returning the new function.  <br /></td></tr>
<tr class="separator:a8561c48aa0b397c37f9e071dad7df392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a4770e725305d3529cba8c6562c85a" id="r_ad3a4770e725305d3529cba8c6562c85a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3a4770e725305d3529cba8c6562c85a">isEligible</a> () <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></td></tr>
<tr class="memdesc:ad3a4770e725305d3529cba8c6562c85a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether this code extractor is eligible.  <br /></td></tr>
<tr class="separator:ad3a4770e725305d3529cba8c6562c85a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3719f9e5392a61378d7815a6c346abda" id="r_a3719f9e5392a61378d7815a6c346abda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvoid.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3719f9e5392a61378d7815a6c346abda">findInputsOutputs</a> (<a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;Inputs, <a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">Outputs</a>, <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;Allocas) <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></td></tr>
<tr class="memdesc:a3719f9e5392a61378d7815a6c346abda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the set of input values and output values for the code.  <br /></td></tr>
<tr class="separator:a3719f9e5392a61378d7815a6c346abda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ce92095ff18cb2c607d5a3591703ca" id="r_ae9ce92095ff18cb2c607d5a3591703ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9ce92095ff18cb2c607d5a3591703ca">isLegalToShrinkwrapLifetimeMarkers</a> (<a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">CEAC</a>, <a class="el" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="el" href="classllvm_1_1ilist__node__impl.html">AllocaAddr</a>) <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></td></tr>
<tr class="memdesc:ae9ce92095ff18cb2c607d5a3591703ca"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespacellvm_1_1Check.html">Check</a> if life time marker nodes can be hoisted/sunk into the outline region.  <br /></td></tr>
<tr class="separator:ae9ce92095ff18cb2c607d5a3591703ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537993928c8af5b0d064fcd5ce1dec2f" id="r_a537993928c8af5b0d064fcd5ce1dec2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvoid.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a537993928c8af5b0d064fcd5ce1dec2f">findAllocas</a> (<a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">CEAC</a>, <a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">SinkCands</a>, <a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;<a class="el" href="classllvm_1_1ilist__node__impl.html">HoistCands</a>, <a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *&amp;ExitBlock) <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></td></tr>
<tr class="memdesc:a537993928c8af5b0d064fcd5ce1dec2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the set of allocas whose life ranges are contained within the outlined region.  <br /></td></tr>
<tr class="separator:a537993928c8af5b0d064fcd5ce1dec2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ce83f3f1fef433e2ba91a0b2a196a0" id="r_a19ce83f3f1fef433e2ba91a0b2a196a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19ce83f3f1fef433e2ba91a0b2a196a0">findOrCreateBlockForHoisting</a> (<a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="el" href="classllvm_1_1ilist__node__impl.html">CommonExitBlock</a>)</td></tr>
<tr class="memdesc:a19ce83f3f1fef433e2ba91a0b2a196a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find or create a block within the outline region for placing hoisted code.  <br /></td></tr>
<tr class="separator:a19ce83f3f1fef433e2ba91a0b2a196a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a995ee70f3e9a0cb350322bb1e058a707" id="r_a995ee70f3e9a0cb350322bb1e058a707"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classllvm_1_1ilist__node__impl.html">static</a> <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a995ee70f3e9a0cb350322bb1e058a707">verifyAssumptionCache</a> (<a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1Function.html">Function</a> &amp;OldFunc, <a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1Function.html">Function</a> &amp;NewFunc, <a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *AC)</td></tr>
<tr class="memdesc:a995ee70f3e9a0cb350322bb1e058a707"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify that assumption cache isn't stale after a region is extracted.  <br /></td></tr>
<tr class="separator:a995ee70f3e9a0cb350322bb1e058a707"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utility class for extracting code into a new function. </p>
<p>This utility provides a simple interface for extracting some sequence of code into its own function, replacing it with a call to that function. It also provides various methods to query about the nature and result of such a transformation.</p>
<p>The rough algorithm used is: 1) Find both the inputs and outputs for the extracted region. 2) <a class="el" href="classllvm_1_1Pass.html" title="Pass interface - Implemented by all &#39;passes&#39;.">Pass</a> the inputs as arguments, remapping them within the extracted function to arguments. 3) Add allocas for any scalar outputs, adding all of the outputs' allocas as arguments, and inserting stores to the arguments for any scalars. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8h_source.html#l00085">85</a> of file <a class="el" href="CodeExtractor_8h_source.html">CodeExtractor.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a493397e916c5ad9382c1a3d723148eef" name="a493397e916c5ad9382c1a3d723148eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a493397e916c5ad9382c1a3d723148eef">&#9670;&#160;</a></span>CodeExtractor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CodeExtractor::CodeExtractor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> * &gt;</td>          <td class="paramname"><span class="paramname"><em>BBs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1DominatorTree.html">DominatorTree</a> *</td>          <td class="paramname"><span class="paramname"><em>DT</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>AggregateArgs</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>BFI</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BranchProbabilityInfo.html">BranchProbabilityInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>BPI</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *</td>          <td class="paramname"><span class="paramname"><em>AC</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>AllowVarArgs</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>AllowAlloca</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>Suffix</em><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a code extractor for a sequence of blocks. </p>
<p>Given a sequence of basic blocks where the first block in the sequence dominates the rest, prepare a code extractor object for pulling this sequence out into its new function. When a <a class="el" href="classllvm_1_1DominatorTree.html" title="Concrete subclass of DominatorTreeBase that is used to compute a normal dominator tree.">DominatorTree</a> is also given, extra checking and transformations are enabled. If AllowVarArgs is true, vararg functions can be extracted. This is safe, if all vararg handling code is extracted, including vastart. If AllowAlloca is true, then extraction of blocks containing alloca instructions would be possible, however code extractor won't validate whether extraction is legal. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00247">247</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

</div>
</div>
<a id="a52ae1b1aae5ec63bc2b6710f898cecc8" name="a52ae1b1aae5ec63bc2b6710f898cecc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ae1b1aae5ec63bc2b6710f898cecc8">&#9670;&#160;</a></span>CodeExtractor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CodeExtractor::CodeExtractor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1DominatorTree.html">DominatorTree</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>DT</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1Loop.html">Loop</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>L</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a></td>          <td class="paramname"><span class="paramname"><em>AggregateArgs</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BlockFrequencyInfo.html">BlockFrequencyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>BFI</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BranchProbabilityInfo.html">BranchProbabilityInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>BPI</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *</td>          <td class="paramname"><span class="paramname"><em>AC</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="classllvm_1_1ilist__node__impl.html">nullptr</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>Suffix</em><span class="paramdefsep"> = </span><span class="paramdefval">&quot;&quot;</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a code extractor for a loop body. </p>
<p>Behaves just like the generic code sequence constructor, but uses the block sequence of the loop. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00257">257</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8561c48aa0b397c37f9e071dad7df392" name="a8561c48aa0b397c37f9e071dad7df392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8561c48aa0b397c37f9e071dad7df392">&#9670;&#160;</a></span>extractCodeRegion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classllvm_1_1Function.html">Function</a> * CodeExtractor::extractCodeRegion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>CEAC</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the extraction, returning the new function. </p>
<p>Returns zero when called on a <a class="el" href="classllvm_1_1CodeExtractor.html" title="Utility class for extracting code into a new function.">CodeExtractor</a> instance where isEligible returns false. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l01571">1571</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="STLExtras_8h_source.html#l01541">llvm::any_of()</a>, <a class="el" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert()</a>, <a class="el" href="BasicBlock_8h_source.html#l00296">llvm::BasicBlock::begin()</a>, <a class="el" href="namespacellvm.html#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">llvm::Block</a>, <a class="el" href="Instructions_8h_source.html#l03088">llvm::BranchInst::Create()</a>, <a class="el" href="BasicBlock_8h_source.html#l00100">llvm::BasicBlock::Create()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l01043">eraseLifetimeMarkersOnInputs()</a>, <a class="el" href="raw__ostream_8cpp_source.html#l00892">llvm::errs()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00494">findAllocas()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00646">findInputsOutputs()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00388">findOrCreateBlockForHoisting()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l01466">fixupDebugInfoPostExtraction()</a>, <a class="el" href="BlockFrequencyInfo_8cpp_source.html#l00204">llvm::BlockFrequencyInfo::getBlockFreq()</a>, <a class="el" href="BasicBlock_8cpp_source.html#l00032">llvm::BasicBlock::getContext()</a>, <a class="el" href="BranchProbabilityInfo_8cpp_source.html#l01113">llvm::BranchProbabilityInfo::getEdgeProbability()</a>, <a class="el" href="BlockFrequency_8h_source.html#l00035">llvm::BlockFrequency::getFrequency()</a>, <a class="el" href="Instructions_8h_source.html#l02713">llvm::PHINode::getIncomingBlock()</a>, <a class="el" href="Instructions_8h_source.html#l02693">llvm::PHINode::getIncomingValue()</a>, <a class="el" href="Instructions_8h_source.html#l02689">llvm::PHINode::getNumIncomingValues()</a>, <a class="el" href="BasicBlock_8h_source.html#l00107">llvm::BasicBlock::getParent()</a>, <a class="el" href="BlockFrequencyInfo_8cpp_source.html#l00218">llvm::BlockFrequencyInfo::getProfileCountFromFreq()</a>, <a class="el" href="BasicBlock_8cpp_source.html#l00148">llvm::BasicBlock::getTerminator()</a>, <a class="el" href="MD5_8cpp_source.html#l00059">I</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l01069">insertLifetimeMarkersSurroundingCall()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00619">isEligible()</a>, <a class="el" href="Debug_8h_source.html#l00122">LLVM_DEBUG</a>, <a class="el" href="STLExtras_8h_source.html#l01548">llvm::none_of()</a>, <a class="el" href="Function_8h_source.html#l00288">llvm::Function::PCT_Real</a>, <a class="el" href="IR_2CFG_8h_source.html#l00127">llvm::predecessors()</a>, <a class="el" href="Testing_2Support_2Error_8cpp_source.html#l00140">llvm::report_fatal_error()</a>, <a class="el" href="BlockFrequencyInfo_8cpp_source.html#l00229">llvm::BlockFrequencyInfo::setBlockFreq()</a>, <a class="el" href="Instructions_8h_source.html#l02732">llvm::PHINode::setIncomingBlock()</a>, <a class="el" href="IR_2CFG_8h_source.html#l00262">llvm::successors()</a>, <a class="el" href="AssumptionCache_8cpp_source.html#l00142">llvm::AssumptionCache::unregisterAssumption()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l01783">verifyAssumptionCache()</a>, and <a class="el" href="Verifier_8cpp_source.html#l05727">llvm::verifyFunction()</a>.</p>

</div>
</div>
<a id="a537993928c8af5b0d064fcd5ce1dec2f" name="a537993928c8af5b0d064fcd5ce1dec2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a537993928c8af5b0d064fcd5ce1dec2f">&#9670;&#160;</a></span>findAllocas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classvoid.html">void</a> CodeExtractor::findAllocas </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>CEAC</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>SinkCands</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>HoistCands</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *&amp;</td>          <td class="paramname"><span class="paramname"><em>ExitBlock</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the set of allocas whose life ranges are contained within the outlined region. </p>
<p>Allocas which have life_time markers contained in the outlined region should be pushed to the outlined function. The address bitcasts that are used by the lifetime markers are also candidates for shrink- wrapping. The instructions that need to be sunk are collected in 'Allocas'. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00494">494</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert()</a>, <a class="el" href="Instructions_8cpp_source.html#l03058">llvm::CastInst::CreatePointerCast()</a>, <a class="el" href="Debug_8cpp_source.html#l00163">llvm::dbgs()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00270">definedInRegion()</a>, <a class="el" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00288">getCommonExitBlock()</a>, <a class="el" href="Type_8cpp_source.html#l00255">llvm::Type::getInt8PtrTy()</a>, <a class="el" href="BasicBlock_8h_source.html#l00107">llvm::BasicBlock::getParent()</a>, <a class="el" href="BasicAliasAnalysis_8cpp_source.html#l00776">getParent()</a>, <a class="el" href="MD5_8cpp_source.html#l00059">I</a>, and <a class="el" href="Debug_8h_source.html#l00122">LLVM_DEBUG</a>.</p>

<p class="reference">Referenced by <a class="el" href="CodeExtractor_8cpp_source.html#l01571">extractCodeRegion()</a>.</p>

</div>
</div>
<a id="a3719f9e5392a61378d7815a6c346abda" name="a3719f9e5392a61378d7815a6c346abda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3719f9e5392a61378d7815a6c346abda">&#9670;&#160;</a></span>findInputsOutputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classvoid.html">void</a> CodeExtractor::findInputsOutputs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>Inputs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>Outputs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1SetVector.html">ValueSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>Allocas</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the set of input values and output values for the code. </p>
<p>These can be used either when performing the extraction or to evaluate the expected size of a call to the extracted function. Note that this work cannot be cached between the two as once we decide to extract a code sequence, that sequence is modified, including changing these sets, before extraction occurs. These modifications won't have any significant impact on the cost however. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00646">646</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="CodeExtractor_8cpp_source.html#l00280">definedInCaller()</a>, <a class="el" href="CodeExtractor_8cpp_source.html#l00270">definedInRegion()</a>, and <a class="el" href="SetVector_8h_source.html#l00141">llvm::SetVector&lt; T, Vector, Set &gt;::insert()</a>.</p>

<p class="reference">Referenced by <a class="el" href="CodeExtractor_8cpp_source.html#l01571">extractCodeRegion()</a>.</p>

</div>
</div>
<a id="a19ce83f3f1fef433e2ba91a0b2a196a0" name="a19ce83f3f1fef433e2ba91a0b2a196a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ce83f3f1fef433e2ba91a0b2a196a0">&#9670;&#160;</a></span>findOrCreateBlockForHoisting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> * CodeExtractor::findOrCreateBlockForHoisting </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *</td>          <td class="paramname"><span class="paramname"><em>CommonExitBlock</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find or create a block within the outline region for placing hoisted code. </p>
<p>CommonExitBlock is block outside the outline region. It is the common successor of blocks inside the region. If there exists a single block inside the region that is the predecessor of CommonExitBlock, that block will be returned. Otherwise CommonExitBlock will be split and the original block will be added to the outline region. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00388">388</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert()</a>, <a class="el" href="BasicBlock_8h_source.html#l00296">llvm::BasicBlock::begin()</a>, <a class="el" href="BasicBlock_8h_source.html#l00298">llvm::BasicBlock::end()</a>, <a class="el" href="ilist__node_8h_source.html#l00081">llvm::ilist_node_impl&lt; OptionsT &gt;::getIterator()</a>, <a class="el" href="MD5_8cpp_source.html#l00059">I</a>, <a class="el" href="STLExtras_8h_source.html#l00572">llvm::make_early_inc_range()</a>, and <a class="el" href="IR_2CFG_8h_source.html#l00127">llvm::predecessors()</a>.</p>

<p class="reference">Referenced by <a class="el" href="CodeExtractor_8cpp_source.html#l01571">extractCodeRegion()</a>.</p>

</div>
</div>
<a id="ad3a4770e725305d3529cba8c6562c85a" name="ad3a4770e725305d3529cba8c6562c85a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a4770e725305d3529cba8c6562c85a">&#9670;&#160;</a></span>isEligible()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> CodeExtractor::isEligible </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether this code extractor is eligible. </p>
<p>Based on the blocks used when constructing the code extractor, determine whether it is eligible for extraction.</p>
<p>Checks that varargs handling (with vastart and vaend) is only done in the outlined blocks. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00619">619</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="STLExtras_8h_source.html#l01541">llvm::any_of()</a>, <a class="el" href="AMDGPULibCalls_8cpp_source.html#l00206">Callee</a>, <a class="el" href="MD5_8cpp_source.html#l00056">F</a>, <a class="el" href="BasicBlock_8h_source.html#l00107">llvm::BasicBlock::getParent()</a>, and <a class="el" href="MD5_8cpp_source.html#l00059">I</a>.</p>

<p class="reference">Referenced by <a class="el" href="CodeExtractor_8cpp_source.html#l01571">extractCodeRegion()</a>.</p>

</div>
</div>
<a id="ae9ce92095ff18cb2c607d5a3591703ca" name="ae9ce92095ff18cb2c607d5a3591703ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ce92095ff18cb2c607d5a3591703ca">&#9670;&#160;</a></span>isLegalToShrinkwrapLifetimeMarkers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> CodeExtractor::isLegalToShrinkwrapLifetimeMarkers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1CodeExtractorAnalysisCache.html">CodeExtractorAnalysisCache</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>CEAC</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1Instruction.html">Instruction</a> *</td>          <td class="paramname"><span class="paramname"><em>AllocaAddr</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespacellvm_1_1Check.html">Check</a> if life time marker nodes can be hoisted/sunk into the outline region. </p>
<p>Returns true if it is safe to do the code motion. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l00374">374</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="ELFObjHandler_8cpp_source.html#l00080">Addr</a>, and <a class="el" href="BasicAliasAnalysis_8cpp_source.html#l00776">getParent()</a>.</p>

</div>
</div>
<a id="a995ee70f3e9a0cb350322bb1e058a707" name="a995ee70f3e9a0cb350322bb1e058a707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995ee70f3e9a0cb350322bb1e058a707">&#9670;&#160;</a></span>verifyAssumptionCache()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> CodeExtractor::verifyAssumptionCache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1Function.html">Function</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>OldFunc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="el" href="classllvm_1_1Function.html">Function</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>NewFunc</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> *</td>          <td class="paramname"><span class="paramname"><em>AC</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verify that assumption cache isn't stale after a region is extracted. </p>
<p>Returns true when verifier finds errors. <a class="el" href="classllvm_1_1AssumptionCache.html" title="A cache of @llvm.assume calls within a function.">AssumptionCache</a> is passed as parameter to make this function stateless. </p>

<p class="definition">Definition at line <a class="el" href="CodeExtractor_8cpp_source.html#l01783">1783</a> of file <a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a>.</p>

<p class="reference">References <a class="el" href="AssumptionCache_8h_source.html#l00146">llvm::AssumptionCache::assumptions()</a>, <a class="el" href="AssumptionCache_8h_source.html#l00153">llvm::AssumptionCache::assumptionsFor()</a>, and <a class="el" href="MD5_8cpp_source.html#l00059">I</a>.</p>

<p class="reference">Referenced by <a class="el" href="CodeExtractor_8cpp_source.html#l01571">extractCodeRegion()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/llvm/Transforms/Utils/<a class="el" href="CodeExtractor_8h_source.html">CodeExtractor.h</a></li>
<li>lib/Transforms/Utils/<a class="el" href="CodeExtractor_8cpp_source.html">CodeExtractor.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 20 2024 17:56:52 for LLVM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
