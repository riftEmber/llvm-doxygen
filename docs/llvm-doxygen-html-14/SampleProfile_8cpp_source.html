<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/IPO/SampleProfile.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLVM<span id="projectnumber">&#160;14.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_13abb262e9c52ddea8d07639819afd6c.html">IPO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">SampleProfile.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="SampleProfile_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//===- SampleProfile.cpp - Incorporate sample profiles into the IR --------===//</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// This file implements the SampleProfileLoader transformation. This pass</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// reads a profile file generated by a sampling profiler (e.g. Linux Perf -</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// http://perf.wiki.kernel.org/) and generates IR metadata to reflect the</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">// profile information in the given profile.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">//</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// This pass generates branch weight annotations on the IR:</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">//</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// - prof: Represents branch weights. This annotation is added to branches</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">//      to indicate the weights of each edge coming out of the branch.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">//      The weight of each edge is the weight of the target block for</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">//      that edge. The weight of a block B is computed as the maximum</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">//      number of samples found in B.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">//</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfile_8h.html">llvm/Transforms/IPO/SampleProfile.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="ArrayRef_8h.html">llvm/ADT/ArrayRef.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="DenseSet_8h.html">llvm/ADT/DenseSet.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="None_8h.html">llvm/ADT/None.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="PriorityQueue_8h.html">llvm/ADT/PriorityQueue.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="SCCIterator_8h.html">llvm/ADT/SCCIterator.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="Statistic_8h.html">llvm/ADT/Statistic.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="StringMap_8h.html">llvm/ADT/StringMap.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="Twine_8h.html">llvm/ADT/Twine.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="AssumptionCache_8h.html">llvm/Analysis/AssumptionCache.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="BlockFrequencyInfoImpl_8h.html">llvm/Analysis/BlockFrequencyInfoImpl.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="CallGraph_8h.html">llvm/Analysis/CallGraph.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="CallGraphSCCPass_8h.html">llvm/Analysis/CallGraphSCCPass.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;<a class="code" href="InlineAdvisor_8h.html">llvm/Analysis/InlineAdvisor.h</a>&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="InlineCost_8h.html">llvm/Analysis/InlineCost.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;<a class="code" href="LoopInfo_8h.html">llvm/Analysis/LoopInfo.h</a>&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="PostDominators_8h.html">llvm/Analysis/PostDominators.h</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;<a class="code" href="ProfileSummaryInfo_8h.html">llvm/Analysis/ProfileSummaryInfo.h</a>&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &quot;<a class="code" href="ReplayInlineAdvisor_8h.html">llvm/Analysis/ReplayInlineAdvisor.h</a>&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;<a class="code" href="TargetLibraryInfo_8h.html">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;<a class="code" href="DebugInfoMetadata_8h.html">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="DebugLoc_8h.html">llvm/IR/DebugLoc.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &quot;<a class="code" href="DiagnosticInfo_8h.html">llvm/IR/DiagnosticInfo.h</a>&quot;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="Dominators_8h.html">llvm/IR/Dominators.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#include &quot;<a class="code" href="MDBuilder_8h.html">llvm/IR/MDBuilder.h</a>&quot;</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">#include &quot;<a class="code" href="PassManager_8h.html">llvm/IR/PassManager.h</a>&quot;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#include &quot;<a class="code" href="ValueSymbolTable_8h.html">llvm/IR/ValueSymbolTable.h</a>&quot;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#include &quot;<a class="code" href="InstrProf_8h.html">llvm/ProfileData/InstrProf.h</a>&quot;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProf_8h.html">llvm/ProfileData/SampleProf.h</a>&quot;</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfReader_8h.html">llvm/ProfileData/SampleProfReader.h</a>&quot;</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="preprocessor">#include &quot;<a class="code" href="CommandLine_8h.html">llvm/Support/CommandLine.h</a>&quot;</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="preprocessor">#include &quot;<a class="code" href="llvm_2Support_2ErrorHandling_8h.html">llvm/Support/ErrorHandling.h</a>&quot;</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="preprocessor">#include &quot;<a class="code" href="ErrorOr_8h.html">llvm/Support/ErrorOr.h</a>&quot;</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="preprocessor">#include &quot;<a class="code" href="GenericDomTree_8h.html">llvm/Support/GenericDomTree.h</a>&quot;</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="preprocessor">#include &quot;<a class="code" href="llvm_2Transforms_2IPO_8h.html">llvm/Transforms/IPO.h</a>&quot;</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="preprocessor">#include &quot;<a class="code" href="ProfiledCallGraph_8h.html">llvm/Transforms/IPO/ProfiledCallGraph.h</a>&quot;</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="preprocessor">#include &quot;<a class="code" href="SampleContextTracker_8h.html">llvm/Transforms/IPO/SampleContextTracker.h</a>&quot;</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfileProbe_8h.html">llvm/Transforms/IPO/SampleProfileProbe.h</a>&quot;</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="preprocessor">#include &quot;<a class="code" href="Instrumentation_8h.html">llvm/Transforms/Instrumentation.h</a>&quot;</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="preprocessor">#include &quot;<a class="code" href="CallPromotionUtils_8h.html">llvm/Transforms/Utils/CallPromotionUtils.h</a>&quot;</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="preprocessor">#include &quot;<a class="code" href="Cloning_8h.html">llvm/Transforms/Utils/Cloning.h</a>&quot;</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfileInference_8h.html">llvm/Transforms/Utils/SampleProfileInference.h</a>&quot;</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfileLoaderBaseImpl_8h.html">llvm/Transforms/Utils/SampleProfileLoaderBaseImpl.h</a>&quot;</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="preprocessor">#include &quot;<a class="code" href="SampleProfileLoaderBaseUtil_8h.html">llvm/Transforms/Utils/SampleProfileLoaderBaseUtil.h</a>&quot;</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="preprocessor">#include &lt;system_error&gt;</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="keyword">using namespace </span>sampleprof;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacellvm_1_1sampleprofutil.html">llvm::sampleprofutil</a>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ac57dae906fe8ac64efe52571121b0fe1">  106</a></span><span class="keyword">using </span><a class="code hl_class" href="classllvm_1_1Function_1_1ProfileCount.html">ProfileCount</a> = <a class="code hl_class" href="classllvm_1_1Function_1_1ProfileCount.html">Function::ProfileCount</a>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">  107</a></span><span class="preprocessor">#define DEBUG_TYPE &quot;sample-profile&quot;</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">  108</a></span><span class="preprocessor">#define CSINLINE_DEBUG DEBUG_TYPE &quot;-inline&quot;</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a043ee38f41b13487f8e0ef4f74cc600d">  110</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlined</a>,</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>          <span class="stringliteral">&quot;Number of functions inlined with context sensitive profile&quot;</span>);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a645f77fa2f8d80cd7269b393eab19f76">  112</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSNotInlined</a>,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>          <span class="stringliteral">&quot;Number of functions not inlined with context sensitive profile&quot;</span>);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a46c2637d19fc97fa8af274512b3d6fe9">  114</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumMismatchedProfile</a>,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>          <span class="stringliteral">&quot;Number of functions with CFG mismatched profile&quot;</span>);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ada628920f6270698bc899d52ce29f681">  116</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumMatchedProfile</a>, <span class="stringliteral">&quot;Number of functions with CFG matched profile&quot;</span>);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a185d42a572de583b7604376b4ea3660c">  117</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumDuplicatedInlinesite</a>,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>          <span class="stringliteral">&quot;Number of inlined callsites with a partial distribution factor&quot;</span>);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a9c8fc785df9ca40ae647d7bd297edf4d">  120</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitMinLimit</a>,</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>          <span class="stringliteral">&quot;Number of functions with FDO inline stopped due to min size limit&quot;</span>);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a4df177ce3a429f975041e866a6cf0453">  122</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitMaxLimit</a>,</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>          <span class="stringliteral">&quot;Number of functions with FDO inline stopped due to max size limit&quot;</span>);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#acee6f38eb8e4ddba9973ec3c31d83b44">  124</a></span><a class="code hl_define" href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitGrowthLimit</a>,</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="stringliteral">&quot;Number of functions with FDO inline stopped due to growth size limit&quot;</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="comment">// Command line option to specify the file to read samples from. This is</span></div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="comment">// mainly used for debugging.</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a055c6b7054a94b338830b3da8ecc4023">  130</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;std::string&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a055c6b7054a94b338830b3da8ecc4023">SampleProfileFile</a>(</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="stringliteral">&quot;sample-profile-file&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code hl_struct" href="structllvm_1_1cl_1_1value__desc.html">cl::value_desc</a>(<span class="stringliteral">&quot;filename&quot;</span>),</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Profile file loaded by -sample-profile&quot;</span>), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="comment">// The named file contains a set of transformations that may have been applied</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="comment">// to the symbol names between the program from which the sample data was</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="comment">// collected and the current program&#39;s symbols.</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#af8d3791537a44c00b699d28c4d978d82">  137</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;std::string&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#af8d3791537a44c00b699d28c4d978d82">SampleProfileRemappingFile</a>(</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="stringliteral">&quot;sample-profile-remapping-file&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code hl_struct" href="structllvm_1_1cl_1_1value__desc.html">cl::value_desc</a>(<span class="stringliteral">&quot;filename&quot;</span>),</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Profile remapping file loaded by -sample-profile&quot;</span>), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">  141</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a>(</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="stringliteral">&quot;profile-sample-accurate&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;If the sample profile is accurate, we will mark all un-sampled &quot;</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>             <span class="stringliteral">&quot;callsite and function as having 0 samples. Otherwise, treat &quot;</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>             <span class="stringliteral">&quot;un-sampled callsites and functions conservatively as unknown. &quot;</span>));</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a2612d121382d9498fc6fc0acd70a0cf4">  147</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a2612d121382d9498fc6fc0acd70a0cf4">ProfileSampleBlockAccurate</a>(</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <span class="stringliteral">&quot;profile-sample-block-accurate&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;If the sample profile is accurate, we will mark all un-sampled &quot;</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>             <span class="stringliteral">&quot;branches and calls as having 0 samples. Otherwise, treat &quot;</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>             <span class="stringliteral">&quot;them conservatively as unknown. &quot;</span>));</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a8aa89f0866c6f65d2395b74e851e73f7">  153</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a8aa89f0866c6f65d2395b74e851e73f7">ProfileAccurateForSymsInList</a>(</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="stringliteral">&quot;profile-accurate-for-symsinlist&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">cl::ZeroOrMore</a>,</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;For symbols in profile symbol list, regard their profiles to &quot;</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>             <span class="stringliteral">&quot;be accurate. It may be overriden by profile-sample-accurate. &quot;</span>));</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">  159</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">ProfileMergeInlinee</a>(</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="stringliteral">&quot;sample-profile-merge-inlinee&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Merge past inlinee&#39;s profile to outline version if sample &quot;</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>             <span class="stringliteral">&quot;profile loader decided not to inline a call site. It will &quot;</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>             <span class="stringliteral">&quot;only be enabled when top-down order of profile loading is &quot;</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>             <span class="stringliteral">&quot;enabled. &quot;</span>));</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#aeeed05c14d5103af2df4ef16b3d12674">  166</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#aeeed05c14d5103af2df4ef16b3d12674">ProfileTopDownLoad</a>(</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="stringliteral">&quot;sample-profile-top-down-load&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">true</span>),</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Do profile annotation and inlining for functions in top-down &quot;</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>             <span class="stringliteral">&quot;order of call graph during sample profile loading. It only &quot;</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>             <span class="stringliteral">&quot;works for new pass manager. &quot;</span>));</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">  173</a></span>    <a class="code hl_variable" href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">UseProfiledCallGraph</a>(<span class="stringliteral">&quot;use-profiled-call-graph&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">true</span>), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                         <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Process functions in a top-down order &quot;</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                                  <span class="stringliteral">&quot;defined by the profiled call graph when &quot;</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                                  <span class="stringliteral">&quot;-sample-profile-top-down-load is on.&quot;</span>));</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a1fb5d0753c33e3b86aa1094bc2427bba">  178</a></span>    <a class="code hl_variable" href="SampleProfile_8cpp.html#a1fb5d0753c33e3b86aa1094bc2427bba">SortProfiledSCC</a>(<span class="stringliteral">&quot;sort-profiled-scc-member&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">true</span>), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Sort profiled recursion by edge weights.&quot;</span>));</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">  181</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a>(</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="stringliteral">&quot;sample-profile-inline-size&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Inline cold call sites in profile loader if it&#39;s beneficial &quot;</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>             <span class="stringliteral">&quot;for code size.&quot;</span>));</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a6f2891ea30bbf02e93cc94ca385d8d91">  186</a></span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a6f2891ea30bbf02e93cc94ca385d8d91">ProfileInlineGrowthLimit</a>(</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="stringliteral">&quot;sample-profile-inline-growth-limit&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(12),</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The size growth ratio limit for proirity-based sample profile &quot;</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>             <span class="stringliteral">&quot;loader inlining.&quot;</span>));</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">  191</a></span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">ProfileInlineLimitMin</a>(</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="stringliteral">&quot;sample-profile-inline-limit-min&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(100),</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The lower bound of size growth limit for &quot;</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>             <span class="stringliteral">&quot;proirity-based sample profile loader inlining.&quot;</span>));</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">  196</a></span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">ProfileInlineLimitMax</a>(</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="stringliteral">&quot;sample-profile-inline-limit-max&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(10000),</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;The upper bound of size growth limit for &quot;</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>             <span class="stringliteral">&quot;proirity-based sample profile loader inlining.&quot;</span>));</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a033aa3e7e3e183cec38f5a5e36e212c7">  201</a></span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a033aa3e7e3e183cec38f5a5e36e212c7">SampleHotCallSiteThreshold</a>(</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="stringliteral">&quot;sample-profile-hot-inline-threshold&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(3000),</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Hot callsite threshold for proirity-based sample profile loader &quot;</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>             <span class="stringliteral">&quot;inlining.&quot;</span>));</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a6c063cf654bf13a20d00365c2ef7b1da">  206</a></span><a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;int&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a6c063cf654bf13a20d00365c2ef7b1da">SampleColdCallSiteThreshold</a>(</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="stringliteral">&quot;sample-profile-cold-inline-threshold&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(45),</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Threshold for inlining cold callsites&quot;</span>));</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#abe3f89debe4f7888460625789de78083">  210</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#abe3f89debe4f7888460625789de78083">ProfileICPRelativeHotness</a>(</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="stringliteral">&quot;sample-profile-icp-relative-hotness&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(25),</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="stringliteral">&quot;Relative hotness percentage threshold for indirect &quot;</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <span class="stringliteral">&quot;call promotion in proirity-based sample profile loader inlining.&quot;</span>));</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ac689c456b39941e3af203d3e1750b8b5">  216</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#ac689c456b39941e3af203d3e1750b8b5">ProfileICPRelativeHotnessSkip</a>(</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="stringliteral">&quot;sample-profile-icp-relative-hotness-skip&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(1),</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <span class="stringliteral">&quot;Skip relative hotness check for ICP up to given number of targets.&quot;</span>));</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">  221</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a>(</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="stringliteral">&quot;sample-profile-prioritized-inline&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">cl::ZeroOrMore</a>,</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Use call site prioritized inlining for sample profile loader.&quot;</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>             <span class="stringliteral">&quot;Currently only CSSPGO is supported.&quot;</span>));</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">  227</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a>(</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="stringliteral">&quot;sample-profile-use-preinliner&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">cl::ZeroOrMore</a>,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Use the preinliner decisions stored in profile context.&quot;</span>));</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">  232</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">AllowRecursiveInline</a>(</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="stringliteral">&quot;sample-profile-recursive-inline&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">cl::ZeroOrMore</a>,</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Allow sample loader inliner to inline recursive calls.&quot;</span>));</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a732d61bd469914910adee6ed8c8c4a38">  237</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;std::string&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a732d61bd469914910adee6ed8c8c4a38">ProfileInlineReplayFile</a>(</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="stringliteral">&quot;sample-profile-inline-replay&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code hl_struct" href="structllvm_1_1cl_1_1value__desc.html">cl::value_desc</a>(<span class="stringliteral">&quot;filename&quot;</span>),</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="stringliteral">&quot;Optimization remarks file containing inline remarks to be replayed &quot;</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <span class="stringliteral">&quot;by inlining from sample profile loader.&quot;</span>),</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ab75eb24423b8e8d730f81eec23e93f43">  244</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;ReplayInlinerSettings::Scope&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#ab75eb24423b8e8d730f81eec23e93f43">ProfileInlineReplayScope</a>(</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="stringliteral">&quot;sample-profile-inline-replay-scope&quot;</span>,</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(ReplayInlinerSettings::Scope::Function),</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(<a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(ReplayInlinerSettings::Scope::Function, <span class="stringliteral">&quot;Function&quot;</span>,</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                          <span class="stringliteral">&quot;Replay on functions that have remarks associated &quot;</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>                          <span class="stringliteral">&quot;with them (default)&quot;</span>),</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>               <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(ReplayInlinerSettings::Scope::Module, <span class="stringliteral">&quot;Module&quot;</span>,</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>                          <span class="stringliteral">&quot;Replay on the entire module&quot;</span>)),</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Whether inline replay should be applied to the entire &quot;</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>             <span class="stringliteral">&quot;Module or just the Functions (default) that are present as &quot;</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>             <span class="stringliteral">&quot;callers in remarks during sample profile inlining.&quot;</span>),</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a477f441a65d57a1d0bff97e993e0f5d3">  257</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;ReplayInlinerSettings::Fallback&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a477f441a65d57a1d0bff97e993e0f5d3">ProfileInlineReplayFallback</a>(</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="stringliteral">&quot;sample-profile-inline-replay-fallback&quot;</span>,</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(ReplayInlinerSettings::Fallback::Original),</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            ReplayInlinerSettings::Fallback::Original, <span class="stringliteral">&quot;Original&quot;</span>,</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            <span class="stringliteral">&quot;All decisions not in replay send to original advisor (default)&quot;</span>),</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(ReplayInlinerSettings::Fallback::AlwaysInline,</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                   <span class="stringliteral">&quot;AlwaysInline&quot;</span>, <span class="stringliteral">&quot;All decisions not in replay are inlined&quot;</span>),</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(ReplayInlinerSettings::Fallback::NeverInline, <span class="stringliteral">&quot;NeverInline&quot;</span>,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                   <span class="stringliteral">&quot;All decisions not in replay are not inlined&quot;</span>)),</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;How sample profile inline replay treats sites that don&#39;t come &quot;</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>             <span class="stringliteral">&quot;from the replay. Original: defers to original advisor, &quot;</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>             <span class="stringliteral">&quot;AlwaysInline: inline all sites not in replay, NeverInline: &quot;</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>             <span class="stringliteral">&quot;inline no sites not in replay&quot;</span>),</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#af61ae5b7d50b9b36cc3a2350ded45f82">  274</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;CallSiteFormat::Format&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#af61ae5b7d50b9b36cc3a2350ded45f82">ProfileInlineReplayFormat</a>(</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="stringliteral">&quot;sample-profile-inline-replay-format&quot;</span>,</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(CallSiteFormat::Format::LineColumnDiscriminator),</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <a class="code hl_function" href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(CallSiteFormat::Format::Line, <span class="stringliteral">&quot;Line&quot;</span>, <span class="stringliteral">&quot;&lt;Line Number&gt;&quot;</span>),</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(CallSiteFormat::Format::LineColumn, <span class="stringliteral">&quot;LineColumn&quot;</span>,</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                   <span class="stringliteral">&quot;&lt;Line Number&gt;:&lt;Column Number&gt;&quot;</span>),</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(CallSiteFormat::Format::LineDiscriminator,</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                   <span class="stringliteral">&quot;LineDiscriminator&quot;</span>, <span class="stringliteral">&quot;&lt;Line Number&gt;.&lt;Discriminator&gt;&quot;</span>),</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <a class="code hl_define" href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(CallSiteFormat::Format::LineColumnDiscriminator,</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                   <span class="stringliteral">&quot;LineColumnDiscriminator&quot;</span>,</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                   <span class="stringliteral">&quot;&lt;Line Number&gt;:&lt;Column Number&gt;.&lt;Discriminator&gt; (default)&quot;</span>)),</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;How sample profile inline replay file is formatted&quot;</span>), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;unsigned&gt;</a></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a34bb82df4ca701e695848fa1b4d17250">  289</a></span>    <a class="code hl_variable" href="SampleProfile_8cpp.html#a34bb82df4ca701e695848fa1b4d17250">MaxNumPromotions</a>(<span class="stringliteral">&quot;sample-profile-icp-max-prom&quot;</span>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(3), <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                     <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">cl::ZeroOrMore</a>,</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>                     <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Max number of promotions for a single indirect &quot;</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                              <span class="stringliteral">&quot;call callsite in sample profile loader&quot;</span>));</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">  294</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1cl_1_1opt.html">cl::opt&lt;bool&gt;</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a>(</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="stringliteral">&quot;overwrite-existing-weights&quot;</span>, <a class="code hl_enumvalue" href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a class="code hl_function" href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<span class="keyword">false</span>),</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <a class="code hl_struct" href="structllvm_1_1cl_1_1desc.html">cl::desc</a>(<span class="stringliteral">&quot;Ignore existing branch weights on IR and always overwrite.&quot;</span>));</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="keyword">using </span>BlockWeightMap = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;const BasicBlock *, uint64_t&gt;</a>;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="keyword">using </span>EquivalenceClassMap = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;const BasicBlock *, const BasicBlock *&gt;</a>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="keyword">using </span>Edge = std::pair&lt;const BasicBlock *, const BasicBlock *&gt;;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="keyword">using </span>EdgeWeightMap = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;Edge, uint64_t&gt;</a>;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="keyword">using </span>BlockEdgeMap =</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;const BasicBlock *, SmallVector&lt;const BasicBlock *, 8&gt;</a>&gt;;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><span class="keyword">class </span>GUIDToFuncNameMapper {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  GUIDToFuncNameMapper(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html">SampleProfileReader</a> &amp;Reader,</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>                       <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;uint64_t, StringRef&gt;</a> &amp;GUIDToFuncNameMap)</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      : CurrentReader(Reader), CurrentModule(M),</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        CurrentGUIDToFuncNameMap(GUIDToFuncNameMap) {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <span class="keywordflow">if</span> (!CurrentReader.useMD5())</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : CurrentModule) {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>      <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      CurrentGUIDToFuncNameMap.insert(</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>          {Function::getGUID(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>});</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>      <span class="comment">// Local to global var promotion used by optimization like thinlto</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      <span class="comment">// will rename the var and add suffix like &quot;.llvm.xxx&quot; to the</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="comment">// original local name. In sample profile, the suffixes of function</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      <span class="comment">// names are all stripped. Since it is possible that the mapper is</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      <span class="comment">// built in post-thin-link phase and var promotion has been done,</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      <span class="comment">// we need to add the substring of function name without the suffix</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>      <span class="comment">// into the GUIDToFuncNameMap.</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">FunctionSamples::getCanonicalFnName</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>)</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        CurrentGUIDToFuncNameMap.insert(</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            {Function::getGUID(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a>), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a>});</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">// Update GUIDToFuncNameMap for each function including inlinees.</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SetGUIDToFuncNameMapForAll</a>(&amp;CurrentGUIDToFuncNameMap);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  }</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  ~GUIDToFuncNameMapper() {</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="keywordflow">if</span> (!CurrentReader.useMD5())</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    CurrentGUIDToFuncNameMap.clear();</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <span class="comment">// Reset GUIDToFuncNameMap for of each function as they&#39;re no</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="comment">// longer valid at this point.</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SetGUIDToFuncNameMapForAll</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SetGUIDToFuncNameMapForAll</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;uint64_t, StringRef&gt;</a> *Map) {</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    std::queue&lt;FunctionSamples *&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFS</a> : CurrentReader.getProfiles()) {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>.push(&amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFS</a>.second);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    }</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keywordflow">while</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>.empty()) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>      <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>.front();</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>.pop();</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>      <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;GUIDToFuncNameMap = <a class="code hl_enumvalue" href="namespacellvm_1_1msgpack.html#afdae9da66bac09f4b2bfc0fd9f0559e6a46f3ea056caa3126b91f3f70beea068c">Map</a>;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ICS</a> : <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getCallsiteSamples()) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="namespacellvm_1_1sampleprof.html#a659a52f7008b83957eb326a57a737cf9">FunctionSamplesMap</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSMap</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ICS</a>.second;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFS</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSMap</a>) {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>          <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> &amp;<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> &amp;<span class="keyword">&gt;</span>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFS</a>.second);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSToUpdate</a>.push(&amp;FS);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      }</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>  }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  <a class="code hl_class" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html">SampleProfileReader</a> &amp;CurrentReader;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;CurrentModule;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;uint64_t, StringRef&gt;</a> &amp;CurrentGUIDToFuncNameMap;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>};</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="comment">// Inline candidate used by iterative callsite prioritized inliner</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="keyword">struct </span>InlineCandidate {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CallInstr;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *CalleeSamples;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <span class="comment">// Prorated callsite count, which will be used to guide inlining. For example,</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  <span class="comment">// if a callsite is duplicated in LTO prelink, then in LTO postlink the two</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <span class="comment">// copies will get their own distribution factors and their prorated counts</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  <span class="comment">// will be used to decide if they should be inlined independently.</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> CallsiteCount;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <span class="comment">// Call site distribution factor to prorate the profile samples for a</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="comment">// duplicated callsite. Default value is 1.0.</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  <span class="keywordtype">float</span> CallsiteDistribution;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>};</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="comment">// Inline candidate comparer using call site weight</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span><span class="keyword">struct </span>CandidateComparer {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> InlineCandidate &amp;LHS, <span class="keyword">const</span> InlineCandidate &amp;RHS) {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="keywordflow">if</span> (LHS.CallsiteCount != RHS.CallsiteCount)</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      <span class="keywordflow">return</span> LHS.CallsiteCount &lt; RHS.CallsiteCount;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a> = LHS.CalleeSamples;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a> = RHS.CalleeSamples;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a> &amp;&amp; <span class="stringliteral">&quot;Expect non-null FunctionSamples&quot;</span>);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="comment">// Tie breaker using number of samples try to favor smaller functions first</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a>-&gt;getBodySamples().size() != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a>-&gt;getBodySamples().size())</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a>-&gt;getBodySamples().size() &gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a>-&gt;getBodySamples().size();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="comment">// Tie breaker using GUID so we have stable/deterministic inlining order</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a>-&gt;getGUID(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LCS</a>-&gt;getName()) &lt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a>-&gt;getGUID(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RCS</a>-&gt;getName());</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>};</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span><span class="keyword">using </span><a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CandidateQueue</a> =</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PriorityQueue&lt;InlineCandidate, std::vector&lt;InlineCandidate&gt;</a>,</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                  CandidateComparer&gt;;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="comment"></span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="comment">/// Sample profile pass.</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span><span class="comment">///</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="comment">/// This pass reads profile data from the file specified by</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span><span class="comment">/// -sample-profile-file and annotates every affected function with the</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="comment">/// profile information found in that file.</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment"></span><span class="keyword">class </span>SampleProfileLoader final</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    : <span class="keyword">public</span> <a class="code hl_class" href="classllvm_1_1SampleProfileLoaderBaseImpl.html">SampleProfileLoaderBaseImpl</a>&lt;BasicBlock&gt; {</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  SampleProfileLoader(</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>      <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>, <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RemapName</a>, <a class="code hl_enumeration" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49">ThinOrFullLTOPhase</a> LTOPhase,</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>      std::function&lt;<a class="code hl_class" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAssumptionCache,</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      std::function&lt;<a class="code hl_class" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GetTargetTransformInfo</a>,</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>      std::function&lt;<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTLI)</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      : <a class="code hl_class" href="classllvm_1_1SampleProfileLoaderBaseImpl.html">SampleProfileLoaderBaseImpl</a>(<a class="code hl_namespace" href="namespacestd.html">std</a>::string(<a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>), <a class="code hl_namespace" href="namespacestd.html">std</a>::string(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RemapName</a>)),</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        GetAC(<a class="code hl_namespace" href="namespacestd.html">std</a>::<a class="code hl_function" href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">move</a>(GetAssumptionCache)),</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        GetTTI(<a class="code hl_namespace" href="namespacestd.html">std</a>::<a class="code hl_function" href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">move</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GetTargetTransformInfo</a>)), GetTLI(<a class="code hl_namespace" href="namespacestd.html">std</a>::<a class="code hl_function" href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">move</a>(GetTLI)),</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        LTOPhase(LTOPhase) {}</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>  <span class="keywordtype">bool</span> doInitialization(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> *<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> = <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  <span class="keywordtype">bool</span> runOnModule(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> *AM,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                   <a class="code hl_class" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">_PSI</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> *AM);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">emitAnnotations</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> getInstWeight(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <span class="keyword">override</span>;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getProbeWeight</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>  findFunctionSamples(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) <span class="keyword">const override</span>;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>  std::vector&lt;const FunctionSamples *&gt;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findIndirectCallFunctionSamples</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findExternalInlineCandidate</a>(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CB, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *Samples,</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>                                   <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>,</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>                                   <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">StringMap&lt;Function *&gt;</a> &amp;SymbolMap,</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>                                   <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a>);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// Attempt to promote indirect call and also inline the promoted call</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryPromoteAndInlineCandidate</a>(</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>      <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, InlineCandidate &amp;Candidate, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a>,</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      <a class="code hl_class" href="classuint64__t.html">uint64_t</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> *InlinedCallSites = <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">inlineHotFunctions</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;InlineCost&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorCost</a>(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB);</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorShouldInline</a>(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  <a class="code hl_class" href="classllvm_1_1InlineCost.html">InlineCost</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">shouldInlineCandidate</a>(InlineCandidate &amp;Candidate);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getInlineCandidate</a>(InlineCandidate *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>, <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CB);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  <span class="keywordtype">bool</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryInlineCandidate</a>(InlineCandidate &amp;Candidate,</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                     <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> *InlinedCallSites = <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="keywordtype">bool</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">inlineHotFunctionsWithPriority</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                                 <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>);</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="comment">// Inline cold/small functions in addition to hot ones</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">shouldInlineColdCallee</a>(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a>);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">emitOptimizationRemarksForInlineCandidates</a>(</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;CallBase *&gt;</a> &amp;Candidates, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <span class="keywordtype">bool</span> Hot);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">promoteMergeNotInlinedContextSamples</a>(</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;CallBase *, const FunctionSamples *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NonInlinedCallSites</a>,</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>      <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  std::vector&lt;Function *&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">buildFunctionOrder</a>(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>  std::unique_ptr&lt;ProfiledCallGraph&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">buildProfiledCallGraph</a>(<a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">generateMDProfMetadata</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="comment"></span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span><span class="comment">  /// Map from function name to Function *. Used to find the function from</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span><span class="comment">  /// the function name. If the function name contains suffix, additional</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><span class="comment">  /// entry is added to map from the stripped name to the function if there</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span><span class="comment">  /// is one-to-one mapping.</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span><span class="comment"></span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">StringMap&lt;Function *&gt;</a> <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  std::function&lt;<a class="code hl_class" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetAC;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  std::function&lt;<a class="code hl_class" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTTI;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>  std::function&lt;<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp;(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;)&gt; GetTLI;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="comment"></span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="comment">  /// Profile tracker for different context.</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment"></span>  std::unique_ptr&lt;SampleContextTracker&gt; ContextTracker;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment"></span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="comment">  /// Flag indicating whether input profile is context-sensitive</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><span class="comment"></span>  <span class="keywordtype">bool</span> ProfileIsCSFlat = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="comment"></span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="comment">  /// Flag indicating which LTO/ThinLTO phase the pass is invoked in.</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="comment">  ///</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span><span class="comment">  /// We need to know the LTO phase because for example in ThinLTOPrelink</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="comment">  /// phase, in annotation, we should not promote indirect calls. Instead,</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span><span class="comment">  /// we will mark GUIDs that needs to be annotated to the function.</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="comment"></span>  <a class="code hl_enumeration" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49">ThinOrFullLTOPhase</a> LTOPhase;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="comment"></span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment">  /// Profle Symbol list tells whether a function name appears in the binary</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">  /// used to generate the current profile.</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="comment"></span>  std::unique_ptr&lt;ProfileSymbolList&gt; PSL;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment"></span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">  /// Total number of samples collected in this profile.</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">  ///</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="comment">  /// This is the sum of all the samples collected in all the functions executed</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment">  /// at runtime.</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment"></span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> TotalCollectedSamples = 0;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="comment">// Information recorded when we declined to inline a call site</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  <span class="comment">// because we have determined it is too cold is accumulated for</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="comment">// each callee function. Initially this is just the entry count.</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keyword">struct </span>NotInlinedProfileInfo {</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <a class="code hl_class" href="classuint64__t.html">uint64_t</a> entryCount;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>  };</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;Function *, NotInlinedProfileInfo&gt;</a> notInlinedCallInfo;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <span class="comment">// GUIDToFuncNameMap saves the mapping from GUID to the symbol name, for</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <span class="comment">// all the function symbols defined or declared in current module.</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;uint64_t, StringRef&gt;</a> GUIDToFuncNameMap;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="comment">// All the Names used in FunctionSamples including outline function</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="comment">// names, inline instance names and call target names.</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">StringSet&lt;&gt;</a> NamesInProfile;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="comment">// For symbol in profile symbol list, whether to regard their profiles</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>  <span class="comment">// to be accurate. It is mainly decided by existance of profile symbol</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>  <span class="comment">// list and -profile-accurate-for-symsinlist flag, but it can be</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  <span class="comment">// overriden by -profile-sample-accurate or profile-sample-accurate</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="comment">// attribute.</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  <span class="keywordtype">bool</span> ProfAccForSymsInList;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  <span class="comment">// External inline advisor used to replay inline decision from remarks.</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  std::unique_ptr&lt;InlineAdvisor&gt; ExternalInlineAdvisor;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  <span class="comment">// A pseudo probe helper to correlate the imported sample counts.</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  std::unique_ptr&lt;PseudoProbeManager&gt; ProbeManager;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>};</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="keyword">class </span>SampleProfileLoaderLegacyPass : <span class="keyword">public</span> <a class="code hl_class" href="classllvm_1_1ModulePass.html">ModulePass</a> {</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>  <span class="comment">// Class identification, replacement for typeinfo</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_typedef" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">ID</a>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  SampleProfileLoaderLegacyPass(</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a> = <a class="code hl_variable" href="SampleProfile_8cpp.html#a055c6b7054a94b338830b3da8ecc4023">SampleProfileFile</a>,</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      <a class="code hl_enumeration" href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49">ThinOrFullLTOPhase</a> LTOPhase = ThinOrFullLTOPhase::None)</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      : <a class="code hl_class" href="classllvm_1_1ModulePass.html">ModulePass</a>(<a class="code hl_typedef" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">ID</a>), SampleLoader(</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                            <a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>, <a class="code hl_variable" href="SampleProfile_8cpp.html#af8d3791537a44c00b699d28c4d978d82">SampleProfileRemappingFile</a>, LTOPhase,</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>                            [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code hl_class" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp; {</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>                              <span class="keywordflow">return</span> ACT-&gt;getAssumptionCache(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>                            },</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                            [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code hl_class" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp; {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                              <span class="keywordflow">return</span> TTIWP-&gt;getTTI(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                            },</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                            [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code hl_class" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp; {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                              <span class="keywordflow">return</span> TLIWP-&gt;getTLI(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                            }) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <a class="code hl_function" href="namespacellvm.html#ad579b1aaccc266c26012224c61ce29da">initializeSampleProfileLoaderLegacyPassPass</a>(</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        *<a class="code hl_function" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="namespacellvm.html#a03503773241005f01b090b9862aad304">dump</a>() { SampleLoader.dump(); }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="keywordtype">bool</span> doInitialization(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    <span class="keywordflow">return</span> SampleLoader.doInitialization(M);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  }</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> getPassName()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;Sample profile pass&quot;</span>; }</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  <span class="keywordtype">bool</span> runOnModule(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M) <span class="keyword">override</span>;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code hl_class" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    AU.<a class="code hl_function" href="classllvm_1_1AnalysisUsage.html#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a class="code hl_class" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>&gt;();</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    AU.<a class="code hl_function" href="classllvm_1_1AnalysisUsage.html#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a class="code hl_class" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>&gt;();</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    AU.<a class="code hl_function" href="classllvm_1_1AnalysisUsage.html#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a class="code hl_class" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    AU.<a class="code hl_function" href="classllvm_1_1AnalysisUsage.html#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a class="code hl_class" href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">ProfileSummaryInfoWrapperPass</a>&gt;();</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  }</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  SampleProfileLoader SampleLoader;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  <a class="code hl_class" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a> *ACT = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  <a class="code hl_class" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a> *TTIWP = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  <a class="code hl_class" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a> *TLIWP = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>};</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span><a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> SampleProfileLoader::getInstWeight(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">FunctionSamples::ProfileIsProbeBased</a>)</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getProbeWeight</a>(Inst);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;DLoc = Inst.<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="keywordflow">if</span> (!DLoc)</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  <span class="comment">// Ignore all intrinsics, phinodes and branch instructions.</span></div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="comment">// Branch and phinodes instruction usually contains debug info from sources</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="comment">// outside of the residing basic block, thus we ignore them during annotation.</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;BranchInst&gt;</a>(Inst) || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IntrinsicInst&gt;</a>(Inst) || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;PHINode&gt;</a>(Inst))</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <span class="comment">// For non-CS profile, if a direct call/invoke instruction is inlined in</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  <span class="comment">// profile (findCalleeFunctionSamples returns non-empty result), but not</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="comment">// inlined here, it means that the inlined callsite has no sample, thus the</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="comment">// call instruction should have 0 count.</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="comment">// For CS profile, the callsite count of previously inlined callees is</span></div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="comment">// populated with the entry count of the callees.</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  <span class="keywordflow">if</span> (!ProfileIsCSFlat)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(&amp;Inst))</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      <span class="keywordflow">if</span> (!CB-&gt;isIndirectCall() &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*CB))</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  <span class="keywordflow">return</span> getInstWeightImpl(Inst);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>}</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="comment">// Here use error_code to represent: 1) The dangling probe. 2) Ignore the weight</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="comment">// of non-probe instruction. So if all instructions of the BB give error_code,</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="comment">// tell the inference algorithm to infer the BB weight.</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> SampleProfileLoader::getProbeWeight(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst) {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">FunctionSamples::ProfileIsProbeBased</a> &amp;&amp;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>         <span class="stringliteral">&quot;Profile is not pseudo probe based&quot;</span>);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;PseudoProbe&gt;</a> Probe = <a class="code hl_function" href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">extractProbe</a>(Inst);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  <span class="comment">// Ignore the non-probe instruction. If none of the instruction in the BB is</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  <span class="comment">// probe, we choose to infer the BB&#39;s weight.</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  <span class="keywordflow">if</span> (!Probe)</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keywordflow">return</span> std::error_code();</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = findFunctionSamples(Inst);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>  <span class="comment">// If none of the instruction has FunctionSample, we choose to return zero</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  <span class="comment">// value sample to indicate the BB is cold. This could happen when the</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  <span class="comment">// instruction is from inlinee and no profile data is found.</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="comment">// FIXME: This should not be affected by the source drift issue as 1) if the</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <span class="comment">// newly added function is top-level inliner, it won&#39;t match the CFG checksum</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  <span class="comment">// in the function profile or 2) if it&#39;s the inlinee, the inlinee should have</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="comment">// a profile, otherwise it wouldn&#39;t be inlined. For non-probe based profile,</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  <span class="comment">// we can improve it by adding a switch for profile-sample-block-accurate for</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="comment">// block level counts in the future.</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>  <span class="keywordflow">if</span> (!FS)</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="comment">// For non-CS profile, If a direct call/invoke instruction is inlined in</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  <span class="comment">// profile (findCalleeFunctionSamples returns non-empty result), but not</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  <span class="comment">// inlined here, it means that the inlined callsite has no sample, thus the</span></div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <span class="comment">// call instruction should have 0 count.</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  <span class="comment">// For CS profile, the callsite count of previously inlined callees is</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  <span class="comment">// populated with the entry count of the callees.</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>  <span class="keywordflow">if</span> (!ProfileIsCSFlat)</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(&amp;Inst))</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>      <span class="keywordflow">if</span> (!CB-&gt;isIndirectCall() &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*CB))</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> &amp;R = <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findSamplesAt(Probe-&gt;Id, 0);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <span class="keywordflow">if</span> (R) {</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    <a class="code hl_class" href="classuint64__t.html">uint64_t</a> Samples = R.get() * Probe-&gt;Factor;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FirstMark</a> = CoverageTracker.markSamplesUsed(FS, Probe-&gt;Id, 0, Samples);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FirstMark</a>) {</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      ORE-&gt;emit([&amp;]() {</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        <a class="code hl_class" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a> <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>(<a class="code hl_define" href="GenericCycleImpl_8h.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;AppliedSamples&quot;</span>, &amp;Inst);</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <span class="stringliteral">&quot;Applied &quot;</span> &lt;&lt; <a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">ore::NV</a>(<span class="stringliteral">&quot;NumSamples&quot;</span>, Samples);</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <span class="stringliteral">&quot; samples from profile (ProbeId=&quot;</span>;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">ore::NV</a>(<span class="stringliteral">&quot;ProbeId&quot;</span>, Probe-&gt;Id);</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <span class="stringliteral">&quot;, Factor=&quot;</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">ore::NV</a>(<span class="stringliteral">&quot;Factor&quot;</span>, Probe-&gt;Factor);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <span class="stringliteral">&quot;, OriginalSamples=&quot;</span>;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">ore::NV</a>(<span class="stringliteral">&quot;OriginalSamples&quot;</span>, R.get());</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">Remark</a>;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      });</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    }</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; Probe-&gt;Id &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; Inst</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                      &lt;&lt; <span class="stringliteral">&quot; - weight: &quot;</span> &lt;&lt; R.get() &lt;&lt; <span class="stringliteral">&quot; - factor: &quot;</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                      &lt;&lt; <a class="code hl_function" href="namespacellvm.html#a939bc2108d47080767f0c06ba56caec7">format</a>(<span class="stringliteral">&quot;%0.2f&quot;</span>, Probe-&gt;Factor) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordflow">return</span> Samples;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>}</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span><span class="comment"></span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="comment">/// Get the FunctionSamples for a call instruction.</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="comment">///</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span><span class="comment">/// The FunctionSamples of a call/invoke instruction \p Inst is the inlined</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span><span class="comment">/// instance in which that call instruction is calling to. It contains</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span><span class="comment">/// all samples that resides in the inlined instance. We first find the</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">/// inlined instance in which the call instruction is from, then we</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="comment">/// traverse its children to find the callsite with the matching</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">/// location.</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">///</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="comment">/// \param Inst Call/Invoke instruction to query.</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span><span class="comment">///</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span><span class="comment">/// \returns The FunctionSamples pointer to the inlined instance.</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span><span class="comment"></span><span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>SampleProfileLoader::findCalleeFunctionSamples(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;Inst)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DILocation.html">DILocation</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a> = Inst.<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>) {</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  }</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> CalleeName;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = Inst.<a class="code hl_function" href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>())</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    CalleeName = <a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;getName();</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keywordflow">if</span> (ProfileIsCSFlat)</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="keywordflow">return</span> ContextTracker-&gt;getCalleeContextSamplesFor(Inst, CalleeName);</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = findFunctionSamples(Inst);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  <span class="keywordflow">if</span> (FS == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findFunctionSamplesAt(<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aeea4c49a1040f9305f6a09d7d7815544">FunctionSamples::getCallSiteIdentifier</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>),</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                                   CalleeName, Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a530222c3b645acc9170003d046753e94">getRemapper</a>());</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>}</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="comment"></span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">/// Returns a vector of FunctionSamples that are the indirect call targets</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="comment">/// of \p Inst. The vector is sorted by the total number of samples. Stores</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="comment">/// the total call count of the indirect call in \p Sum.</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="comment"></span>std::vector&lt;const FunctionSamples *&gt;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>SampleProfileLoader::findIndirectCallFunctionSamples(</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DILocation.html">DILocation</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a> = Inst.<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  std::vector&lt;const FunctionSamples *&gt; R;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span> </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>) {</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSCompare</a> = [](<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *L, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *R) {</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L &amp;&amp; R &amp;&amp; <span class="stringliteral">&quot;Expect non-null FunctionSamples&quot;</span>);</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="keywordflow">if</span> (L-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aac9d9812a5a2e1902e92b485bbf6819b">getEntrySamples</a>() != R-&gt;getEntrySamples())</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      <span class="keywordflow">return</span> L-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aac9d9812a5a2e1902e92b485bbf6819b">getEntrySamples</a>() &gt; R-&gt;getEntrySamples();</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(L-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#afb88e30fa94efb7c7f12c84b52b61b3d">getName</a>()) &lt;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>           <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(R-&gt;getName());</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  };</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  <span class="keywordflow">if</span> (ProfileIsCSFlat) {</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    <span class="keyword">auto</span> CalleeSamples =</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        ContextTracker-&gt;getIndirectCalleeContextSamplesFor(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keywordflow">if</span> (CalleeSamples.empty())</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>      <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    <span class="comment">// For CSSPGO, we only use target context profile&#39;s entry count</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <span class="comment">// as that already includes both inlined callee and non-inlined ones..</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> = 0;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *<span class="keyword">const</span> FS : CalleeSamples) {</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> += <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples();</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>      R.push_back(FS);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    }</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    <a class="code hl_function" href="namespacellvm.html#a830041552b81a6cea1f497490d0f41d9">llvm::sort</a>(R, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSCompare</a>);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  }</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = findFunctionSamples(Inst);</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>  <span class="keywordflow">if</span> (FS == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bad7a2c9c146ac9c6636e1a009ca1e9413">CallSite</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aeea4c49a1040f9305f6a09d7d7815544">FunctionSamples::getCallSiteIdentifier</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>);</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>  <span class="keyword">auto</span> T = <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findCallTargetMapAt(CallSite);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> = 0;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  <span class="keywordflow">if</span> (T)</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">T_C</a> : T.get())</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> += <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">T_C</a>.second;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>  <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="namespacellvm_1_1sampleprof.html#a659a52f7008b83957eb326a57a737cf9">FunctionSamplesMap</a> *M = <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findFunctionSamplesMapAt(CallSite)) {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="keywordflow">if</span> (M-&gt;empty())</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>      <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NameFS</a> : *M) {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> += <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NameFS</a>.second.getEntrySamples();</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>      R.push_back(&amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NameFS</a>.second);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    }</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <a class="code hl_function" href="namespacellvm.html#a830041552b81a6cea1f497490d0f41d9">llvm::sort</a>(R, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FSCompare</a>);</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>  }</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>  <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>}</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>SampleProfileLoader::findFunctionSamples(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">FunctionSamples::ProfileIsProbeBased</a>) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;PseudoProbe&gt;</a> Probe = <a class="code hl_function" href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">extractProbe</a>(Inst);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <span class="keywordflow">if</span> (!Probe)</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>  }</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DILocation.html">DILocation</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a> = Inst.<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>)</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    <span class="keywordflow">return</span> Samples;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a> = DILocation2SampleMap.try_emplace(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>,<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>.second) {</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <span class="keywordflow">if</span> (ProfileIsCSFlat)</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>.first-&gt;second = ContextTracker-&gt;getContextSamplesFor(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>.first-&gt;second =</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>          Samples-&gt;findFunctionSamples(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>, Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a530222c3b645acc9170003d046753e94">getRemapper</a>());</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  }</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>.first-&gt;second;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>}</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span><span class="comment"></span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span><span class="comment">/// Check whether the indirect call promotion history of \p Inst allows</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="comment">/// the promotion for \p Candidate.</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">/// If the profile count for the promotion candidate \p Candidate is</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">/// NOMORE_ICP_MAGICNUM, it means \p Candidate has already been promoted</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="comment">/// for \p Inst. If we already have at least MaxNumPromotions</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span><span class="comment">/// NOMORE_ICP_MAGICNUM count values in the value profile of \p Inst, we</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span><span class="comment">/// cannot promote for \p Inst anymore.</span></div>
<div class="foldopen" id="foldopen00802" data-start="{" data-end="}">
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#aa2ce415bf980facbbfb4eb13a1e9ce54">  802</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="SampleProfile_8cpp.html#aa2ce415bf980facbbfb4eb13a1e9ce54">doesHistoryAllowICP</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst, <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> Candidate) {</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>  <a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a> = 0;</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> TotalCount = 0;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>  std::unique_ptr&lt;InstrProfValueData[]&gt; ValueData =</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      std::make_unique&lt;InstrProfValueData[]&gt;(<a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>);</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>  <span class="keywordtype">bool</span> Valid =</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      <a class="code hl_function" href="namespacellvm.html#a08a01d88ce50410b70088afeabd8c662">getValueProfDataFromInst</a>(Inst, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IPVK_IndirectCallTarget</a>, <a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>,</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>                               ValueData.get(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a>, TotalCount, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>  <span class="comment">// No valid value profile so no promoted targets have been recorded</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>  <span class="comment">// before. Ok to do ICP.</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>  <span class="keywordflow">if</span> (!Valid)</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>  <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumPromoted</a> = 0;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a>; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    <span class="keywordflow">if</span> (ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Count != <a class="code hl_variable" href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">NOMORE_ICP_MAGICNUM</a>)</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span> </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    <span class="comment">// If the promotion candidate has NOMORE_ICP_MAGICNUM count in the</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="comment">// metadata, it means the candidate has been promoted for this</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="comment">// indirect call.</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keywordflow">if</span> (ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].<a class="code hl_class" href="classllvm_1_1Value.html">Value</a> == Function::getGUID(Candidate))</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumPromoted</a>++;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    <span class="comment">// If already have MaxNumPromotions promotion, don&#39;t do it anymore.</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumPromoted</a> == <a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>)</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>  }</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>}</div>
</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span><span class="comment"></span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span><span class="comment">/// Update indirect call target profile metadata for \p Inst.</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span><span class="comment">/// Usually \p Sum is the sum of counts of all the targets for \p Inst.</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span><span class="comment">/// If it is 0, it means updateIDTMetaData is used to mark a</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="comment">/// certain target to be promoted already. If it is not zero,</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="comment">/// we expect to use it to update the total count in the value profile.</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00839" data-start="{" data-end="}">
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a5c3b919b227c332257bcc77ec8c9df00">  839</a></span><a class="code hl_function" href="SampleProfile_8cpp.html#a5c3b919b227c332257bcc77ec8c9df00">updateIDTMetaData</a>(<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst,</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>                  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;InstrProfValueData&gt;</a> &amp;CallTargets,</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>) {</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>  <a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a> = 0;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>  <span class="comment">// OldSum is the existing total count in the value profile data.</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSum</a> = 0;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>  std::unique_ptr&lt;InstrProfValueData[]&gt; ValueData =</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>      std::make_unique&lt;InstrProfValueData[]&gt;(<a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>  <span class="keywordtype">bool</span> Valid =</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>      <a class="code hl_function" href="namespacellvm.html#a08a01d88ce50410b70088afeabd8c662">getValueProfDataFromInst</a>(Inst, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IPVK_IndirectCallTarget</a>, <a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>,</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                               ValueData.get(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSum</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;uint64_t, uint64_t&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>;</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> == 0) {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((CallTargets.size() == 1 &amp;&amp;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>            CallTargets[0].Count == <a class="code hl_variable" href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">NOMORE_ICP_MAGICNUM</a>) &amp;&amp;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>           <span class="stringliteral">&quot;If sum is 0, assume only one element in CallTargets &quot;</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>           <span class="stringliteral">&quot;with count being NOMORE_ICP_MAGICNUM&quot;</span>);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <span class="comment">// Initialize ValueCountMap with existing value profile data.</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="keywordflow">if</span> (Valid) {</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>      <span class="keywordflow">for</span> (<a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a>; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++)</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>[ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].<a class="code hl_class" href="classllvm_1_1Value.html">Value</a>] = ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Count;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    }</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    <span class="keyword">auto</span> Pair =</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>.try_emplace(CallTargets[0].<a class="code hl_class" href="classllvm_1_1Value.html">Value</a>, CallTargets[0].Count);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    <span class="comment">// If the target already exists in value profile, decrease the total</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    <span class="comment">// count OldSum and reset the target&#39;s count to NOMORE_ICP_MAGICNUM.</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    <span class="keywordflow">if</span> (!Pair.second) {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSum</a> -= Pair.first-&gt;second;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>      Pair.first-&gt;second = <a class="code hl_variable" href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">NOMORE_ICP_MAGICNUM</a>;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    }</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSum</a>;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="comment">// Initialize ValueCountMap with existing NOMORE_ICP_MAGICNUM</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <span class="comment">// counts in the value profile.</span></div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    <span class="keywordflow">if</span> (Valid) {</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>      <span class="keywordflow">for</span> (<a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumVals</a>; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) {</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>        <span class="keywordflow">if</span> (ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Count == <a class="code hl_variable" href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">NOMORE_ICP_MAGICNUM</a>)</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>[ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Value] = ValueData[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>].Count;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>      }</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    }</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_enumvalue" href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">Data</a> : CallTargets) {</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>      <span class="keyword">auto</span> Pair = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>.try_emplace(<a class="code hl_enumvalue" href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">Data</a>.Value, <a class="code hl_enumvalue" href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">Data</a>.Count);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>      <span class="keywordflow">if</span> (Pair.second)</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>      <span class="comment">// The target represented by Data.Value has already been promoted.</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>      <span class="comment">// Keep the count as NOMORE_ICP_MAGICNUM in the profile and decrease</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>      <span class="comment">// Sum by Data.Count.</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>      <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> &gt;= <a class="code hl_enumvalue" href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">Data</a>.Count &amp;&amp; <span class="stringliteral">&quot;Sum should never be less than Data.Count&quot;</span>);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> -= <a class="code hl_enumvalue" href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">Data</a>.Count;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    }</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>  }</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;InstrProfValueData, 8&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCallTargets</a>;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCount</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCountMap</a>) {</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCallTargets</a>.emplace_back(</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InstrProfValueData</a>{<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCount</a>.first, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ValueCount</a>.second});</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>  }</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>  <a class="code hl_function" href="namespacellvm.html#a830041552b81a6cea1f497490d0f41d9">llvm::sort</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCallTargets</a>,</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>             [](<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InstrProfValueData</a> &amp;L, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InstrProfValueData</a> &amp;R) {</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>               <span class="keywordflow">if</span> (L.Count != R.Count)</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                 <span class="keywordflow">return</span> L.Count &gt; R.Count;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>               <span class="keywordflow">return</span> L.Value &gt; R.Value;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>             });</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>  <a class="code hl_class" href="classuint32__t.html">uint32_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MaxMDCount</a> =</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>      std::min(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCallTargets</a>.size(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code hl_variable" href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a>));</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>  <a class="code hl_function" href="namespacellvm.html#a68ee9c22fcc77e40d4ae44e5b37c7998">annotateValueSite</a>(*Inst.<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>()-&gt;<a class="code hl_function" href="classllvm_1_1BasicBlock.html#a80069e261aca5e34cffcc2ef67cfa29b">getParent</a>()-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">getParent</a>(), Inst,</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCallTargets</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IPVK_IndirectCallTarget</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MaxMDCount</a>);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>}</div>
</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span><span class="comment"></span> </div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span><span class="comment">/// Attempt to promote indirect call and also inline the promoted call.</span></div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span><span class="comment">///</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span><span class="comment">/// \param F  Caller function.</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span><span class="comment">/// \param Candidate  ICP and inline candidate.</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span><span class="comment">/// \param SumOrigin  Original sum of target counts for indirect call before</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span><span class="comment">///                   promoting given candidate.</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span><span class="comment">/// \param Sum        Prorated sum of remaining target counts for indirect call</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span><span class="comment">///                   after promoting given candidate.</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span><span class="comment">/// \param InlinedCallSite  Output vector for new call sites exposed after</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span><span class="comment">/// inlining.</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span><span class="comment"></span><span class="keywordtype">bool</span> SampleProfileLoader::tryPromoteAndInlineCandidate(</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, InlineCandidate &amp;Candidate, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a>, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>,</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedCallSite</a>) {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeFunctionName</a> = Candidate.CalleeSamples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa9a46c80625ff1813b321b3a1d46ee37">getFuncName</a>();</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>  <span class="keyword">auto</span> R = SymbolMap.find(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeFunctionName</a>);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>  <span class="keywordflow">if</span> (R == SymbolMap.end() || !R-&gt;getValue())</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span> </div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>  <span class="keyword">auto</span> &amp;CI = *Candidate.CallInstr;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="SampleProfile_8cpp.html#aa2ce415bf980facbbfb4eb13a1e9ce54">doesHistoryAllowICP</a>(CI, R-&gt;getValue()-&gt;getName()))</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span> </div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *Reason = <span class="stringliteral">&quot;Callee function not available&quot;</span>;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>  <span class="comment">// R-&gt;getValue() != &amp;F is to prevent promoting a recursive call.</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>  <span class="comment">// If it is a recursive call, we do not inline it as it could bloat</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>  <span class="comment">// the code exponentially. There is way to better handle this, e.g.</span></div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>  <span class="comment">// clone the caller first, and inline the cloned caller if it is</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>  <span class="comment">// recursive. As llvm does not inline recursive calls, we will</span></div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>  <span class="comment">// simply ignore it instead of handling it explicitly.</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>  <span class="keywordflow">if</span> (!R-&gt;getValue()-&gt;isDeclaration() &amp;&amp; R-&gt;getValue()-&gt;getSubprogram() &amp;&amp;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>      R-&gt;getValue()-&gt;hasFnAttribute(<span class="stringliteral">&quot;use-sample-profile&quot;</span>) &amp;&amp;</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>      R-&gt;getValue() != &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; <a class="code hl_function" href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">isLegalToPromote</a>(CI, R-&gt;getValue(), &amp;Reason)) {</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    <span class="comment">// For promoted target, set its value with NOMORE_ICP_MAGICNUM count</span></div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    <span class="comment">// in the value profile metadata so the target won&#39;t be promoted again.</span></div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;InstrProfValueData, 1&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SortedCallTargets</a> = {<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InstrProfValueData</a>{</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        Function::getGUID(R-&gt;getValue()-&gt;getName()), <a class="code hl_variable" href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">NOMORE_ICP_MAGICNUM</a>}};</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    <a class="code hl_function" href="SampleProfile_8cpp.html#a5c3b919b227c332257bcc77ec8c9df00">updateIDTMetaData</a>(CI, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SortedCallTargets</a>, 0);</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    <span class="keyword">auto</span> *DI = &amp;<a class="code hl_function" href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">pgo::promoteIndirectCall</a>(</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        CI, R-&gt;getValue(), Candidate.CallsiteCount, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>, <span class="keyword">false</span>, ORE);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">if</span> (DI) {</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> -= Candidate.CallsiteCount;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>      <span class="comment">// Do not prorate the indirect callsite distribution since the original</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>      <span class="comment">// distribution will be used to scale down non-promoted profile target</span></div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>      <span class="comment">// counts later. By doing this we lose track of the real callsite count</span></div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>      <span class="comment">// for the leftover indirect callsite as a trade off for accurate call</span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>      <span class="comment">// target counts.</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      <span class="comment">// TODO: Ideally we would have two separate factors, one for call site</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      <span class="comment">// counts and one is used to prorate call target counts.</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>      <span class="comment">// Do not update the promoted direct callsite distribution at this</span></div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>      <span class="comment">// point since the original distribution combined with the callee profile</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>      <span class="comment">// will be used to prorate callsites from the callee if inlined. Once not</span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>      <span class="comment">// inlined, the direct callsite distribution should be prorated so that</span></div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>      <span class="comment">// the it will reflect the real callsite counts.</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      Candidate.CallInstr = DI;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;CallInst&gt;</a>(DI) || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;InvokeInst&gt;</a>(DI)) {</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="namespacellvm_1_1codeview.html#ad25a1310d512e19d2f6318e963dcb30bafc6d010fc5b3d8ff4400670e597c4e7b">Inlined</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryInlineCandidate</a>(Candidate, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedCallSite</a>);</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <span class="keywordflow">if</span> (!Inlined) {</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>          <span class="comment">// Prorate the direct callsite distribution so that it reflects real</span></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>          <span class="comment">// callsite counts.</span></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>          <a class="code hl_function" href="namespacellvm.html#a4fb32c986b105bb7a53700e5988aab6e">setProbeDistributionFactor</a>(</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>              *DI, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(Candidate.CallsiteCount) / <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a>);</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>        }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespacellvm_1_1codeview.html#ad25a1310d512e19d2f6318e963dcb30bafc6d010fc5b3d8ff4400670e597c4e7b">Inlined</a>;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>      }</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    }</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nFailed to promote indirect call to &quot;</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>                      &lt;&lt; Candidate.CalleeSamples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa9a46c80625ff1813b321b3a1d46ee37">getFuncName</a>() &lt;&lt; <span class="stringliteral">&quot; because &quot;</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>                      &lt;&lt; Reason &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>  }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>}</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span><span class="keywordtype">bool</span> SampleProfileLoader::shouldInlineColdCallee(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a>) {</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a>)</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a>.<a class="code hl_function" href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>();</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span> </div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>  <a class="code hl_class" href="classllvm_1_1InlineCost.html">InlineCost</a> Cost = <a class="code hl_function" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">getInlineCost</a>(<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a>, <a class="code hl_function" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">getInlineParams</a>(), GetTTI(*<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>),</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>                                  GetAC, GetTLI);</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span> </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>  <span class="keywordflow">if</span> (Cost.isNever())</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span> </div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  <span class="keywordflow">if</span> (Cost.isAlways())</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span> </div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>  <span class="keywordflow">return</span> Cost.getCost() &lt;= <a class="code hl_variable" href="SampleProfile_8cpp.html#a6c063cf654bf13a20d00365c2ef7b1da">SampleColdCallSiteThreshold</a>;</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>}</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span> </div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span><span class="keywordtype">void</span> SampleProfileLoader::emitOptimizationRemarksForInlineCandidates(</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;CallBase *&gt;</a> &amp;Candidates, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    <span class="keywordtype">bool</span> Hot) {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Candidates) {</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getCalledFunction();</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>) {</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>      ORE-&gt;emit(<a class="code hl_class" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>(<a class="code hl_define" href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">CSINLINE_DEBUG</a>, <span class="stringliteral">&quot;InlineAttempt&quot;</span>,</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                                           <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc(), <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent())</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>                &lt;&lt; <span class="stringliteral">&quot;previous inlining reattempted for &quot;</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>                &lt;&lt; (Hot ? <span class="stringliteral">&quot;hotness: &#39;&quot;</span> : <span class="stringliteral">&quot;size: &#39;&quot;</span>)</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                &lt;&lt; ore::<a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">NV</a>(<span class="stringliteral">&quot;Callee&quot;</span>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>) &lt;&lt; <span class="stringliteral">&quot;&#39; into &#39;&quot;</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                &lt;&lt; ore::<a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">NV</a>(<span class="stringliteral">&quot;Caller&quot;</span>, &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    }</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>  }</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>}</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span><span class="keywordtype">void</span> SampleProfileLoader::findExternalInlineCandidate(</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CB, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *Samples,</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>,</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">StringMap&lt;Function *&gt;</a> &amp;SymbolMap, <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a>) {</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span> </div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>  <span class="comment">// If ExternalInlineAdvisor wants to inline an external function</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>  <span class="comment">// make sure it&#39;s imported</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>  <span class="keywordflow">if</span> (CB &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorShouldInline</a>(*CB)) {</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    <span class="comment">// Samples may not exist for replayed function, if so</span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    <span class="comment">// just add the direct GUID and move on</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    <span class="keywordflow">if</span> (!Samples) {</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>.insert(</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>          <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(CB-&gt;<a class="code hl_function" href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>()-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()));</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    }</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    <span class="comment">// Otherwise, drop the threshold to import everything that we can</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a> = 0;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>  }</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span> </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Samples &amp;&amp; <span class="stringliteral">&quot;expect non-null caller profile&quot;</span>);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span> </div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>  <span class="comment">// For AutoFDO profile, retrieve candidate profiles by walking over</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>  <span class="comment">// the nested inlinee profiles.</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  <span class="keywordflow">if</span> (!ProfileIsCSFlat) {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    Samples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a557fbb31fc3a0ed3e2a1cdbb7382d560">findInlinedFunctions</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>, SymbolMap, <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a>);</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>  }</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> </div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>  <a class="code hl_class" href="classllvm_1_1ContextTrieNode.html">ContextTrieNode</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">Caller</a> =</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      ContextTracker-&gt;getContextFor(Samples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#ad117577730085f895045fc7ff90d8fc2">getContext</a>());</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>  std::queue&lt;ContextTrieNode *&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>.push(Caller);</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>  <span class="keywordflow">while</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>.empty()) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    <a class="code hl_class" href="classllvm_1_1ContextTrieNode.html">ContextTrieNode</a> *<a class="code hl_class" href="classNode.html">Node</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>.front();</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>.pop();</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>    <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a> = <a class="code hl_class" href="classNode.html">Node</a>-&gt;getFunctionSamples();</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <span class="comment">// For CSSPGO profile, retrieve candidate profile by walking over the</span></div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    <span class="comment">// trie built for context profile. Note that also take call targets</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    <span class="comment">// even if callee doesn&#39;t have a corresponding context profile.</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>)</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>    <span class="comment">// If pre-inliner decision is used, honor that for importing as well.</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PreInline</a> =</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        <a class="code hl_variable" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a> &amp;&amp;</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getContext().hasAttribute(<a class="code hl_enumvalue" href="namespacellvm_1_1sampleprof.html#a9c9cec0dc85381494fb418ae0e88a40fa9a35039dfc5e52a8ee9289957a726bee">ContextShouldBeInlined</a>);</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PreInline</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getEntrySamples() &lt; <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a>)</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span> </div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>    <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getFuncName();</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a> = <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    <span class="comment">// Add to the import list only when it&#39;s defined out of module.</span></div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (!Func || <a class="code hl_enumvalue" href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">Func</a>-&gt;isDeclaration())</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>.insert(<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getName()));</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    <span class="comment">// Import hot CallTargets, which may not be available in IR because full</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    <span class="comment">// profile annotation cannot be done until backend compilation in ThinLTO.</span></div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;BS : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getBodySamples())</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>      <a class="code hl_function" href="BasicBlockSections_8cpp.html#a5e5c642a0309c0657f3efa8a8b687008">for</a> (<a class="code hl_variable" href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">auto</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TS</a> : BS.second.getCallTargets())</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <a class="code hl_function" href="PassBuilderBindings_8cpp.html#a2123399ae32cbb1ca753fdfa99756b5c">if</a> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TS</a>.getValue() &gt; <a class="code hl_variable" href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a>) {</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>          <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> CalleeName = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeSample</a>-&gt;getFuncName(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TS</a>.getKey());</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>          <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(CalleeName);</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>          <span class="keywordflow">if</span> (!<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> || <a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isDeclaration())</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>.insert(<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TS</a>.getKey()));</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        }</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    <span class="comment">// Import hot child context profile associted with callees. Note that this</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    <span class="comment">// may have some overlap with the call target loop above, but doing this</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>    <span class="comment">// based child context profile again effectively allow us to use the max of</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>    <span class="comment">// entry count and call target count to determine importing.</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;Child : <a class="code hl_class" href="classNode.html">Node</a>-&gt;getAllChildContext()) {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>      <a class="code hl_class" href="classllvm_1_1ContextTrieNode.html">ContextTrieNode</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeNode</a> = &amp;Child.second;</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeList</a>.push(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeNode</a>);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>    }</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>  }</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>}</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span><span class="comment"></span> </div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="comment">/// Iteratively inline hot callsites of a function.</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="comment">///</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span><span class="comment">/// Iteratively traverse all callsites of the function \p F, and find if</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="comment">/// the corresponding inlined instance exists and is hot in profile. If</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span><span class="comment">/// it is hot enough, inline the callsites and adds new callsites of the</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">/// callee into the caller. If the call is an indirect call, first promote</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment">/// it to direct call. Each indirect call is limited with a single target.</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="comment">///</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment">/// \param F function to perform iterative inlining.</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment">/// \param InlinedGUIDs a set to be updated to include all GUIDs that are</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="comment">///     inlined in the profiled binary.</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="comment">///</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="comment">/// \returns True if there is any inline happened.</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="comment"></span><span class="keywordtype">bool</span> SampleProfileLoader::inlineHotFunctions(</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>) {</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>  <span class="comment">// ProfAccForSymsInList is used in callsiteIsHot. The assertion makes sure</span></div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>  <span class="comment">// Profile symbol list is ignored when profile-sample-accurate is on.</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!ProfAccForSymsInList ||</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>          (!<a class="code hl_variable" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a> &amp;&amp;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>           !<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(<span class="stringliteral">&quot;profile-sample-accurate&quot;</span>))) &amp;&amp;</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>         <span class="stringliteral">&quot;ProfAccForSymsInList should be false when profile-sample-accurate &quot;</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>         <span class="stringliteral">&quot;is enabled&quot;</span>);</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;CallBase *, const FunctionSamples *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>  <span class="keywordflow">while</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a>) {</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 10&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a> : <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>      <span class="keywordtype">bool</span> Hot = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 10&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>;</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 10&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ColdCandidates</a>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>.getInstList()) {</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>        <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(&amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>          <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IntrinsicInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>            <span class="keywordflow">if</span> ((FS = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*CB))) {</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>              <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#afddaa81316d56f125de69793e0ddb33c">FunctionSamples::UseMD5</a> || <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;GUIDToFuncNameMap) &amp;&amp;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>                     <span class="stringliteral">&quot;GUIDToFuncNameMap has to be populated&quot;</span>);</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>              <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>.push_back(CB);</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>              <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples() &gt; 0 || ProfileIsCSFlat)</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>                <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.try_emplace(CB, FS);</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>              <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacellvm_1_1sampleprofutil.html#ab6789a9522443425d339fa34c25f89d5">callsiteIsHot</a>(FS, PSI, ProfAccForSymsInList))</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>                Hot = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">shouldInlineColdCallee</a>(*CB))</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>                <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ColdCandidates</a>.push_back(CB);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorShouldInline</a>(*CB)) {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>              <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>.push_back(CB);</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>            }</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>          }</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>        }</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>      }</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>      <span class="keywordflow">if</span> (Hot || ExternalInlineAdvisor) {</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>.insert(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>.end());</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">emitOptimizationRemarksForInlineCandidates</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllCandidates</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>.insert(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ColdCandidates</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ColdCandidates</a>.end());</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">emitOptimizationRemarksForInlineCandidates</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ColdCandidates</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>      }</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>    }</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CIS</a>) {</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>      <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getCalledFunction();</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>      InlineCandidate Candidate = {<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.lookup(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>),</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>                                   0 <span class="comment">/* dummy count */</span>,</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>                                   1.0 <span class="comment">/* dummy distribution factor */</span>};</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>      <span class="comment">// Do not inline recursive calls.</span></div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> == &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isIndirectCall()) {</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>        <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *FS : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findIndirectCallFunctionSamples</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>)) {</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>          <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>;</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>          <span class="keywordflow">if</span> (LTOPhase == ThinOrFullLTOPhase::ThinLTOPreLink) {</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findExternalInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, FS, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>, SymbolMap,</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>                                        PSI-&gt;getOrCompHotCountThreshold());</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>          }</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespacellvm_1_1sampleprofutil.html#ab6789a9522443425d339fa34c25f89d5">callsiteIsHot</a>(FS, PSI, ProfAccForSymsInList))</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span> </div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>          Candidate = {<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples(), 1.0};</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryPromoteAndInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Candidate, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>)) {</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.erase(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>          }</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>        }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>-&gt;getSubprogram() &amp;&amp;</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>                 !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>-&gt;isDeclaration()) {</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryInlineCandidate</a>(Candidate)) {</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.erase(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        }</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LTOPhase == ThinOrFullLTOPhase::ThinLTOPreLink) {</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findExternalInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>),</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>                                    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>, SymbolMap,</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>                                    PSI-&gt;getOrCompHotCountThreshold());</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>      }</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    }</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> |= <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalChanged</a>;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>  }</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span> </div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>  <span class="comment">// For CS profile, profile for not inlined context will be merged when</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>  <span class="comment">// base profile is being retrieved.</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a821a2271fa79d60de64ce7f2d923299e">FunctionSamples::ProfileIsCSFlat</a>)</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">promoteMergeNotInlinedContextSamples</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a>;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>}</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span> </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="keywordtype">bool</span> SampleProfileLoader::tryInlineCandidate(</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    InlineCandidate &amp;Candidate, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> *InlinedCallSites) {</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>  <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB = *Candidate.CallInstr;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> = CB.<a class="code hl_function" href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>();</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> &amp;&amp; <span class="stringliteral">&quot;Expect a callee with definition&quot;</span>);</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>  <a class="code hl_class" href="classllvm_1_1DebugLoc.html">DebugLoc</a> DLoc = CB.<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>  <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a> = CB.<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>();</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span> </div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>  <a class="code hl_class" href="classllvm_1_1InlineCost.html">InlineCost</a> Cost = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">shouldInlineCandidate</a>(Candidate);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>  <span class="keywordflow">if</span> (Cost.isNever()) {</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>    ORE-&gt;emit(<a class="code hl_class" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>(<a class="code hl_define" href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">CSINLINE_DEBUG</a>, <span class="stringliteral">&quot;InlineFail&quot;</span>, DLoc, <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>)</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>              &lt;&lt; <span class="stringliteral">&quot;incompatible inlining&quot;</span>);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>  }</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>  <span class="keywordflow">if</span> (!Cost)</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>  <a class="code hl_class" href="classllvm_1_1InlineFunctionInfo.html">InlineFunctionInfo</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFI</a>(<span class="keyword">nullptr</span>, GetAC);</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFI</a>.UpdateProfile = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacellvm.html#a7e39b6f753eab4236840973d7f6ddbfe">InlineFunction</a>(CB, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFI</a>).isSuccess()) {</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    <span class="comment">// Merge the attributes based on the inlining.</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    <a class="code hl_function" href="namespacellvm_1_1AttributeFuncs.html#ae05b3471aef6ffe376ceef99af9b4709">AttributeFuncs::mergeAttributesForInlining</a>(*<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>-&gt;getParent(),</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>                                               *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>);</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    <span class="comment">// The call to InlineFunction erases I, so we can&#39;t pass it here.</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    <a class="code hl_function" href="namespacellvm.html#a83035d5c2bb6a64f3c35b716a994b586">emitInlinedIntoBasedOnCost</a>(*ORE, DLoc, <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>, *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>,</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>                               *<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>-&gt;getParent(), Cost, <span class="keyword">true</span>, <a class="code hl_define" href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">CSINLINE_DEBUG</a>);</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span> </div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    <span class="comment">// Now populate the list of newly exposed call sites.</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>    <span class="keywordflow">if</span> (InlinedCallSites) {</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      InlinedCallSites-&gt;clear();</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFI</a>.InlinedCallSites)</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>        InlinedCallSites-&gt;push_back(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    }</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span> </div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    <span class="keywordflow">if</span> (ProfileIsCSFlat)</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      ContextTracker-&gt;markContextSamplesInlined(Candidate.CalleeSamples);</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlined</a>;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span> </div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="comment">// Prorate inlined probes for a duplicated inlining callsite which probably</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>    <span class="comment">// has a distribution less than 100%. Samples for an inlinee should be</span></div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    <span class="comment">// distributed among the copies of the original callsite based on each</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    <span class="comment">// callsite&#39;s distribution factor for counts accuracy. Note that an inlined</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>    <span class="comment">// probe may come with its own distribution factor if it has been duplicated</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <span class="comment">// in the inlinee body. The two factor are multiplied to reflect the</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>    <span class="comment">// aggregation of duplication.</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>    <span class="keywordflow">if</span> (Candidate.CallsiteDistribution &lt; 1) {</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IFI</a>.InlinedCallSites) {</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;PseudoProbe&gt;</a> Probe = <a class="code hl_function" href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">extractProbe</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>          <a class="code hl_function" href="namespacellvm.html#a4fb32c986b105bb7a53700e5988aab6e">setProbeDistributionFactor</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Probe-&gt;Factor *</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>                                             Candidate.CallsiteDistribution);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>      }</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumDuplicatedInlinesite</a>++;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    }</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>  }</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>}</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span> </div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span><span class="keywordtype">bool</span> SampleProfileLoader::getInlineCandidate(InlineCandidate *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>,</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>                                             <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CB) {</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CB &amp;&amp; <span class="stringliteral">&quot;Expect non-null call instruction&quot;</span>);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span> </div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IntrinsicInst&gt;</a>(CB))</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span> </div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>  <span class="comment">// Find the callee&#39;s profile. For indirect call, find hottest target profile.</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *CalleeSamples = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*CB);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>  <span class="comment">// If ExternalInlineAdvisor wants to inline this site, do so even</span></div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>  <span class="comment">// if Samples are not present.</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>  <span class="keywordflow">if</span> (!CalleeSamples &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorShouldInline</a>(*CB))</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>  <span class="keywordtype">float</span> Factor = 1.0;</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;PseudoProbe&gt;</a> Probe = <a class="code hl_function" href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">extractProbe</a>(*CB))</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    Factor = Probe-&gt;Factor;</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span> </div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> CallsiteCount = 0;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ErrorOr&lt;uint64_t&gt;</a> Weight = getBlockWeight(CB-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>());</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>  <span class="keywordflow">if</span> (Weight)</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    CallsiteCount = Weight.get();</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>  <span class="keywordflow">if</span> (CalleeSamples)</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    CallsiteCount = std::max(</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>        CallsiteCount, <a class="code hl_class" href="classuint64__t.html">uint64_t</a>(CalleeSamples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aac9d9812a5a2e1902e92b485bbf6819b">getEntrySamples</a>() * Factor));</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>  *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a> = {CB, CalleeSamples, CallsiteCount, Factor};</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>}</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span><a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;InlineCost&gt;</a></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>SampleProfileLoader::getExternalInlineAdvisorCost(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>  std::unique_ptr&lt;InlineAdvice&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>  <span class="keywordflow">if</span> (ExternalInlineAdvisor) {</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a> = ExternalInlineAdvisor-&gt;getAdvice(CB);</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a>) {</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>      <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a>-&gt;isInliningRecommended()) {</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a>-&gt;recordUnattemptedInlining();</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#ae8663496afd26f704bc84b50d54fb92c">InlineCost::getNever</a>(<span class="stringliteral">&quot;not previously inlined&quot;</span>);</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>      }</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Advice</a>-&gt;recordInlining();</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#a127195706670de70081929e2262249fe">InlineCost::getAlways</a>(<span class="stringliteral">&quot;previously inlined&quot;</span>);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    }</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>  }</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>  <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>}</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span> </div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span><span class="keywordtype">bool</span> SampleProfileLoader::getExternalInlineAdvisorShouldInline(<a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> &amp;CB) {</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;InlineCost&gt;</a> Cost = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorCost</a>(CB);</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  <span class="keywordflow">return</span> Cost ? !!Cost.getValue() : <span class="keyword">false</span>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>}</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span> </div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span><a class="code hl_class" href="classllvm_1_1InlineCost.html">InlineCost</a></div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>SampleProfileLoader::shouldInlineCandidate(InlineCandidate &amp;Candidate) {</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;InlineCost&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReplayCost</a> =</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getExternalInlineAdvisorCost</a>(*Candidate.CallInstr))</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReplayCost</a>.getValue();</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>  <span class="comment">// Adjust threshold based on call site hotness, only do this for callsite</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>  <span class="comment">// prioritized inliner because otherwise cost-benefit check is done earlier.</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>  <span class="keywordtype">int</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SampleThreshold</a> = <a class="code hl_variable" href="SampleProfile_8cpp.html#a6c063cf654bf13a20d00365c2ef7b1da">SampleColdCallSiteThreshold</a>;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a>) {</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>    <span class="keywordflow">if</span> (Candidate.CallsiteCount &gt; PSI-&gt;getHotCountThreshold())</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SampleThreshold</a> = <a class="code hl_variable" href="SampleProfile_8cpp.html#a033aa3e7e3e183cec38f5a5e36e212c7">SampleHotCallSiteThreshold</a>;</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a>)</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#ae8663496afd26f704bc84b50d54fb92c">InlineCost::getNever</a>(<span class="stringliteral">&quot;cold callsite&quot;</span>);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>  }</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span> </div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = Candidate.CallInstr-&gt;<a class="code hl_function" href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>();</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> &amp;&amp; <span class="stringliteral">&quot;Expect a definition for inline candidate of direct call&quot;</span>);</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>  <a class="code hl_struct" href="structllvm_1_1InlineParams.html">InlineParams</a> Params = <a class="code hl_function" href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">getInlineParams</a>();</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>  <span class="comment">// We will ignore the threshold from inline cost, so always get full cost.</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>  Params.<a class="code hl_variable" href="structllvm_1_1InlineParams.html#afbfdb6bed9436fc13b4df5ac67f8b9f7">ComputeFullInlineCost</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>  Params.<a class="code hl_variable" href="structllvm_1_1InlineParams.html#a7cde54d76b55a38309b65c712f1525c3">AllowRecursiveCall</a> = <a class="code hl_variable" href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">AllowRecursiveInline</a>;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>  <span class="comment">// Checks if there is anything in the reachable portion of the callee at</span></div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>  <span class="comment">// this callsite that makes this inlining potentially illegal. Need to</span></div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>  <span class="comment">// set ComputeFullInlineCost, otherwise getInlineCost may return early</span></div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>  <span class="comment">// when cost exceeds threshold without checking all IRs in the callee.</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>  <span class="comment">// The acutal cost does not matter because we only checks isNever() to</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>  <span class="comment">// see if it is legal to inline the callsite.</span></div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>  <a class="code hl_class" href="classllvm_1_1InlineCost.html">InlineCost</a> Cost = <a class="code hl_function" href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">getInlineCost</a>(*Candidate.CallInstr, <a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, Params,</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>                                  GetTTI(*<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>), GetAC, GetTLI);</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>  <span class="comment">// Honor always inline and never inline from call analyzer</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>  <span class="keywordflow">if</span> (Cost.isNever() || Cost.isAlways())</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>    <span class="keywordflow">return</span> Cost;</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span> </div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>  <span class="comment">// With CSSPGO, the preinliner in llvm-profgen can estimate global inline</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>  <span class="comment">// decisions based on hotness as well as accurate function byte sizes for</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>  <span class="comment">// given context using function/inlinee sizes from previous build. It</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>  <span class="comment">// stores the decision in profile, and also adjust/merge context profile</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>  <span class="comment">// aiming at better context-sensitive post-inline profile quality, assuming</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>  <span class="comment">// all inline decision estimates are going to be honored by compiler. Here</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>  <span class="comment">// we replay that inline decision under `sample-profile-use-preinliner`.</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>  <span class="comment">// Note that we don&#39;t need to handle negative decision from preinliner as</span></div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>  <span class="comment">// context profile for not inlined calls are merged by preinliner already.</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a> &amp;&amp; Candidate.CalleeSamples) {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>    <span class="comment">// Once two node are merged due to promotion, we&#39;re losing some context</span></div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>    <span class="comment">// so the original context-sensitive preinliner decision should be ignored</span></div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>    <span class="comment">// for SyntheticContext.</span></div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>    <a class="code hl_class" href="classllvm_1_1sampleprof_1_1SampleContext.html">SampleContext</a> &amp;Context = Candidate.CalleeSamples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#ad117577730085f895045fc7ff90d8fc2">getContext</a>();</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    <span class="keywordflow">if</span> (!Context.hasState(<a class="code hl_enumvalue" href="namespacellvm_1_1sampleprof.html#a6cff5a57b476680e6b28e4dbfd2da8acab2e6b6d8b22672f40e617c7dfedd302a">SyntheticContext</a>) &amp;&amp;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>        Context.hasAttribute(<a class="code hl_enumvalue" href="namespacellvm_1_1sampleprof.html#a9c9cec0dc85381494fb418ae0e88a40fa9a35039dfc5e52a8ee9289957a726bee">ContextShouldBeInlined</a>))</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#a127195706670de70081929e2262249fe">InlineCost::getAlways</a>(<span class="stringliteral">&quot;preinliner&quot;</span>);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>  }</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span> </div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>  <span class="comment">// For old FDO inliner, we inline the call site as long as cost is not</span></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>  <span class="comment">// &quot;Never&quot;. The cost-benefit check is done earlier.</span></div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a>) {</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#ac7c62ec9e2cd5d974f662038b8c8951f">InlineCost::get</a>(Cost.getCost(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">INT_MAX</a>);</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>  }</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span> </div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>  <span class="comment">// Otherwise only use the cost from call analyzer, but overwite threshold with</span></div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>  <span class="comment">// Sample PGO threshold.</span></div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1InlineCost.html#ac7c62ec9e2cd5d974f662038b8c8951f">InlineCost::get</a>(Cost.getCost(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SampleThreshold</a>);</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>}</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span> </div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span><span class="keywordtype">bool</span> SampleProfileLoader::inlineHotFunctionsWithPriority(</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>) {</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>  <span class="comment">// ProfAccForSymsInList is used in callsiteIsHot. The assertion makes sure</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>  <span class="comment">// Profile symbol list is ignored when profile-sample-accurate is on.</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!ProfAccForSymsInList ||</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>          (!<a class="code hl_variable" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a> &amp;&amp;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>           !<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(<span class="stringliteral">&quot;profile-sample-accurate&quot;</span>))) &amp;&amp;</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>         <span class="stringliteral">&quot;ProfAccForSymsInList should be false when profile-sample-accurate &quot;</span></div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>         <span class="stringliteral">&quot;is enabled&quot;</span>);</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span> </div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>  <span class="comment">// Populating worklist with initial call sites from root inliner, along</span></div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>  <span class="comment">// with call site weights.</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CandidateQueue</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>;</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>  InlineCandidate <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>;</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a> : <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>.getInstList()) {</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>      <span class="keyword">auto</span> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(&amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>      <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getInlineCandidate</a>(&amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>, CB))</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.push(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>);</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>    }</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>  }</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span> </div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>  <span class="comment">// Cap the size growth from profile guided inlining. This is needed even</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>  <span class="comment">// though cost of each inline candidate already accounts for callee size,</span></div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>  <span class="comment">// because with top-down inlining, we can grow inliner size significantly</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>  <span class="comment">// with large number of smaller inlinees each pass the cost check.</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_variable" href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">ProfileInlineLimitMax</a> &gt;= <a class="code hl_variable" href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">ProfileInlineLimitMin</a> &amp;&amp;</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>         <span class="stringliteral">&quot;Max inline size limit should not be smaller than min inline size &quot;</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>         <span class="stringliteral">&quot;limit.&quot;</span>);</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getInstructionCount() * <a class="code hl_variable" href="SampleProfile_8cpp.html#a6f2891ea30bbf02e93cc94ca385d8d91">ProfileInlineGrowthLimit</a>;</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>  <a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> = std::min(<a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a>, (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">ProfileInlineLimitMax</a>);</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>  <a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> = std::max(<a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a>, (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">ProfileInlineLimitMin</a>);</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>  <span class="keywordflow">if</span> (ExternalInlineAdvisor)</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>    <a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> = std::numeric_limits&lt;unsigned&gt;::max();</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span> </div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;CallBase *, const FunctionSamples *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span> </div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>  <span class="comment">// Perform iterative BFS call site prioritized inlining</span></div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>  <span class="keywordflow">while</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.empty() &amp;&amp; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getInstructionCount() &lt; <a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a>) {</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>    InlineCandidate Candidate = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.top();</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.pop();</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>    <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Candidate.CallInstr;</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getCalledFunction();</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span> </div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> == &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isIndirectCall()) {</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>      <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> = 0;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>      <span class="keyword">auto</span> CalleeSamples = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findIndirectCallFunctionSamples</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>);</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>      <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> *= Candidate.CallsiteDistribution;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>      <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ICPCount</a> = 0;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> *FS : CalleeSamples) {</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>        <span class="comment">// TODO: Consider disable pre-lTO ICP for MonoLTO as well</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        <span class="keywordflow">if</span> (LTOPhase == ThinOrFullLTOPhase::ThinLTOPreLink) {</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findExternalInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, FS, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>, SymbolMap,</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>                                      PSI-&gt;getOrCompHotCountThreshold());</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>        }</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>        <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EntryCountDistributed</a> =</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>            <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples() * Candidate.CallsiteDistribution;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        <span class="comment">// In addition to regular inline cost check, we also need to make sure</span></div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>        <span class="comment">// ICP isn&#39;t introducing excessive speculative checks even if individual</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <span class="comment">// target looks beneficial to promote and inline. That means we should</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <span class="comment">// only do ICP when there&#39;s a small number dominant targets.</span></div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ICPCount</a> &gt;= <a class="code hl_variable" href="SampleProfile_8cpp.html#ac689c456b39941e3af203d3e1750b8b5">ProfileICPRelativeHotnessSkip</a> &amp;&amp;</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EntryCountDistributed</a> * 100 &lt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a> * <a class="code hl_variable" href="SampleProfile_8cpp.html#abe3f89debe4f7888460625789de78083">ProfileICPRelativeHotness</a>)</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>        <span class="comment">// TODO: Fix CallAnalyzer to handle all indirect calls.</span></div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>        <span class="comment">// For indirect call, we don&#39;t run CallAnalyzer to get InlineCost</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>        <span class="comment">// before actual inlining. This is because we could see two different</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>        <span class="comment">// types from the same definition, which makes CallAnalyzer choke as</span></div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>        <span class="comment">// it&#39;s expecting matching parameter type on both caller and callee</span></div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>        <span class="comment">// side. See example from PR18962 for the triggering cases (the bug was</span></div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>        <span class="comment">// fixed, but we generate different types).</span></div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>        <span class="keywordflow">if</span> (!PSI-&gt;isHotCount(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EntryCountDistributed</a>))</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> InlinedCallSites;</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>        <span class="comment">// Attach function profile for promoted indirect callee, and update</span></div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>        <span class="comment">// call site count for the promoted inline candidate too.</span></div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        Candidate = {<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EntryCountDistributed</a>,</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>                     Candidate.CallsiteDistribution};</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryPromoteAndInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Candidate, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SumOrigin</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>,</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>                                         &amp;InlinedCallSites)) {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CB : InlinedCallSites) {</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getInlineCandidate</a>(&amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>, CB))</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>              <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.emplace(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>);</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>          }</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ICPCount</a>++;</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>          <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ContextTracker) {</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.try_emplace(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, FS);</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>        }</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>      }</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>-&gt;getSubprogram() &amp;&amp;</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>               !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledFunction</a>-&gt;isDeclaration()) {</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallBase *, 8&gt;</a> InlinedCallSites;</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">tryInlineCandidate</a>(Candidate, &amp;InlinedCallSites)) {</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> *CB : InlinedCallSites) {</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getInlineCandidate</a>(&amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>, CB))</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.emplace(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCandidate</a>);</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>        }</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>        <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!ContextTracker) {</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>.try_emplace(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, Candidate.CalleeSamples);</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>      }</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LTOPhase == ThinOrFullLTOPhase::ThinLTOPreLink) {</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findExternalInlineCandidate</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">findCalleeFunctionSamples</a>(*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>),</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>                                  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>, SymbolMap,</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>                                  PSI-&gt;getOrCompHotCountThreshold());</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>    }</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>  }</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span> </div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CQueue</a>.empty()) {</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> == (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">ProfileInlineLimitMax</a>)</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitMaxLimit</a>;</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a> == (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">ProfileInlineLimitMin</a>)</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitMinLimit</a>;</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSInlinedHitGrowthLimit</a>;</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>  }</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span> </div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>  <span class="comment">// For CS profile, profile for not inlined context will be merged when</span></div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>  <span class="comment">// base profile is being retrieved.</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a821a2271fa79d60de64ce7f2d923299e">FunctionSamples::ProfileIsCSFlat</a>)</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">promoteMergeNotInlinedContextSamples</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LocalNotInlinedCallSites</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a>;</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>}</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span> </div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span><span class="keywordtype">void</span> SampleProfileLoader::promoteMergeNotInlinedContextSamples(</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;CallBase *, const FunctionSamples *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NonInlinedCallSites</a>,</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>  <span class="comment">// Accumulate not inlined callsite information into notInlinedSamples</span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;Pair : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NonInlinedCallSites</a>) {</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>    <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Pair.getFirst();</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getCalledFunction();</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> || <a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>-&gt;isDeclaration())</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>    ORE-&gt;emit(<a class="code hl_class" href="classllvm_1_1OptimizationRemarkAnalysis.html">OptimizationRemarkAnalysis</a>(<a class="code hl_define" href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">CSINLINE_DEBUG</a>, <span class="stringliteral">&quot;NotInline&quot;</span>,</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>                                         <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getDebugLoc(), <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent())</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>              &lt;&lt; <span class="stringliteral">&quot;previous inlining not repeated: &#39;&quot;</span></div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>              &lt;&lt; <a class="code hl_struct" href="structllvm_1_1DiagnosticInfoOptimizationBase_1_1Argument.html">ore::NV</a>(<span class="stringliteral">&quot;Callee&quot;</span>, <a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>) &lt;&lt; <span class="stringliteral">&quot;&#39; into &#39;&quot;</span></div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>              &lt;&lt; <a class="code hl_struct" href="structllvm_1_1DiagnosticInfoOptimizationBase_1_1Argument.html">ore::NV</a>(<span class="stringliteral">&quot;Caller&quot;</span>, &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span> </div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>    ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumCSNotInlined</a>;</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = Pair.getSecond();</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>    <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getTotalSamples() == 0 &amp;&amp; <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples() == 0) {</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>    }</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">ProfileMergeInlinee</a>) {</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>      <span class="comment">// A function call can be replicated by optimizations like callsite</span></div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>      <span class="comment">// splitting or jump threading and the replicates end up sharing the</span></div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>      <span class="comment">// sample nested callee profile instead of slicing the original</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>      <span class="comment">// inlinee&#39;s profile. We want to do merge exactly once by filtering out</span></div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>      <span class="comment">// callee profiles with a non-zero head sample count.</span></div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>      <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getHeadSamples() == 0) {</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>        <span class="comment">// Use entry samples as head samples during the merge, as inlinees</span></div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>        <span class="comment">// don&#39;t have head samples.</span></div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>        <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>)-&gt;addHeadSamples(</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>            <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples());</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <span class="comment">// Note that we have to do the merge right after processing function.</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <span class="comment">// This allows OutlineFS&#39;s profile to be used for annotation during</span></div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <span class="comment">// top-down processing of functions&#39; annotation.</span></div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>        <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OutlineFS</a> = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a3af68fe6182b0855269ef3578910df4c">getOrCreateSamplesFor</a>(*<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OutlineFS</a>-&gt;merge(*FS, 1);</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        <span class="comment">// Set outlined profile to be synthetic to not bias the inliner.</span></div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OutlineFS</a>-&gt;SetContextSynthetic();</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>      }</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>      <span class="keyword">auto</span> pair =</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>          notInlinedCallInfo.try_emplace(<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>, NotInlinedProfileInfo{0});</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>      pair.first-&gt;second.entryCount += <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;getEntrySamples();</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>    }</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>  }</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>}</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span><span class="comment"></span> </div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span><span class="comment">/// Returns the sorted CallTargetMap \p M by count in descending order.</span></div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span><span class="comment"></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;InstrProfValueData, 2&gt;</a></div>
<div class="foldopen" id="foldopen01573" data-start="{" data-end="}">
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#aaf55fbc9b8550957ceb81da6a13f54e4"> 1573</a></span><a class="code hl_function" href="SampleProfile_8cpp.html#aaf55fbc9b8550957ceb81da6a13f54e4">GetSortedValueDataFromCallTargets</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1StringMap.html">SampleRecord::CallTargetMap</a> &amp;M) {</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;InstrProfValueData, 2&gt;</a> R;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleRecord.html#ab818a10bb93f9f5b08f1f85ed4733b3c">SampleRecord::SortCallTargets</a>(M)) {</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>    R.emplace_back(</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InstrProfValueData</a>{<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">FunctionSamples::getGUID</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.first), <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second});</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>  }</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>  <span class="keywordflow">return</span> R;</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>}</div>
</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span> </div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span><span class="comment">// Generate MD_prof metadata for every branch instruction using the</span></div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span><span class="comment">// edge weights computed during propagation.</span></div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span><span class="keywordtype">void</span> SampleProfileLoader::generateMDProfMetadata(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>  <span class="comment">// Generate MD_prof metadata for every branch instruction using the</span></div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>  <span class="comment">// edge weights computed during propagation.</span></div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>  <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nPropagation complete. Setting branch weights\n&quot;</span>);</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>  <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>  <a class="code hl_class" href="classllvm_1_1MDBuilder.html">MDBuilder</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MDB</a>(Ctx);</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;BI : <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>    <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a> = &amp;BI;</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span> </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>    <span class="keywordflow">if</span> (BlockWeights[<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>]) {</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>-&gt;getInstList()) {</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;CallInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;InvokeInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>        <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CallBase&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).<a class="code hl_function" href="MemoryBuiltins_8cpp.html#abb8baff9e770c39d9585de30a989bca7">getCalledFunction</a>()) {</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>          <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DebugLoc.html">DebugLoc</a> &amp;DLoc = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDebugLoc();</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>          <span class="keywordflow">if</span> (!DLoc)</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>          <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DILocation.html">DILocation</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a> = DLoc;</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>          <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1sampleprof_1_1FunctionSamples.html">FunctionSamples</a> *<a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a> = findFunctionSamples(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>          <span class="keywordflow">if</span> (!FS)</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>          <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bad7a2c9c146ac9c6636e1a009ca1e9413">CallSite</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aeea4c49a1040f9305f6a09d7d7815544">FunctionSamples::getCallSiteIdentifier</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DIL</a>);</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>          <span class="keyword">auto</span> T = <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findCallTargetMapAt(CallSite);</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>          <span class="keywordflow">if</span> (!T || T.get().empty())</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">FunctionSamples::ProfileIsProbeBased</a>) {</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>            <span class="comment">// Prorate the callsite counts based on the pre-ICP distribution</span></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>            <span class="comment">// factor to reflect what is already done to the callsite before</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>            <span class="comment">// ICP, such as calliste cloning.</span></div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>            <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Optional&lt;PseudoProbe&gt;</a> Probe = <a class="code hl_function" href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">extractProbe</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>              <span class="keywordflow">if</span> (Probe-&gt;Factor &lt; 1)</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>                T = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleRecord.html#abfed1f1dfd251457d62aa20c4c4e95eb">SampleRecord::adjustCallTargets</a>(T.get(), Probe-&gt;Factor);</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>            }</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>          }</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;InstrProfValueData, 2&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SortedCallTargets</a> =</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>              <a class="code hl_function" href="SampleProfile_8cpp.html#aaf55fbc9b8550957ceb81da6a13f54e4">GetSortedValueDataFromCallTargets</a>(T.get());</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>          <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> = 0;</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a> : T.get())</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>            <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> += <a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>.second;</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>          <span class="comment">// With CSSPGO all indirect call targets are counted torwards the</span></div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>          <span class="comment">// original indirect call site in the profile, including both</span></div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>          <span class="comment">// inlined and non-inlined targets.</span></div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>          <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a821a2271fa79d60de64ce7f2d923299e">FunctionSamples::ProfileIsCSFlat</a>) {</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>            <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="namespacellvm_1_1sampleprof.html#a659a52f7008b83957eb326a57a737cf9">FunctionSamplesMap</a> *M =</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>                    <a class="code hl_enumvalue" href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">FS</a>-&gt;findFunctionSamplesMapAt(CallSite)) {</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NameFS</a> : *M)</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>                <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a> += <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NameFS</a>.second.getEntrySamples();</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>            }</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>          }</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>)</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>            <a class="code hl_function" href="SampleProfile_8cpp.html#a5c3b919b227c332257bcc77ec8c9df00">updateIDTMetaData</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SortedCallTargets</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sum</a>);</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a>)</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>            <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setMetadata(LLVMContext::MD_prof, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IntrinsicInst&gt;</a>(&amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>          <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setMetadata(LLVMContext::MD_prof,</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>                        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MDB</a>.createBranchWeights(</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>                            {static_cast&lt;uint32_t&gt;(BlockWeights[BB])}));</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>        }</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>      }</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a> || <a class="code hl_variable" href="SampleProfile_8cpp.html#a2612d121382d9498fc6fc0acd70a0cf4">ProfileSampleBlockAccurate</a>) {</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>      <span class="comment">// Set profile metadata (possibly annotated by LTO prelink) to zero or</span></div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>      <span class="comment">// clear it for cold code.</span></div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>-&gt;getInstList()) {</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;CallInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;InvokeInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CallBase&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>).<a class="code hl_function" href="namespacellvm.html#a070cea0b95536a427b3ebbcedba2a630">isIndirectCall</a>())</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>            <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setMetadata(LLVMContext::MD_prof, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>            <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setMetadata(LLVMContext::MD_prof, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MDB</a>.createBranchWeights(0));</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>        }</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>      }</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>    }</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span> </div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>    <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *TI = <a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>-&gt;getTerminator();</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>    <span class="keywordflow">if</span> (TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ad449a11cc9b14b0ac93bd61bd0bd9293">getNumSuccessors</a>() == 1)</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;BranchInst&gt;</a>(TI) &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;SwitchInst&gt;</a>(TI) &amp;&amp;</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IndirectBrInst&gt;</a>(TI))</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span> </div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>    <a class="code hl_class" href="classllvm_1_1DebugLoc.html">DebugLoc</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchLoc</a> = TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>();</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>    <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\nGetting weights for branch at line &quot;</span></div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>                      &lt;&lt; ((<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchLoc</a>) ? <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchLoc</a>.getLine())</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>                                      : <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;&lt;UNKNOWN LOCATION&gt;&quot;</span>))</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>                      &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;uint32_t, 4&gt;</a> Weights;</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>    <a class="code hl_class" href="classuint32__t.html">uint32_t</a> MaxWeight = 0;</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>    <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MaxDestInst</a>;</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>    <span class="comment">// Since profi treats multiple edges (multiway branches) as a single edge,</span></div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>    <span class="comment">// we need to distribute the computed weight among the branches. We do</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>    <span class="comment">// this by evenly splitting the edge weight among destinations.</span></div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;const BasicBlock *, uint64_t&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeMultiplicity</a>;</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>    std::vector&lt;uint64_t&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeIndex</a>;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacellvm.html#aa2e1a9c1b1be6e7e53d3ec19b2de473b">SampleProfileUseProfi</a>) {</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeIndex</a>.resize(TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ad449a11cc9b14b0ac93bd61bd0bd9293">getNumSuccessors</a>());</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ad449a11cc9b14b0ac93bd61bd0bd9293">getNumSuccessors</a>(); ++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>        <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a944c50b4f5440b3914f5e2a157bb0fd3">getSuccessor</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeIndex</a>[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeMultiplicity</a>[Succ];</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeMultiplicity</a>[Succ]++;</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>      }</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>    }</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ad449a11cc9b14b0ac93bd61bd0bd9293">getNumSuccessors</a>(); ++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>      <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *Succ = TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a944c50b4f5440b3914f5e2a157bb0fd3">getSuccessor</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>      Edge <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a> = std::make_pair(<a class="code hl_enumvalue" href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">BB</a>, Succ);</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>      <a class="code hl_class" href="classuint64__t.html">uint64_t</a> Weight = EdgeWeights[<a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>];</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>      <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>; printEdgeWeight(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>));</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>      <span class="comment">// Use uint32_t saturated arithmetic to adjust the incoming weights,</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>      <span class="comment">// if needed. Sample counts in profiles are 64-bit unsigned values,</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      <span class="comment">// but internally branch weights are expressed as 32-bit values.</span></div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      <span class="keywordflow">if</span> (Weight &gt; std::numeric_limits&lt;uint32_t&gt;::max()) {</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>        <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot; (saturated due to uint32_t overflow)&quot;</span>);</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>        Weight = std::numeric_limits&lt;uint32_t&gt;::max();</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>      }</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="namespacellvm.html#aa2e1a9c1b1be6e7e53d3ec19b2de473b">SampleProfileUseProfi</a>) {</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        <span class="comment">// Weight is added by one to avoid propagation errors introduced by</span></div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>        <span class="comment">// 0 weights.</span></div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>        Weights.push_back(<span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classuint32__t.html">uint32_t</a><span class="keyword">&gt;</span>(Weight + 1));</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>        <span class="comment">// Profi creates proper weights that do not require &quot;+1&quot; adjustments but</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>        <span class="comment">// we evenly split the weight among branches with the same destination.</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>        <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_enumvalue" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a> = Weight / <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeMultiplicity</a>[Succ];</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>        <span class="comment">// Rounding up, if needed, so that first branches are hotter.</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeIndex</a>[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>] &lt; Weight % <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EdgeMultiplicity</a>[Succ])</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>          <a class="code hl_enumvalue" href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">W</a>++;</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        Weights.push_back(<span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classuint32__t.html">uint32_t</a><span class="keyword">&gt;</span>(W));</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>      }</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>      <span class="keywordflow">if</span> (Weight != 0) {</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>        <span class="keywordflow">if</span> (Weight &gt; MaxWeight) {</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>          MaxWeight = Weight;</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MaxDestInst</a> = Succ-&gt;getFirstNonPHIOrDbgOrLifetime();</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>        }</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>      }</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>    }</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span> </div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>    <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TempWeight</a>;</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>    <span class="comment">// Only set weights if there is at least one non-zero weight.</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>    <span class="comment">// In any other case, let the analyzer set weights.</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>    <span class="comment">// Do not set weights if the weights are present unless under</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>    <span class="comment">// OverwriteExistingWeights. In ThinLTO, the profile annotation is done</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>    <span class="comment">// twice. If the first annotation already set the weights, the second pass</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>    <span class="comment">// does not need to set it. With OverwriteExistingWeights, Blocks with zero</span></div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>    <span class="comment">// weight should have their existing metadata (possibly annotated by LTO</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>    <span class="comment">// prelink) cleared.</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>    <span class="keywordflow">if</span> (MaxWeight &gt; 0 &amp;&amp;</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>        (!TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a51d5735829e1f043630dd403f01d4219">extractProfTotalWeight</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TempWeight</a>) || <a class="code hl_variable" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a>)) {</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>      <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SUCCESS. Found non-zero weights.\n&quot;</span>);</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>      TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_prof, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MDB</a>.createBranchWeights(Weights));</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>      ORE-&gt;emit([&amp;]() {</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1OptimizationRemark.html">OptimizationRemark</a>(<a class="code hl_define" href="GenericCycleImpl_8h.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <span class="stringliteral">&quot;PopularDest&quot;</span>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MaxDestInst</a>)</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>               &lt;&lt; <span class="stringliteral">&quot;most popular destination for conditional branches at &quot;</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>               &lt;&lt; <a class="code hl_typedef" href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">ore::NV</a>(<span class="stringliteral">&quot;CondBranchesLoc&quot;</span>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchLoc</a>);</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>      });</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a>) {</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>        TI-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD_prof, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>        <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CLEARED. All branch weights are zero.\n&quot;</span>);</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;SKIPPED. All branch weights are zero.\n&quot;</span>);</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>      }</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>    }</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>  }</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>}</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span><span class="comment"></span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span><span class="comment">/// Once all the branch weights are computed, we emit the MD_prof</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span><span class="comment">/// metadata on BB using the computed values for each of its branches.</span></div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span><span class="comment">///</span></div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span><span class="comment">/// \param F The function to query.</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="comment">///</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span><span class="comment">/// \returns true if \p F was modified. Returns false, otherwise.</span></div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span><span class="comment"></span><span class="keywordtype">bool</span> SampleProfileLoader::emitAnnotations(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span> </div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">FunctionSamples::ProfileIsProbeBased</a>) {</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>    <span class="keywordflow">if</span> (!ProbeManager-&gt;profileIsValid(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, *Samples)) {</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>      <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>          <a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Profile is invalid due to CFG mismatch for Function &quot;</span></div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>                 &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName());</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumMismatchedProfile</a>;</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>    }</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>    ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NumMatchedProfile</a>;</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>    <span class="keywordflow">if</span> (getFunctionLoc(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) == 0)</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span> </div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>    <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Line number for the first instruction in &quot;</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>                      &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; getFunctionLoc(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>  }</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span> </div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseSet&lt;GlobalValue::GUID&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>;</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a>)</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>    <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> |= <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">inlineHotFunctionsWithPriority</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>);</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>    <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> |= <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">inlineHotFunctions</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>);</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>  <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> |= computeAndPropagateWeights(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InlinedGUIDs</a>);</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span> </div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a>)</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">generateMDProfMetadata</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span> </div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>  emitCoverageRemarks(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a>;</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>}</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span><span class="keywordtype">char</span> SampleProfileLoaderLegacyPass::ID = 0;</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#a9c61d2d479bce8e59a01b4095d381961"> 1789</a></span><a class="code hl_define" href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a>(SampleProfileLoaderLegacyPass, <span class="stringliteral">&quot;sample-profile&quot;</span>,</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>                      <span class="stringliteral">&quot;Sample Profile loader&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>)</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span><a class="code hl_define" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code hl_class" href="classllvm_1_1AssumptionCacheTracker.html">AssumptionCacheTracker</a>)</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span><a class="code hl_define" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code hl_class" href="classllvm_1_1TargetTransformInfoWrapperPass.html">TargetTransformInfoWrapperPass</a>)</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span><a class="code hl_define" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code hl_class" href="classllvm_1_1TargetLibraryInfoWrapperPass.html">TargetLibraryInfoWrapperPass</a>)</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span><a class="code hl_define" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code hl_class" href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">ProfileSummaryInfoWrapperPass</a>)</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#ab9c03ccea8a95213cc02502d0a8216a2"> 1795</a></span><a class="code hl_define" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(SampleProfileLoaderLegacyPass, &quot;sample-profile&quot;,</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"><a class="line" href="SampleProfile_8cpp.html#aea50f65dff46ad92ec79209f5167d63c"> 1796</a></span>                    &quot;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Sample</a> <a class="code hl_variable" href="MIRSampleProfile_8cpp.html#a009775794ead70aa23c76df46ab4ed8a">Profile</a> <a class="code hl_variable" href="SampleProfile_8cpp.html#aa6d0a32738af9bd060dcfe35c6ee4b44">loader</a>&quot;, <a class="code hl_namespace" href="namespacefalse.html">false</a>, <a class="code hl_namespace" href="namespacefalse.html">false</a>)</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><a class="code hl_namespace" href="namespacestd.html">std</a>::<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">unique_ptr</a>&lt;<a class="code hl_class" href="classllvm_1_1sampleprof_1_1ProfiledCallGraph.html">ProfiledCallGraph</a>&gt;</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>SampleProfileLoader::<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">buildProfiledCallGraph</a>(<a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>  std::unique_ptr&lt;ProfiledCallGraph&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a>;</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>  <span class="keywordflow">if</span> (ProfileIsCSFlat)</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a> = std::make_unique&lt;ProfiledCallGraph&gt;(*ContextTracker);</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a> = std::make_unique&lt;ProfiledCallGraph&gt;(Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a19892ef729b441b25d21f69ea15c9118">getProfiles</a>());</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span> </div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>  <span class="comment">// Add all functions into the profiled call graph even if they are not in</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>  <span class="comment">// the profile. This makes sure functions missing from the profile still</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>  <span class="comment">// gets a chance to be processed.</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_class" href="classNode.html">Node</a> : <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>    <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_class" href="classNode.html">Node</a>.first;</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> || <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration() || !<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasFnAttribute(<span class="stringliteral">&quot;use-sample-profile&quot;</span>))</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a>-&gt;addProfiledFunction(<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">FunctionSamples::getCanonicalFnName</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>  }</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span> </div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a>;</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>}</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span> </div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>std::vector&lt;Function *&gt;</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>SampleProfileLoader::buildFunctionOrder(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>  std::vector&lt;Function *&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>;</div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.reserve(M.size());</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span> </div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#aeeed05c14d5103af2df4ef16b3d12674">ProfileTopDownLoad</a> &amp;&amp; <a class="code hl_variable" href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">UseProfiledCallGraph</a>)</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>    <a class="code hl_function" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; <span class="stringliteral">&quot;WARNING: -use-profiled-call-graph ignored, should be used &quot;</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>              <span class="stringliteral">&quot;together with -sample-profile-top-down-load.\n&quot;</span>;</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span> </div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#aeeed05c14d5103af2df4ef16b3d12674">ProfileTopDownLoad</a> || <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">ProfileMergeInlinee</a>) {</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>      <span class="comment">// Disable ProfileMergeInlinee if profile is not loaded in top down order,</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>      <span class="comment">// because the profile for a function may be used for the profile</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>      <span class="comment">// annotation of its outline copy before the profile merging of its</span></div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>      <span class="comment">// non-inlined inline instances, and that is not the way how</span></div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>      <span class="comment">// ProfileMergeInlinee is supposed to work.</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">ProfileMergeInlinee</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>    }</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span> </div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : M)</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>      <a class="code hl_function" href="PassBuilderBindings_8cpp.html#a2123399ae32cbb1ca753fdfa99756b5c">if</a> (!<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isDeclaration() &amp;&amp; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(<span class="stringliteral">&quot;use-sample-profile&quot;</span>))</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.push_back(&amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>;</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>  }</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span> </div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(&amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>-&gt;getModule() == &amp;M);</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span> </div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">UseProfiledCallGraph</a> ||</div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>      (ProfileIsCSFlat &amp;&amp; !<a class="code hl_variable" href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">UseProfiledCallGraph</a>.getNumOccurrences())) {</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>    <span class="comment">// Use profiled call edges to augment the top-down order. There are cases</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>    <span class="comment">// that the top-down order computed based on the static call graph doesn&#39;t</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>    <span class="comment">// reflect real execution order. For example</span></div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>    <span class="comment">//</span></div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>    <span class="comment">// 1. Incomplete static call graph due to unknown indirect call targets.</span></div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>    <span class="comment">//    Adjusting the order by considering indirect call edges from the</span></div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>    <span class="comment">//    profile can enable the inlining of indirect call targets by allowing</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>    <span class="comment">//    the caller processed before them.</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>    <span class="comment">// 2. Mutual call edges in an SCC. The static processing order computed for</span></div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>    <span class="comment">//    an SCC may not reflect the call contexts in the context-sensitive</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>    <span class="comment">//    profile, thus may cause potential inlining to be overlooked. The</span></div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>    <span class="comment">//    function order in one SCC is being adjusted to a top-down order based</span></div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>    <span class="comment">//    on the profile to favor more inlining. This is only a problem with CS</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>    <span class="comment">//    profile.</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>    <span class="comment">// 3. Transitive indirect call edges due to inlining. When a callee function</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>    <span class="comment">//    (say B) is inlined into into a caller function (say A) in LTO prelink,</span></div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>    <span class="comment">//    every call edge originated from the callee B will be transferred to</span></div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>    <span class="comment">//    the caller A. If any transferred edge (say A-&gt;C) is indirect, the</span></div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>    <span class="comment">//    original profiled indirect edge B-&gt;C, even if considered, would not</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>    <span class="comment">//    enforce a top-down order from the caller A to the potential indirect</span></div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>    <span class="comment">//    call target C in LTO postlink since the inlined callee B is gone from</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>    <span class="comment">//    the static call graph.</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>    <span class="comment">// 4. #3 can happen even for direct call targets, due to functions defined</span></div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>    <span class="comment">//    in header files. A header function (say A), when included into source</span></div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>    <span class="comment">//    files, is defined multiple times but only one definition survives due</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>    <span class="comment">//    to ODR. Therefore, the LTO prelink inlining done on those dropped</span></div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>    <span class="comment">//    definitions can be useless based on a local file scope. More</span></div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>    <span class="comment">//    importantly, the inlinee (say B), once fully inlined to a</span></div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>    <span class="comment">//    to-be-dropped A, will have no profile to consume when its outlined</span></div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>    <span class="comment">//    version is compiled. This can lead to a profile-less prelink</span></div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>    <span class="comment">//    compilation for the outlined version of B which may be called from</span></div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>    <span class="comment">//    external modules. while this isn&#39;t easy to fix, we rely on the</span></div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>    <span class="comment">//    postlink AutoFDO pipeline to optimize B. Since the survived copy of</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>    <span class="comment">//    the A can be inlined in its local scope in prelink, it may not exist</span></div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>    <span class="comment">//    in the merged IR in postlink, and we&#39;ll need the profiled call edges</span></div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>    <span class="comment">//    to enforce a top-down order for the rest of the functions.</span></div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>    <span class="comment">//</span></div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>    <span class="comment">// Considering those cases, a profiled call graph completely independent of</span></div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>    <span class="comment">// the static call graph is constructed based on profile data, where</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>    <span class="comment">// function objects are not even needed to handle case #3 and case 4.</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>    <span class="comment">//</span></div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>    <span class="comment">// Note that static callgraph edges are completely ignored since they</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>    <span class="comment">// can be conflicting with profiled edges for cyclic SCCs and may result in</span></div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>    <span class="comment">// an SCC order incompatible with profile-defined one. Using strictly</span></div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>    <span class="comment">// profile order ensures a maximum inlining experience. On the other hand,</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>    <span class="comment">// static call edges are not so important when they don&#39;t correspond to a</span></div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>    <span class="comment">// context in the profile.</span></div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span> </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>    std::unique_ptr&lt;ProfiledCallGraph&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">buildProfiledCallGraph</a>(*<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">scc_iterator&lt;ProfiledCallGraph *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a> = <a class="code hl_function" href="namespacellvm.html#a3c1a67796e24a843db8a6766baa54c21">scc_begin</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ProfiledCG</a>.get());</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>    <span class="keywordflow">while</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>.isAtEnd()) {</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>      <span class="keyword">auto</span> Range = *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>;</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#a1fb5d0753c33e3b86aa1094bc2427bba">SortProfiledSCC</a>) {</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>        <span class="comment">// Sort nodes in one SCC based on callsite hotness.</span></div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">scc_member_iterator&lt;ProfiledCallGraph *&gt;</a> <a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a0f79dad1efc582555a443cc11a8fa401">SI</a>(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>);</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>        Range = *<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a0f79dad1efc582555a443cc11a8fa401">SI</a>;</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>      }</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code hl_class" href="classNode.html">Node</a> : Range) {</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>        <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">lookup</a>(<a class="code hl_class" href="classNode.html">Node</a>-&gt;Name);</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; !<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration() &amp;&amp; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasFnAttribute(<span class="stringliteral">&quot;use-sample-profile&quot;</span>))</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.push_back(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>      }</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>;</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>    }</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">scc_iterator&lt;CallGraph *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a> = <a class="code hl_function" href="namespacellvm.html#a3c1a67796e24a843db8a6766baa54c21">scc_begin</a>(<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>    <span class="keywordflow">while</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>.isAtEnd()) {</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>      <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CallGraphNode.html">CallGraphNode</a> *<a class="code hl_class" href="classNode.html">Node</a> : *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>) {</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>        <span class="keyword">auto</span> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_class" href="classNode.html">Node</a>-&gt;getFunction();</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> &amp;&amp; !<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration() &amp;&amp; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasFnAttribute(<span class="stringliteral">&quot;use-sample-profile&quot;</span>))</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.push_back(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>      }</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>      ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGI</a>;</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>    }</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>  }</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span> </div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>  <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>({</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>    <a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;Function processing order:\n&quot;</span>;</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code hl_function" href="namespacellvm.html#a469101ea87b8b432a1b4f7935c97f35c">reverse</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>)) {</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>      <a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>    }</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>  });</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span> </div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>  std::reverse(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>.end());</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FunctionOrderList</a>;</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>}</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span> </div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span><span class="keywordtype">bool</span> SampleProfileLoader::doInitialization(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>                                           <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> *<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>) {</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>  <span class="keyword">auto</span> &amp;Ctx = M.getContext();</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span> </div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReaderOrErr</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a6f828f6cbdc46c9fc6dc254de51c354a">SampleProfileReader::create</a>(</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>      Filename, Ctx, FSDiscriminatorPass::Base, RemappingFilename);</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>  <span class="keywordflow">if</span> (std::error_code EC = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReaderOrErr</a>.getError()) {</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>    std::string Msg = <span class="stringliteral">&quot;Could not open profile: &quot;</span> + <a class="code hl_enumvalue" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>.message();</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>    Ctx.diagnose(<a class="code hl_class" href="classllvm_1_1DiagnosticInfoSampleProfile.html">DiagnosticInfoSampleProfile</a>(Filename, Msg));</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>  }</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>  Reader = std::move(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReaderOrErr</a>.get());</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>  Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#ac2c3cd528ebcb5fbe487fe9e0b3a9de6">setSkipFlatProf</a>(LTOPhase == ThinOrFullLTOPhase::ThinLTOPostLink);</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>  <span class="comment">// set module before reading the profile so reader may be able to only</span></div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>  <span class="comment">// read the function profiles which are used by the current module.</span></div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>  Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a55f2425598ac25a3e028f96ac39a56ce">setModule</a>(&amp;M);</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>  <span class="keywordflow">if</span> (std::error_code EC = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a3bdbf84fa8e3f0e789653587d5c85515">read</a>()) {</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>    std::string Msg = <span class="stringliteral">&quot;profile reading failed: &quot;</span> + <a class="code hl_enumvalue" href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">EC</a>.message();</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>    Ctx.diagnose(<a class="code hl_class" href="classllvm_1_1DiagnosticInfoSampleProfile.html">DiagnosticInfoSampleProfile</a>(Filename, Msg));</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>  }</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span> </div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>  PSL = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#af9976cd2d8ddf787f19d5dbca4530fa6">getProfileSymbolList</a>();</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span> </div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>  <span class="comment">// While profile-sample-accurate is on, ignore symbol list.</span></div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>  ProfAccForSymsInList =</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#a8aa89f0866c6f65d2395b74e851e73f7">ProfileAccurateForSymsInList</a> &amp;&amp; PSL &amp;&amp; !<a class="code hl_variable" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a>;</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>  <span class="keywordflow">if</span> (ProfAccForSymsInList) {</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>    NamesInProfile.<a class="code hl_function" href="classllvm_1_1StringMap.html#a132b998e118193914fa4e2b694005b2c">clear</a>();</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> NameTable = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a6dd2d2051faff77f927c11a25a851b81">getNameTable</a>())</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>      NamesInProfile.<a class="code hl_function" href="classllvm_1_1StringSet.html#add93efa62e06c599f1734f3b206232a0">insert</a>(NameTable-&gt;begin(), NameTable-&gt;end());</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>    CoverageTracker.setProfAccForSymsInList(<span class="keyword">true</span>);</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>  }</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span> </div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> &amp;&amp; !<a class="code hl_variable" href="SampleProfile_8cpp.html#a732d61bd469914910adee6ed8c8c4a38">ProfileInlineReplayFile</a>.empty()) {</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>    ExternalInlineAdvisor = <a class="code hl_function" href="namespacellvm.html#ad8b4a8280867e4435043b760a879124d">getReplayInlineAdvisor</a>(</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>        M, *<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>, Ctx, <span class="comment">/*OriginalAdvisor=*/</span><span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>        <a class="code hl_struct" href="structllvm_1_1ReplayInlinerSettings.html">ReplayInlinerSettings</a>{<a class="code hl_variable" href="SampleProfile_8cpp.html#a732d61bd469914910adee6ed8c8c4a38">ProfileInlineReplayFile</a>,</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>                              <a class="code hl_variable" href="SampleProfile_8cpp.html#ab75eb24423b8e8d730f81eec23e93f43">ProfileInlineReplayScope</a>,</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>                              <a class="code hl_variable" href="SampleProfile_8cpp.html#a477f441a65d57a1d0bff97e993e0f5d3">ProfileInlineReplayFallback</a>,</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>                              {<a class="code hl_variable" href="SampleProfile_8cpp.html#af61ae5b7d50b9b36cc3a2350ded45f82">ProfileInlineReplayFormat</a>}},</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>        <span class="comment">/*EmitRemarks=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>  }</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span> </div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>  <span class="comment">// Apply tweaks if context-sensitive profile is available.</span></div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>  <span class="keywordflow">if</span> (Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a08811be4d55763d43b55278d760065d9">profileIsCSFlat</a>() || Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a7af14f4292ed5d6787b576e1ae9a0bcf">profileIsCSNested</a>()) {</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>    ProfileIsCSFlat = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a08811be4d55763d43b55278d760065d9">profileIsCSFlat</a>();</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>    <span class="comment">// Enable priority-base inliner and size inline by default for CSSPGO.</span></div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a>.getNumOccurrences())</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a>.getNumOccurrences())</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span> </div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>    <span class="comment">// For CSSPGO, use preinliner decision by default when available.</span></div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a>.getNumOccurrences())</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span> </div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>    <span class="comment">// For CSSPGO, we also allow recursive inline to best use context profile.</span></div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">AllowRecursiveInline</a>.getNumOccurrences())</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>      <a class="code hl_variable" href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">AllowRecursiveInline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span> </div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>    <span class="comment">// Enable iterative-BFI by default for CSSPGO.</span></div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="namespacellvm.html#af02a478b5fdda18781d7c7edd5709ed7">UseIterativeBFIInference</a>.<a class="code hl_function" href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">getNumOccurrences</a>())</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>      <a class="code hl_variable" href="namespacellvm.html#af02a478b5fdda18781d7c7edd5709ed7">UseIterativeBFIInference</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>    <span class="comment">// Enable Profi by default for CSSPGO.</span></div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="namespacellvm.html#aa2e1a9c1b1be6e7e53d3ec19b2de473b">SampleProfileUseProfi</a>.<a class="code hl_function" href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">getNumOccurrences</a>())</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>      <a class="code hl_variable" href="namespacellvm.html#aa2e1a9c1b1be6e7e53d3ec19b2de473b">SampleProfileUseProfi</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span> </div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a821a2271fa79d60de64ce7f2d923299e">FunctionSamples::ProfileIsCSFlat</a>) {</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>      <span class="comment">// Tracker for profiles under different context</span></div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>      ContextTracker = std::make_unique&lt;SampleContextTracker&gt;(</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>          Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a19892ef729b441b25d21f69ea15c9118">getProfiles</a>(), &amp;GUIDToFuncNameMap);</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>    }</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>  }</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span> </div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>  <span class="comment">// Load pseudo probe descriptors for probe-based function samples.</span></div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>  <span class="keywordflow">if</span> (Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a1f372a7784eaec8c761af0ed7c38b1b2">profileIsProbeBased</a>()) {</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>    ProbeManager = std::make_unique&lt;PseudoProbeManager&gt;(M);</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>    <span class="keywordflow">if</span> (!ProbeManager-&gt;moduleIsProbed(M)) {</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *Msg =</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>          <span class="stringliteral">&quot;Pseudo-probe-based profile requires SampleProfileProbePass&quot;</span>;</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>      Ctx.diagnose(<a class="code hl_class" href="classllvm_1_1DiagnosticInfoSampleProfile.html">DiagnosticInfoSampleProfile</a>(M.getModuleIdentifier(), Msg,</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>                                               <a class="code hl_enumvalue" href="namespacellvm.html#abfcab32516704f11d146c757f402ad5ca1cde8c8828756cdaf2a93260e247ae31">DS_Warning</a>));</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>    }</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>  }</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span> </div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>}</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span> </div>
<div class="foldopen" id="foldopen02025" data-start="{" data-end="}">
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"><a class="line" href="namespacellvm.html#a2f18b256797f90ed7933e51e26fa6505"> 2025</a></span><a class="code hl_class" href="classllvm_1_1ModulePass.html">ModulePass</a> *<a class="code hl_function" href="namespacellvm.html#a2f18b256797f90ed7933e51e26fa6505">llvm::createSampleProfileLoaderPass</a>() {</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>  <span class="keywordflow">return</span> <span class="keyword">new</span> SampleProfileLoaderLegacyPass();</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>}</div>
</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span> </div>
<div class="foldopen" id="foldopen02029" data-start="{" data-end="}">
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"><a class="line" href="namespacellvm.html#a1c459f35b286c450385b372ce814da97"> 2029</a></span><a class="code hl_class" href="classllvm_1_1ModulePass.html">ModulePass</a> *<a class="code hl_function" href="namespacellvm.html#a2f18b256797f90ed7933e51e26fa6505">llvm::createSampleProfileLoaderPass</a>(<a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>) {</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>  <span class="keywordflow">return</span> <span class="keyword">new</span> SampleProfileLoaderLegacyPass(<a class="code hl_variable" href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a>);</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>}</div>
</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span> </div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span><span class="keywordtype">bool</span> SampleProfileLoader::runOnModule(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> *AM,</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>                                      <a class="code hl_class" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">_PSI</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>  GUIDToFuncNameMapper Mapper(M, *Reader, GUIDToFuncNameMap);</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span> </div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>  PSI = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">_PSI</a>;</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>  <span class="keywordflow">if</span> (M.getProfileSummary(<span class="comment">/* IsCS */</span> <span class="keyword">false</span>) == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>    M.setProfileSummary(Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a7870bf43f8e5b80b21caea5ea2e23977">getSummary</a>().<a class="code hl_function" href="classllvm_1_1ProfileSummary.html#a59f76c736c482a9d03fbb0f5c42b3992">getMD</a>(M.getContext()),</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>                        <a class="code hl_enumvalue" href="classllvm_1_1ProfileSummary.html#aa5aa682b3904e88749fa973b3da370c2a0c86eaeebf5b6120b601ecc93a1c2e3a">ProfileSummary::PSK_Sample</a>);</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>    PSI-&gt;refresh();</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>  }</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>  <span class="comment">// Compute the total number of samples collected in this profile.</span></div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Reader-&gt;getProfiles())</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>    TotalCollectedSamples += <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.second.getTotalSamples();</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span> </div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>  <span class="keyword">auto</span> Remapper = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a530222c3b645acc9170003d046753e94">getRemapper</a>();</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>  <span class="comment">// Populate the symbol map.</span></div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">N_F</a> : M.getValueSymbolTable()) {</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>    <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">N_F</a>.getKey();</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;Function&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">N_F</a>.getValue());</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> == <span class="keyword">nullptr</span> || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>.empty())</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>    <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>] = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>    <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewName</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">FunctionSamples::getCanonicalFnName</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewName</a> &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewName</a>.empty()) {</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>      <span class="keyword">auto</span> r = <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make_pair(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewName</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>      <span class="comment">// Failiing to insert means there is already an entry in SymbolMap,</span></div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>      <span class="comment">// thus there are multiple functions that are mapped to the same</span></div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>      <span class="comment">// stripped name. In this case of name conflicting, set the value</span></div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>      <span class="comment">// to nullptr to avoid confusion.</span></div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>      <span class="keywordflow">if</span> (!r.second)</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>        r.first-&gt;second = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewName</a>;</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>    }</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>    <span class="comment">// Insert the remapped names into SymbolMap.</span></div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    <span class="keywordflow">if</span> (Remapper) {</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MapName</a> = Remapper-&gt;lookUpNameInProfile(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a>)) {</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>        <span class="keywordflow">if</span> (*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MapName</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigName</a> &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MapName</a>-&gt;empty())</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>          <a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make_pair(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MapName</a>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>));</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>      }</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>    }</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>  }</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_typedef" href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">SymbolMap</a>.<a class="code hl_function" href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">count</a>(<a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a>()) == 0 &amp;&amp;</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>         <span class="stringliteral">&quot;No empty StringRef should be added in SymbolMap&quot;</span>);</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span> </div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">retval</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">buildFunctionOrder</a>(M, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>)) {</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;isDeclaration());</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>    clearFunctionData();</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">retval</a> |= <a class="code hl_function" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AM);</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>  }</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span> </div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>  <span class="comment">// Account for cold calls not inlined....</span></div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>  <span class="keywordflow">if</span> (!ProfileIsCSFlat)</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;Function *, NotInlinedProfileInfo&gt; &amp;pair :</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>         notInlinedCallInfo)</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>      <a class="code hl_function" href="namespacellvm.html#aa7cd2cc36098475563ad0fd3371df2a6">updateProfileCallee</a>(pair.first, pair.second.entryCount);</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span> </div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>  <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">retval</a>;</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>}</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span> </div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span><span class="keywordtype">bool</span> SampleProfileLoaderLegacyPass::runOnModule(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>  ACT = &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getAnalysis&lt;AssumptionCacheTracker&gt;</a>();</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>  TTIWP = &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getAnalysis&lt;TargetTransformInfoWrapperPass&gt;</a>();</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>  TLIWP = &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;</a>();</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>  <a class="code hl_class" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI =</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>      &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getAnalysis&lt;ProfileSummaryInfoWrapperPass&gt;</a>().getPSI();</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>  <span class="keywordflow">return</span> SampleLoader.runOnModule(M, <span class="keyword">nullptr</span>, PSI, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>}</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span> </div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span><span class="keywordtype">bool</span> SampleProfileLoader::runOnFunction(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> *AM) {</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>  <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;\n\nProcessing Function &quot;</span> &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>  DILocation2SampleMap.clear();</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>  <span class="comment">// By default the entry count is initialized to -1, which will be treated</span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>  <span class="comment">// conservatively by getEntryCount as the same as unknown (None). This is</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>  <span class="comment">// to avoid newly added code to be treated as cold. If we have samples</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>  <span class="comment">// this will be overwritten in emitAnnotations.</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>  <a class="code hl_class" href="classuint64__t.html">uint64_t</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">initialEntryCount</a> = -1;</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span> </div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>  ProfAccForSymsInList = <a class="code hl_variable" href="SampleProfile_8cpp.html#a8aa89f0866c6f65d2395b74e851e73f7">ProfileAccurateForSymsInList</a> &amp;&amp; PSL;</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a> || <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(<span class="stringliteral">&quot;profile-sample-accurate&quot;</span>)) {</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>    <span class="comment">// initialize all the function entry counts to 0. It means all the</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>    <span class="comment">// functions without profile will be regarded as cold.</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">initialEntryCount</a> = 0;</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>    <span class="comment">// profile-sample-accurate is a user assertion which has a higher precedence</span></div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>    <span class="comment">// than symbol list. When profile-sample-accurate is on, ignore symbol list.</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>    ProfAccForSymsInList = <span class="keyword">false</span>;</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>  }</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>  CoverageTracker.setProfAccForSymsInList(ProfAccForSymsInList);</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span> </div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>  <span class="comment">// PSL -- profile symbol list include all the symbols in sampled binary.</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>  <span class="comment">// If ProfileAccurateForSymsInList is enabled, PSL is used to treat</span></div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>  <span class="comment">// old functions without samples being cold, without having to worry</span></div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>  <span class="comment">// about new and hot functions being mistakenly treated as cold.</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>  <span class="keywordflow">if</span> (ProfAccForSymsInList) {</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>    <span class="comment">// Initialize the entry count to 0 for functions in the list.</span></div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>    <span class="keywordflow">if</span> (PSL-&gt;contains(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()))</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">initialEntryCount</a> = 0;</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span> </div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>    <span class="comment">// Function in the symbol list but without sample will be regarded as</span></div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>    <span class="comment">// cold. To minimize the potential negative performance impact it could</span></div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>    <span class="comment">// have, we want to be a little conservative here saying if a function</span></div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>    <span class="comment">// shows up in the profile, no matter as outline function, inline instance</span></div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>    <span class="comment">// or call targets, treat the function as not being cold. This will handle</span></div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>    <span class="comment">// the cases such as most callsites of a function are inlined in sampled</span></div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>    <span class="comment">// binary but not inlined in current build (because of source code drift,</span></div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>    <span class="comment">// imprecise debug information, or the callsites are all cold individually</span></div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>    <span class="comment">// but not cold accumulatively...), so the outline function showing up as</span></div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>    <span class="comment">// cold in sampled binary will actually not be cold after current build.</span></div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>    <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a> = <a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">FunctionSamples::getCanonicalFnName</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>    <span class="keywordflow">if</span> (NamesInProfile.<a class="code hl_function" href="classllvm_1_1StringMap.html#a9846bb2bc5672e7627011260772b8d09">count</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CanonName</a>))</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">initialEntryCount</a> = -1;</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>  }</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span> </div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>  <span class="comment">// Initialize entry count when the function has no existing entry</span></div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>  <span class="comment">// count value.</span></div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryCount().hasValue())</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>    <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.setEntryCount(<a class="code hl_typedef" href="namespacellvm.html#a854ac9cfc31bb306b1495a508707dc26">ProfileCount</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">initialEntryCount</a>, <a class="code hl_enumvalue" href="classllvm_1_1Function.html#a438d2f246b76817114ade2a005a6bcabac7dbc704eba08842e6acdde9cf6379ba">Function::PCT_Real</a>));</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>  std::unique_ptr&lt;OptimizationRemarkEmitter&gt; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OwnedORE</a>;</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>  <span class="keywordflow">if</span> (AM) {</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>    <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>        AM-&gt;<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent())</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>            .getManager();</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>    ORE = &amp;<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">OptimizationRemarkEmitterAnalysis</a>&gt;(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OwnedORE</a> = std::make_unique&lt;OptimizationRemarkEmitter&gt;(&amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>    ORE = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OwnedORE</a>.get();</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>  }</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span> </div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>  <span class="keywordflow">if</span> (ProfileIsCSFlat)</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>    Samples = ContextTracker-&gt;getBaseSamplesFor(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>    Samples = Reader-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a231496cee212bad0c2b9fa7877dc0cb4">getSamplesFor</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span> </div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>  <span class="keywordflow">if</span> (Samples &amp;&amp; !Samples-&gt;<a class="code hl_function" href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa1b0659ee7d8e17ab407b3bd902e280c">empty</a>())</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">emitAnnotations</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>}</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span> </div>
<div class="foldopen" id="foldopen02171" data-start="{" data-end="}">
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"><a class="line" href="classllvm_1_1SampleProfileLoaderPass.html#a324d3696b255beea7cfd1e8b901b2363"> 2171</a></span><a class="code hl_class" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code hl_function" href="classllvm_1_1SampleProfileLoaderPass.html#a324d3696b255beea7cfd1e8b901b2363">SampleProfileLoaderPass::run</a>(<a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M,</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>                                               <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">ModuleAnalysisManager</a> &amp;AM) {</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>  <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a> =</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>      AM.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1InnerAnalysisManagerProxy.html">FunctionAnalysisManagerModuleProxy</a>&gt;(M).getManager();</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span> </div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>  <span class="keyword">auto</span> GetAssumptionCache = [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code hl_class" href="classllvm_1_1AssumptionCache.html">AssumptionCache</a> &amp; {</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1AssumptionAnalysis.html">AssumptionAnalysis</a>&gt;(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>  };</div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>  <span class="keyword">auto</span> GetTTI = [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <a class="code hl_class" href="classllvm_1_1TargetTransformInfo.html">TargetTransformInfo</a> &amp; {</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1TargetIRAnalysis.html">TargetIRAnalysis</a>&gt;(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>  };</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>  <span class="keyword">auto</span> GetTLI = [&amp;](<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) -&gt; <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1TargetLibraryInfo.html">TargetLibraryInfo</a> &amp; {</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1TargetLibraryAnalysis.html">TargetLibraryAnalysis</a>&gt;(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>  };</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span> </div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span>  SampleProfileLoader SampleLoader(</div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>      ProfileFileName.empty() ? <a class="code hl_variable" href="SampleProfile_8cpp.html#a055c6b7054a94b338830b3da8ecc4023">SampleProfileFile</a> : ProfileFileName,</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>      ProfileRemappingFileName.empty() ? <a class="code hl_variable" href="SampleProfile_8cpp.html#af8d3791537a44c00b699d28c4d978d82">SampleProfileRemappingFile</a></div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span>                                       : ProfileRemappingFileName,</div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>      LTOPhase, GetAssumptionCache, GetTTI, GetTLI);</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span> </div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>  <span class="keywordflow">if</span> (!SampleLoader.doInitialization(M, &amp;<a class="code hl_variable" href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>))</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span> </div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>  <a class="code hl_class" href="classllvm_1_1ProfileSummaryInfo.html">ProfileSummaryInfo</a> *PSI = &amp;AM.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1ProfileSummaryAnalysis.html">ProfileSummaryAnalysis</a>&gt;(M);</div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>  <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a> = AM.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1CallGraphAnalysis.html">CallGraphAnalysis</a>&gt;(M);</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>  <span class="keywordflow">if</span> (!SampleLoader.runOnModule(M, &amp;AM, PSI, &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>))</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span> </div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>}</div>
</div>
<div class="ttc" id="aAArch64PromoteConstant_8cpp_html_a90f8350fecae261c25be85d38b451bff"><div class="ttname"><a href="AArch64PromoteConstant_8cpp.html#a90f8350fecae261c25be85d38b451bff">const</a></div><div class="ttdeci">aarch64 promote const</div><div class="ttdef"><b>Definition</b> <a href="AArch64PromoteConstant_8cpp_source.html#l00232">AArch64PromoteConstant.cpp:232</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition</b> <a href="AMDGPULibCalls_8cpp_source.html#l00186">AMDGPULibCalls.cpp:186</a></div></div>
<div class="ttc" id="aArrayRef_8h_html"><div class="ttname"><a href="ArrayRef_8h.html">ArrayRef.h</a></div></div>
<div class="ttc" id="aAssumptionCache_8h_html"><div class="ttname"><a href="AssumptionCache_8h.html">AssumptionCache.h</a></div></div>
<div class="ttc" id="aBasicBlockSections_8cpp_html_a5e5c642a0309c0657f3efa8a8b687008"><div class="ttname"><a href="BasicBlockSections_8cpp.html#a5e5c642a0309c0657f3efa8a8b687008">for</a></div><div class="ttdeci">for(auto &amp;MBB :MF)</div><div class="ttdef"><b>Definition</b> <a href="BasicBlockSections_8cpp_source.html#l00180">BasicBlockSections.cpp:180</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aBlockFrequencyInfoImpl_8h_html"><div class="ttname"><a href="BlockFrequencyInfoImpl_8h.html">BlockFrequencyInfoImpl.h</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a694d9607a781d330039787de0726acc0"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a></div><div class="ttdeci">static GCRegistry::Add&lt; ShadowStackGC &gt; C(&quot;shadow-stack&quot;, &quot;Very portable GC for uncooperative code generators&quot;)</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_ab5899ca200d34e3cc6bb09ebce5e5b3c"><div class="ttname"><a href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aCallGraphSCCPass_8h_html"><div class="ttname"><a href="CallGraphSCCPass_8h.html">CallGraphSCCPass.h</a></div></div>
<div class="ttc" id="aCallGraph_8h_html"><div class="ttname"><a href="CallGraph_8h.html">CallGraph.h</a></div><div class="ttdoc">This file provides interfaces used to build and manipulate a call graph, which is a very useful tool ...</div></div>
<div class="ttc" id="aCallPromotionUtils_8h_html"><div class="ttname"><a href="CallPromotionUtils_8h.html">CallPromotionUtils.h</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aCloning_8h_html"><div class="ttname"><a href="Cloning_8h.html">Cloning.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html"><div class="ttname"><a href="CommandLine_8h.html">CommandLine.h</a></div></div>
<div class="ttc" id="aCommandLine_8h_html_a187fd767976b311c09dff5e05ac0c1bc"><div class="ttname"><a href="CommandLine_8h.html#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a></div><div class="ttdeci">#define clEnumValN(ENUMVAL, FLAGNAME, DESC)</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00672">CommandLine.h:672</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a1b7259e431066a500b6b6e7267fad8c3"><div class="ttname"><a href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a></div><div class="ttdeci">return Changed</div><div class="ttdef"><b>Definition</b> <a href="CoroSplit_8cpp_source.html#l02161">CoroSplit.cpp:2161</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a870dde7776fd5695fbfa39d3c6396fc6"><div class="ttname"><a href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a></div><div class="ttdeci">Remove calls to llvm coro prepare a barrier meant to prevent IPO from operating on calls to a retcon coroutine before it s been split This is only safe to do after we ve split all retcon coroutines in the module We can do that this in this pass because this pass does promise to split all retcon CallGraph &amp; CG</div><div class="ttdef"><b>Definition</b> <a href="CoroSplit_8cpp_source.html#l02152">CoroSplit.cpp:2152</a></div></div>
<div class="ttc" id="aDebugInfoMetadata_8h_html"><div class="ttname"><a href="DebugInfoMetadata_8h.html">DebugInfoMetadata.h</a></div></div>
<div class="ttc" id="aDebugLoc_8h_html"><div class="ttname"><a href="DebugLoc_8h.html">DebugLoc.h</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition</b> <a href="Debug_8h_source.html#l00101">Debug.h:101</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div><div class="ttdoc">This file defines the DenseMap class.</div></div>
<div class="ttc" id="aDenseSet_8h_html"><div class="ttname"><a href="DenseSet_8h.html">DenseSet.h</a></div><div class="ttdoc">This file defines the DenseSet and SmallDenseSet classes.</div></div>
<div class="ttc" id="aDiagnosticInfo_8h_html"><div class="ttname"><a href="DiagnosticInfo_8h.html">DiagnosticInfo.h</a></div></div>
<div class="ttc" id="aDominators_8h_html"><div class="ttname"><a href="Dominators_8h.html">Dominators.h</a></div></div>
<div class="ttc" id="aELFObjHandler_8cpp_html_adc852f586959ce13117d737cf3f14899"><div class="ttname"><a href="ELFObjHandler_8cpp.html#adc852f586959ce13117d737cf3f14899">Name</a></div><div class="ttdeci">std::string Name</div><div class="ttdef"><b>Definition</b> <a href="ELFObjHandler_8cpp_source.html#l00077">ELFObjHandler.cpp:77</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00069">EntryExitInstrumenter.cpp:69</a></div></div>
<div class="ttc" id="aErrorOr_8h_html"><div class="ttname"><a href="ErrorOr_8h.html">ErrorOr.h</a></div><div class="ttdoc">Provides ErrorOr&lt;T&gt; smart pointer.</div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aGenericCycleImpl_8h_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="GenericCycleImpl_8h.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition</b> <a href="GenericCycleImpl_8h_source.html#l00030">GenericCycleImpl.h:30</a></div></div>
<div class="ttc" id="aGenericDomTree_8h_html"><div class="ttname"><a href="GenericDomTree_8h.html">GenericDomTree.h</a></div><div class="ttdoc">This file defines a set of templates that efficiently compute a dominator tree over a generic graph.</div></div>
<div class="ttc" id="aGlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="aHexagonEarlyIfConv_8cpp_html_a69e1845bcbb3948c6e36bbbfb71e8024"><div class="ttname"><a href="HexagonEarlyIfConv_8cpp.html#a69e1845bcbb3948c6e36bbbfb71e8024">SizeLimit</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; SizeLimit(&quot;eif-limit&quot;, cl::init(6), cl::Hidden, cl::desc(&quot;Size limit in Hexagon early if-conversion&quot;))</div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div><div class="ttdoc">This file provides various utilities for inspecting and working with the control flow graph in LLVM I...</div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aIndirectCallPromotionAnalysis_8cpp_html_aa795fb757850901815176ac62ad68196"><div class="ttname"><a href="IndirectCallPromotionAnalysis_8cpp.html#aa795fb757850901815176ac62ad68196">MaxNumPromotions</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxNumPromotions(&quot;icp-max-prom&quot;, cl::init(3), cl::Hidden, cl::ZeroOrMore, cl::desc(&quot;Max number of promotions for a single indirect &quot; &quot;call callsite&quot;))</div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aInlineAdvisor_8h_html"><div class="ttname"><a href="InlineAdvisor_8h.html">InlineAdvisor.h</a></div></div>
<div class="ttc" id="aInlineCost_8h_html"><div class="ttname"><a href="InlineCost_8h.html">InlineCost.h</a></div></div>
<div class="ttc" id="aInstrProf_8h_html"><div class="ttname"><a href="InstrProf_8h.html">InstrProf.h</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aInstrumentation_8h_html"><div class="ttname"><a href="Instrumentation_8h.html">Instrumentation.h</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="aLoopInfo_8h_html"><div class="ttname"><a href="LoopInfo_8h.html">LoopInfo.h</a></div></div>
<div class="ttc" id="aLoopUnswitch_8cpp_html_af2ed775d49ada2eede225b2fae288a9f"><div class="ttname"><a href="LoopUnswitch_8cpp.html#af2ed775d49ada2eede225b2fae288a9f">Threshold</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; Threshold(&quot;loop-unswitch-threshold&quot;, cl::desc(&quot;Max loop size to unswitch&quot;), cl::init(100), cl::Hidden)</div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition</b> <a href="MD5_8cpp_source.html#l00055">MD5.cpp:55</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition</b> <a href="MD5_8cpp_source.html#l00058">MD5.cpp:58</a></div></div>
<div class="ttc" id="aMDBuilder_8h_html"><div class="ttname"><a href="MDBuilder_8h.html">MDBuilder.h</a></div></div>
<div class="ttc" id="aMIRSampleProfile_8cpp_html_a009775794ead70aa23c76df46ab4ed8a"><div class="ttname"><a href="MIRSampleProfile_8cpp.html#a009775794ead70aa23c76df46ab4ed8a">Profile</a></div><div class="ttdeci">Load MIR Sample Profile</div><div class="ttdef"><b>Definition</b> <a href="MIRSampleProfile_8cpp_source.html#l00062">MIRSampleProfile.cpp:62</a></div></div>
<div class="ttc" id="aMemoryBuiltins_8cpp_html_abb8baff9e770c39d9585de30a989bca7"><div class="ttname"><a href="MemoryBuiltins_8cpp.html#abb8baff9e770c39d9585de30a989bca7">getCalledFunction</a></div><div class="ttdeci">static const Function * getCalledFunction(const Value *V, bool &amp;IsNoBuiltin)</div><div class="ttdef"><b>Definition</b> <a href="MemoryBuiltins_8cpp_source.html#l00117">MemoryBuiltins.cpp:117</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div><div class="ttdoc">Module.h This file contains the declarations for the Module class.</div></div>
<div class="ttc" id="aNone_8h_html"><div class="ttname"><a href="None_8h.html">None.h</a></div><div class="ttdoc">This file provides None, an enumerator for use in implicit constructors of various (usually templated...</div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a0f79dad1efc582555a443cc11a8fa401"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a0f79dad1efc582555a443cc11a8fa401">SI</a></div><div class="ttdeci">StandardInstrumentations SI(Debug, VerifyEach)</div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a2123399ae32cbb1ca753fdfa99756b5c"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a2123399ae32cbb1ca753fdfa99756b5c">if</a></div><div class="ttdeci">if(VerifyEach)</div><div class="ttdef"><b>Definition</b> <a href="PassBuilderBindings_8cpp_source.html#l00071">PassBuilderBindings.cpp:71</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_a83c7e5ca51099e4efa895791a02fb0ed"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a></div><div class="ttdeci">FunctionAnalysisManager FAM</div><div class="ttdef"><b>Definition</b> <a href="PassBuilderBindings_8cpp_source.html#l00059">PassBuilderBindings.cpp:59</a></div></div>
<div class="ttc" id="aPassManager_8h_html"><div class="ttname"><a href="PassManager_8h.html">PassManager.h</a></div><div class="ttdoc">This header defines various interfaces for pass management in LLVM.</div></div>
<div class="ttc" id="aPassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00054">PassSupport.h:54</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00058">PassSupport.h:58</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_aaa970fc931c1c63037a8182e028d04b1"><div class="ttname"><a href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">#define INITIALIZE_PASS_BEGIN(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00051">PassSupport.h:51</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aPostDominators_8h_html"><div class="ttname"><a href="PostDominators_8h.html">PostDominators.h</a></div></div>
<div class="ttc" id="aPriorityQueue_8h_html"><div class="ttname"><a href="PriorityQueue_8h.html">PriorityQueue.h</a></div><div class="ttdoc">This file defines the PriorityQueue class.</div></div>
<div class="ttc" id="aProfileSummaryInfo_8h_html"><div class="ttname"><a href="ProfileSummaryInfo_8h.html">ProfileSummaryInfo.h</a></div></div>
<div class="ttc" id="aProfiledCallGraph_8h_html"><div class="ttname"><a href="ProfiledCallGraph_8h.html">ProfiledCallGraph.h</a></div></div>
<div class="ttc" id="aReplayInlineAdvisor_8h_html"><div class="ttname"><a href="ReplayInlineAdvisor_8h.html">ReplayInlineAdvisor.h</a></div></div>
<div class="ttc" id="aSCCIterator_8h_html"><div class="ttname"><a href="SCCIterator_8h.html">SCCIterator.h</a></div><div class="ttdoc">This builds on the llvm/ADT/GraphTraits.h file to find the strongly connected components (SCCs) of a ...</div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aSampleContextTracker_8h_html"><div class="ttname"><a href="SampleContextTracker_8h.html">SampleContextTracker.h</a></div><div class="ttdoc">This file provides the interface for context-sensitive profile tracker used by CSSPGO.</div></div>
<div class="ttc" id="aSampleProfReader_8h_html"><div class="ttname"><a href="SampleProfReader_8h.html">SampleProfReader.h</a></div></div>
<div class="ttc" id="aSampleProf_8h_html"><div class="ttname"><a href="SampleProf_8h.html">SampleProf.h</a></div></div>
<div class="ttc" id="aSampleProfileInference_8h_html"><div class="ttname"><a href="SampleProfileInference_8h.html">SampleProfileInference.h</a></div><div class="ttdoc">This file provides the interface for the profile inference algorithm, profi.</div></div>
<div class="ttc" id="aSampleProfileLoaderBaseImpl_8h_html"><div class="ttname"><a href="SampleProfileLoaderBaseImpl_8h.html">SampleProfileLoaderBaseImpl.h</a></div><div class="ttdoc">This file provides the interface for the sampled PGO profile loader base implementation.</div></div>
<div class="ttc" id="aSampleProfileLoaderBaseUtil_8h_html"><div class="ttname"><a href="SampleProfileLoaderBaseUtil_8h.html">SampleProfileLoaderBaseUtil.h</a></div><div class="ttdoc">This file provides the utility functions for the sampled PGO loader base implementation.</div></div>
<div class="ttc" id="aSampleProfileProbe_8h_html"><div class="ttname"><a href="SampleProfileProbe_8h.html">SampleProfileProbe.h</a></div><div class="ttdoc">This file provides the interface for the pseudo probe implementation for AutoFDO.</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a033aa3e7e3e183cec38f5a5e36e212c7"><div class="ttname"><a href="SampleProfile_8cpp.html#a033aa3e7e3e183cec38f5a5e36e212c7">SampleHotCallSiteThreshold</a></div><div class="ttdeci">cl::opt&lt; int &gt; SampleHotCallSiteThreshold(&quot;sample-profile-hot-inline-threshold&quot;, cl::Hidden, cl::init(3000), cl::desc(&quot;Hot callsite threshold for proirity-based sample profile loader &quot; &quot;inlining.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a055c6b7054a94b338830b3da8ecc4023"><div class="ttname"><a href="SampleProfile_8cpp.html#a055c6b7054a94b338830b3da8ecc4023">SampleProfileFile</a></div><div class="ttdeci">static cl::opt&lt; std::string &gt; SampleProfileFile(&quot;sample-profile-file&quot;, cl::init(&quot;&quot;), cl::value_desc(&quot;filename&quot;), cl::desc(&quot;Profile file loaded by -sample-profile&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a1fb5d0753c33e3b86aa1094bc2427bba"><div class="ttname"><a href="SampleProfile_8cpp.html#a1fb5d0753c33e3b86aa1094bc2427bba">SortProfiledSCC</a></div><div class="ttdeci">cl::opt&lt; bool &gt; SortProfiledSCC(&quot;sort-profiled-scc-member&quot;, cl::init(true), cl::Hidden, cl::desc(&quot;Sort profiled recursion by edge weights.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a1fbf05aa3c19fb9ce58e03dcca69e493"><div class="ttname"><a href="SampleProfile_8cpp.html#a1fbf05aa3c19fb9ce58e03dcca69e493">ProfileInlineLimitMax</a></div><div class="ttdeci">cl::opt&lt; int &gt; ProfileInlineLimitMax(&quot;sample-profile-inline-limit-max&quot;, cl::Hidden, cl::init(10000), cl::desc(&quot;The upper bound of size growth limit for &quot; &quot;proirity-based sample profile loader inlining.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a2612d121382d9498fc6fc0acd70a0cf4"><div class="ttname"><a href="SampleProfile_8cpp.html#a2612d121382d9498fc6fc0acd70a0cf4">ProfileSampleBlockAccurate</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileSampleBlockAccurate(&quot;profile-sample-block-accurate&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;If the sample profile is accurate, we will mark all un-sampled &quot; &quot;branches and calls as having 0 samples. Otherwise, treat &quot; &quot;them conservatively as unknown. &quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a34bb82df4ca701e695848fa1b4d17250"><div class="ttname"><a href="SampleProfile_8cpp.html#a34bb82df4ca701e695848fa1b4d17250">MaxNumPromotions</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; MaxNumPromotions(&quot;sample-profile-icp-max-prom&quot;, cl::init(3), cl::Hidden, cl::ZeroOrMore, cl::desc(&quot;Max number of promotions for a single indirect &quot; &quot;call callsite in sample profile loader&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a477f441a65d57a1d0bff97e993e0f5d3"><div class="ttname"><a href="SampleProfile_8cpp.html#a477f441a65d57a1d0bff97e993e0f5d3">ProfileInlineReplayFallback</a></div><div class="ttdeci">static cl::opt&lt; ReplayInlinerSettings::Fallback &gt; ProfileInlineReplayFallback(&quot;sample-profile-inline-replay-fallback&quot;, cl::init(ReplayInlinerSettings::Fallback::Original), cl::values(clEnumValN(ReplayInlinerSettings::Fallback::Original, &quot;Original&quot;, &quot;All decisions not in replay send to original advisor (default)&quot;), clEnumValN(ReplayInlinerSettings::Fallback::AlwaysInline, &quot;AlwaysInline&quot;, &quot;All decisions not in replay are inlined&quot;), clEnumValN(ReplayInlinerSettings::Fallback::NeverInline, &quot;NeverInline&quot;, &quot;All decisions not in replay are not inlined&quot;)), cl::desc(&quot;How sample profile inline replay treats sites that don't come &quot; &quot;from the replay. Original: defers to original advisor, &quot; &quot;AlwaysInline: inline all sites not in replay, NeverInline: &quot; &quot;inline no sites not in replay&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a4880524206cd6bd2551dda5c915be189"><div class="ttname"><a href="SampleProfile_8cpp.html#a4880524206cd6bd2551dda5c915be189">OverwriteExistingWeights</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; OverwriteExistingWeights(&quot;overwrite-existing-weights&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Ignore existing branch weights on IR and always overwrite.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a49c3e5d8ca3d71fa3e107a4aa0b6bf72"><div class="ttname"><a href="SampleProfile_8cpp.html#a49c3e5d8ca3d71fa3e107a4aa0b6bf72">UsePreInlinerDecision</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; UsePreInlinerDecision(&quot;sample-profile-use-preinliner&quot;, cl::Hidden, cl::ZeroOrMore, cl::init(false), cl::desc(&quot;Use the preinliner decisions stored in profile context.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a582e224bc99dcf3ca6263cdd9b25d94f"><div class="ttname"><a href="SampleProfile_8cpp.html#a582e224bc99dcf3ca6263cdd9b25d94f">CallsitePrioritizedInline</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; CallsitePrioritizedInline(&quot;sample-profile-prioritized-inline&quot;, cl::Hidden, cl::ZeroOrMore, cl::init(false), cl::desc(&quot;Use call site prioritized inlining for sample profile loader.&quot; &quot;Currently only CSSPGO is supported.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a5c3b919b227c332257bcc77ec8c9df00"><div class="ttname"><a href="SampleProfile_8cpp.html#a5c3b919b227c332257bcc77ec8c9df00">updateIDTMetaData</a></div><div class="ttdeci">static void updateIDTMetaData(Instruction &amp;Inst, const SmallVectorImpl&lt; InstrProfValueData &gt; &amp;CallTargets, uint64_t Sum)</div><div class="ttdoc">Update indirect call target profile metadata for Inst.</div><div class="ttdef"><b>Definition</b> <a href="#l00839">SampleProfile.cpp:839</a></div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a6c063cf654bf13a20d00365c2ef7b1da"><div class="ttname"><a href="SampleProfile_8cpp.html#a6c063cf654bf13a20d00365c2ef7b1da">SampleColdCallSiteThreshold</a></div><div class="ttdeci">cl::opt&lt; int &gt; SampleColdCallSiteThreshold(&quot;sample-profile-cold-inline-threshold&quot;, cl::Hidden, cl::init(45), cl::desc(&quot;Threshold for inlining cold callsites&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a6f2891ea30bbf02e93cc94ca385d8d91"><div class="ttname"><a href="SampleProfile_8cpp.html#a6f2891ea30bbf02e93cc94ca385d8d91">ProfileInlineGrowthLimit</a></div><div class="ttdeci">cl::opt&lt; int &gt; ProfileInlineGrowthLimit(&quot;sample-profile-inline-growth-limit&quot;, cl::Hidden, cl::init(12), cl::desc(&quot;The size growth ratio limit for proirity-based sample profile &quot; &quot;loader inlining.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a732d61bd469914910adee6ed8c8c4a38"><div class="ttname"><a href="SampleProfile_8cpp.html#a732d61bd469914910adee6ed8c8c4a38">ProfileInlineReplayFile</a></div><div class="ttdeci">static cl::opt&lt; std::string &gt; ProfileInlineReplayFile(&quot;sample-profile-inline-replay&quot;, cl::init(&quot;&quot;), cl::value_desc(&quot;filename&quot;), cl::desc(&quot;Optimization remarks file containing inline remarks to be replayed &quot; &quot;by inlining from sample profile loader.&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a8aa89f0866c6f65d2395b74e851e73f7"><div class="ttname"><a href="SampleProfile_8cpp.html#a8aa89f0866c6f65d2395b74e851e73f7">ProfileAccurateForSymsInList</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileAccurateForSymsInList(&quot;profile-accurate-for-symsinlist&quot;, cl::Hidden, cl::ZeroOrMore, cl::init(true), cl::desc(&quot;For symbols in profile symbol list, regard their profiles to &quot; &quot;be accurate. It may be overriden by profile-sample-accurate. &quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_a8b16dbb3ebefd05908afe3a7874d6353"><div class="ttname"><a href="SampleProfile_8cpp.html#a8b16dbb3ebefd05908afe3a7874d6353">ProfileMergeInlinee</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileMergeInlinee(&quot;sample-profile-merge-inlinee&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Merge past inlinee's profile to outline version if sample &quot; &quot;profile loader decided not to inline a call site. It will &quot; &quot;only be enabled when top-down order of profile loading is &quot; &quot;enabled. &quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_aa2ce415bf980facbbfb4eb13a1e9ce54"><div class="ttname"><a href="SampleProfile_8cpp.html#aa2ce415bf980facbbfb4eb13a1e9ce54">doesHistoryAllowICP</a></div><div class="ttdeci">static bool doesHistoryAllowICP(const Instruction &amp;Inst, StringRef Candidate)</div><div class="ttdoc">Check whether the indirect call promotion history of Inst allows the promotion for Candidate.</div><div class="ttdef"><b>Definition</b> <a href="#l00802">SampleProfile.cpp:802</a></div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_aa6d0a32738af9bd060dcfe35c6ee4b44"><div class="ttname"><a href="SampleProfile_8cpp.html#aa6d0a32738af9bd060dcfe35c6ee4b44">loader</a></div><div class="ttdeci">sample Sample Profile loader</div><div class="ttdef"><b>Definition</b> <a href="#l01796">SampleProfile.cpp:1796</a></div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_aaf55fbc9b8550957ceb81da6a13f54e4"><div class="ttname"><a href="SampleProfile_8cpp.html#aaf55fbc9b8550957ceb81da6a13f54e4">GetSortedValueDataFromCallTargets</a></div><div class="ttdeci">static SmallVector&lt; InstrProfValueData, 2 &gt; GetSortedValueDataFromCallTargets(const SampleRecord::CallTargetMap &amp;M)</div><div class="ttdoc">Returns the sorted CallTargetMap M by count in descending order.</div><div class="ttdef"><b>Definition</b> <a href="#l01573">SampleProfile.cpp:1573</a></div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ab4932d7673e6e1138d8a2671f16865d1"><div class="ttname"><a href="SampleProfile_8cpp.html#ab4932d7673e6e1138d8a2671f16865d1">CSINLINE_DEBUG</a></div><div class="ttdeci">#define CSINLINE_DEBUG</div><div class="ttdef"><b>Definition</b> <a href="#l00108">SampleProfile.cpp:108</a></div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ab5c0de16382c784463afd1d0749521b2"><div class="ttname"><a href="SampleProfile_8cpp.html#ab5c0de16382c784463afd1d0749521b2">UseProfiledCallGraph</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; UseProfiledCallGraph(&quot;use-profiled-call-graph&quot;, cl::init(true), cl::Hidden, cl::desc(&quot;Process functions in a top-down order &quot; &quot;defined by the profiled call graph when &quot; &quot;-sample-profile-top-down-load is on.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ab75eb24423b8e8d730f81eec23e93f43"><div class="ttname"><a href="SampleProfile_8cpp.html#ab75eb24423b8e8d730f81eec23e93f43">ProfileInlineReplayScope</a></div><div class="ttdeci">static cl::opt&lt; ReplayInlinerSettings::Scope &gt; ProfileInlineReplayScope(&quot;sample-profile-inline-replay-scope&quot;, cl::init(ReplayInlinerSettings::Scope::Function), cl::values(clEnumValN(ReplayInlinerSettings::Scope::Function, &quot;Function&quot;, &quot;Replay on functions that have remarks associated &quot; &quot;with them (default)&quot;), clEnumValN(ReplayInlinerSettings::Scope::Module, &quot;Module&quot;, &quot;Replay on the entire module&quot;)), cl::desc(&quot;Whether inline replay should be applied to the entire &quot; &quot;Module or just the Functions (default) that are present as &quot; &quot;callers in remarks during sample profile inlining.&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_abe3f89debe4f7888460625789de78083"><div class="ttname"><a href="SampleProfile_8cpp.html#abe3f89debe4f7888460625789de78083">ProfileICPRelativeHotness</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ProfileICPRelativeHotness(&quot;sample-profile-icp-relative-hotness&quot;, cl::Hidden, cl::init(25), cl::desc(&quot;Relative hotness percentage threshold for indirect &quot; &quot;call promotion in proirity-based sample profile loader inlining.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ac689c456b39941e3af203d3e1750b8b5"><div class="ttname"><a href="SampleProfile_8cpp.html#ac689c456b39941e3af203d3e1750b8b5">ProfileICPRelativeHotnessSkip</a></div><div class="ttdeci">static cl::opt&lt; unsigned &gt; ProfileICPRelativeHotnessSkip(&quot;sample-profile-icp-relative-hotness-skip&quot;, cl::Hidden, cl::init(1), cl::desc(&quot;Skip relative hotness check for ICP up to given number of targets.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ad9e241873d83708f939301b0065c6009"><div class="ttname"><a href="SampleProfile_8cpp.html#ad9e241873d83708f939301b0065c6009">AllowRecursiveInline</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; AllowRecursiveInline(&quot;sample-profile-recursive-inline&quot;, cl::Hidden, cl::ZeroOrMore, cl::init(false), cl::desc(&quot;Allow sample loader inliner to inline recursive calls.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ada8f2c564085d598909fb28464614812"><div class="ttname"><a href="SampleProfile_8cpp.html#ada8f2c564085d598909fb28464614812">ProfileSizeInline</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileSizeInline(&quot;sample-profile-inline-size&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Inline cold call sites in profile loader if it's beneficial &quot; &quot;for code size.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_ae2b46e6b1f93e3b18b20d0c0c0ac6151"><div class="ttname"><a href="SampleProfile_8cpp.html#ae2b46e6b1f93e3b18b20d0c0c0ac6151">ProfileInlineLimitMin</a></div><div class="ttdeci">cl::opt&lt; int &gt; ProfileInlineLimitMin(&quot;sample-profile-inline-limit-min&quot;, cl::Hidden, cl::init(100), cl::desc(&quot;The lower bound of size growth limit for &quot; &quot;proirity-based sample profile loader inlining.&quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_aeeed05c14d5103af2df4ef16b3d12674"><div class="ttname"><a href="SampleProfile_8cpp.html#aeeed05c14d5103af2df4ef16b3d12674">ProfileTopDownLoad</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileTopDownLoad(&quot;sample-profile-top-down-load&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Do profile annotation and inlining for functions in top-down &quot; &quot;order of call graph during sample profile loading. It only &quot; &quot;works for new pass manager. &quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_af00e1c8a074b97aedd1a2db33dea6753"><div class="ttname"><a href="SampleProfile_8cpp.html#af00e1c8a074b97aedd1a2db33dea6753">ProfileSampleAccurate</a></div><div class="ttdeci">static cl::opt&lt; bool &gt; ProfileSampleAccurate(&quot;profile-sample-accurate&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;If the sample profile is accurate, we will mark all un-sampled &quot; &quot;callsite and function as having 0 samples. Otherwise, treat &quot; &quot;un-sampled callsites and functions conservatively as unknown. &quot;))</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_af61ae5b7d50b9b36cc3a2350ded45f82"><div class="ttname"><a href="SampleProfile_8cpp.html#af61ae5b7d50b9b36cc3a2350ded45f82">ProfileInlineReplayFormat</a></div><div class="ttdeci">static cl::opt&lt; CallSiteFormat::Format &gt; ProfileInlineReplayFormat(&quot;sample-profile-inline-replay-format&quot;, cl::init(CallSiteFormat::Format::LineColumnDiscriminator), cl::values(clEnumValN(CallSiteFormat::Format::Line, &quot;Line&quot;, &quot;&lt;Line Number&gt;&quot;), clEnumValN(CallSiteFormat::Format::LineColumn, &quot;LineColumn&quot;, &quot;&lt;Line Number&gt;:&lt;Column Number&gt;&quot;), clEnumValN(CallSiteFormat::Format::LineDiscriminator, &quot;LineDiscriminator&quot;, &quot;&lt;Line Number&gt;.&lt;Discriminator&gt;&quot;), clEnumValN(CallSiteFormat::Format::LineColumnDiscriminator, &quot;LineColumnDiscriminator&quot;, &quot;&lt;Line Number&gt;:&lt;Column Number&gt;.&lt;Discriminator&gt; (default)&quot;)), cl::desc(&quot;How sample profile inline replay file is formatted&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8cpp_html_af8d3791537a44c00b699d28c4d978d82"><div class="ttname"><a href="SampleProfile_8cpp.html#af8d3791537a44c00b699d28c4d978d82">SampleProfileRemappingFile</a></div><div class="ttdeci">static cl::opt&lt; std::string &gt; SampleProfileRemappingFile(&quot;sample-profile-remapping-file&quot;, cl::init(&quot;&quot;), cl::value_desc(&quot;filename&quot;), cl::desc(&quot;Profile remapping file loaded by -sample-profile&quot;), cl::Hidden)</div></div>
<div class="ttc" id="aSampleProfile_8h_html"><div class="ttname"><a href="SampleProfile_8h.html">SampleProfile.h</a></div><div class="ttdoc">This file provides the interface for the sampled PGO loader pass.</div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div><div class="ttdoc">This file defines the SmallPtrSet class.</div></div>
<div class="ttc" id="aSmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div><div class="ttdoc">This file defines the SmallSet class.</div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aStatistic_8h_html"><div class="ttname"><a href="Statistic_8h.html">Statistic.h</a></div><div class="ttdoc">This file defines the 'Statistic' class, which is designed to be an easy way to expose various metric...</div></div>
<div class="ttc" id="aStatistic_8h_html_ad6117415b93e5675d5a6c8e1855b3b2f"><div class="ttname"><a href="Statistic_8h.html#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a></div><div class="ttdeci">#define STATISTIC(VARNAME, DESC)</div><div class="ttdef"><b>Definition</b> <a href="Statistic_8h_source.html#l00167">Statistic.h:167</a></div></div>
<div class="ttc" id="aStringMap_8h_html"><div class="ttname"><a href="StringMap_8h.html">StringMap.h</a></div><div class="ttdoc">This file defines the StringMap class.</div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aTargetLibraryInfo_8h_html"><div class="ttname"><a href="TargetLibraryInfo_8h.html">TargetLibraryInfo.h</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div><div class="ttdoc">This pass exposes codegen information to IR-level passes.</div></div>
<div class="ttc" id="aTwine_8h_html"><div class="ttname"><a href="Twine_8h.html">Twine.h</a></div></div>
<div class="ttc" id="aValueSymbolTable_8h_html"><div class="ttname"><a href="ValueSymbolTable_8h.html">ValueSymbolTable.h</a></div></div>
<div class="ttc" id="aclassNode_html"><div class="ttname"><a href="classNode.html">Node</a></div><div class="ttdef"><b>Definition</b> <a href="ItaniumDemangle_8h_source.html#l00238">ItaniumDemangle.h:238</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00626">PassManager.h:626</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_aaab1fad63e4f3b8679469720a873fedd"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00780">PassManager.h:780</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae0adcccca08fb686c9ce00f9397b660c"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae0adcccca08fb686c9ce00f9397b660c">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionAnalysis_html"><div class="ttname"><a href="classllvm_1_1AssumptionAnalysis.html">llvm::AssumptionAnalysis</a></div><div class="ttdoc">A function analysis which provides an AssumptionCache.</div><div class="ttdef"><b>Definition</b> <a href="AssumptionCache_8h_source.html#l00173">AssumptionCache.h:173</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCacheTracker_html"><div class="ttname"><a href="classllvm_1_1AssumptionCacheTracker.html">llvm::AssumptionCacheTracker</a></div><div class="ttdoc">An immutable pass that tracks lazily created AssumptionCache objects.</div><div class="ttdef"><b>Definition</b> <a href="AssumptionCache_8h_source.html#l00202">AssumptionCache.h:202</a></div></div>
<div class="ttc" id="aclassllvm_1_1AssumptionCache_html"><div class="ttname"><a href="classllvm_1_1AssumptionCache.html">llvm::AssumptionCache</a></div><div class="ttdoc">A cache of @llvm.assume calls within a function.</div><div class="ttdef"><b>Definition</b> <a href="AssumptionCache_8h_source.html#l00042">AssumptionCache.h:42</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8h_source.html#l00058">BasicBlock.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a80069e261aca5e34cffcc2ef67cfa29b"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a80069e261aca5e34cffcc2ef67cfa29b">llvm::BasicBlock::getParent</a></div><div class="ttdeci">const Function * getParent() const</div><div class="ttdoc">Return the enclosing method, or null if none.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8h_source.html#l00107">BasicBlock.h:107</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01176">InstrTypes.h:1176</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a2b1ae7cf1bafdd43d1fee4c6ad0a2913"><div class="ttname"><a href="classllvm_1_1CallBase.html#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">llvm::CallBase::getCalledFunction</a></div><div class="ttdeci">Function * getCalledFunction() const</div><div class="ttdoc">Returns the function called, or null if this is an indirect function invocation or the function signa...</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01398">InstrTypes.h:1398</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphAnalysis_html"><div class="ttname"><a href="classllvm_1_1CallGraphAnalysis.html">llvm::CallGraphAnalysis</a></div><div class="ttdoc">An analysis pass to compute the CallGraph for a Module.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00305">CallGraph.h:305</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphNode_html"><div class="ttname"><a href="classllvm_1_1CallGraphNode.html">llvm::CallGraphNode</a></div><div class="ttdoc">A node in the call graph for a module.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00167">CallGraph.h:167</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraph_html"><div class="ttname"><a href="classllvm_1_1CallGraph.html">llvm::CallGraph</a></div><div class="ttdoc">The basic data container for the call graph of a Module of IR.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00073">CallGraph.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l01475">Instructions.h:1475</a></div></div>
<div class="ttc" id="aclassllvm_1_1ContextTrieNode_html"><div class="ttname"><a href="classllvm_1_1ContextTrieNode.html">llvm::ContextTrieNode</a></div><div class="ttdef"><b>Definition</b> <a href="SampleContextTracker_8h_source.html#l00036">SampleContextTracker.h:36</a></div></div>
<div class="ttc" id="aclassllvm_1_1DILocation_html"><div class="ttname"><a href="classllvm_1_1DILocation.html">llvm::DILocation</a></div><div class="ttdoc">Debug location.</div><div class="ttdef"><b>Definition</b> <a href="DebugInfoMetadata_8h_source.html#l01591">DebugInfoMetadata.h:1591</a></div></div>
<div class="ttc" id="aclassllvm_1_1DebugLoc_html"><div class="ttname"><a href="classllvm_1_1DebugLoc.html">llvm::DebugLoc</a></div><div class="ttdoc">A debug info location.</div><div class="ttdef"><b>Definition</b> <a href="DebugLoc_8h_source.html#l00033">DebugLoc.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a0b2ca98dc28c61793ff5c90d23e5f14e"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a0b2ca98dc28c61793ff5c90d23e5f14e">llvm::DenseMapBase::lookup</a></div><div class="ttdeci">ValueT lookup(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">lookup - Return the entry for the specified key, or a default constructed value if no such entry exis...</div><div class="ttdef"><b>Definition</b> <a href="DenseMap_8h_source.html#l00198">DenseMap.h:198</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_a53408c95a7bfb5443b43fb2134c3eb23"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#a53408c95a7bfb5443b43fb2134c3eb23">llvm::DenseMapBase::count</a></div><div class="ttdeci">size_type count(const_arg_type_t&lt; KeyT &gt; Val) const</div><div class="ttdoc">Return 1 if the specified key is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition</b> <a href="DenseMap_8h_source.html#l00146">DenseMap.h:146</a></div></div>
<div class="ttc" id="aclassllvm_1_1DenseMapBase_html_adb33f3ede2f5bfc9b3ee658aaf648492"><div class="ttname"><a href="classllvm_1_1DenseMapBase.html#adb33f3ede2f5bfc9b3ee658aaf648492">llvm::DenseMapBase::insert</a></div><div class="ttdeci">std::pair&lt; iterator, bool &gt; insert(const std::pair&lt; KeyT, ValueT &gt; &amp;KV)</div><div class="ttdef"><b>Definition</b> <a href="DenseMap_8h_source.html#l00208">DenseMap.h:208</a></div></div>
<div class="ttc" id="aclassllvm_1_1DiagnosticInfoSampleProfile_html"><div class="ttname"><a href="classllvm_1_1DiagnosticInfoSampleProfile.html">llvm::DiagnosticInfoSampleProfile</a></div><div class="ttdoc">Diagnostic information for the sample profiler.</div><div class="ttdef"><b>Definition</b> <a href="DiagnosticInfo_8h_source.html#l00290">DiagnosticInfo.h:290</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_1_1ProfileCount_html"><div class="ttname"><a href="classllvm_1_1Function_1_1ProfileCount.html">llvm::Function::ProfileCount</a></div><div class="ttdoc">Class to represent profile counts.</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00255">Function.h:255</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00062">Function.h:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a438d2f246b76817114ade2a005a6bcabac7dbc704eba08842e6acdde9cf6379ba"><div class="ttname"><a href="classllvm_1_1Function.html#a438d2f246b76817114ade2a005a6bcabac7dbc704eba08842e6acdde9cf6379ba">llvm::Function::PCT_Real</a></div><div class="ttdeci">@ PCT_Real</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00250">Function.h:250</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a739b30c811f1eece61b05320ddf44e5b"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00578">GlobalValue.h:578</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html"><div class="ttname"><a href="classllvm_1_1InlineCost.html">llvm::InlineCost</a></div><div class="ttdoc">Represents the cost of inlining a function.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00084">InlineCost.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_a127195706670de70081929e2262249fe"><div class="ttname"><a href="classllvm_1_1InlineCost.html#a127195706670de70081929e2262249fe">llvm::InlineCost::getAlways</a></div><div class="ttdeci">static InlineCost getAlways(const char *Reason, Optional&lt; CostBenefitPair &gt; CostBenefit=None)</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00114">InlineCost.h:114</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_ac7c62ec9e2cd5d974f662038b8c8951f"><div class="ttname"><a href="classllvm_1_1InlineCost.html#ac7c62ec9e2cd5d974f662038b8c8951f">llvm::InlineCost::get</a></div><div class="ttdeci">static InlineCost get(int Cost, int Threshold)</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00109">InlineCost.h:109</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineCost_html_ae8663496afd26f704bc84b50d54fb92c"><div class="ttname"><a href="classllvm_1_1InlineCost.html#ae8663496afd26f704bc84b50d54fb92c">llvm::InlineCost::getNever</a></div><div class="ttdeci">static InlineCost getNever(const char *Reason, Optional&lt; CostBenefitPair &gt; CostBenefit=None)</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00118">InlineCost.h:118</a></div></div>
<div class="ttc" id="aclassllvm_1_1InlineFunctionInfo_html"><div class="ttname"><a href="classllvm_1_1InlineFunctionInfo.html">llvm::InlineFunctionInfo</a></div><div class="ttdoc">This class captures the data input to the InlineFunction call, and records the auxiliary results prod...</div><div class="ttdef"><b>Definition</b> <a href="Cloning_8h_source.html#l00199">Cloning.h:199</a></div></div>
<div class="ttc" id="aclassllvm_1_1InnerAnalysisManagerProxy_html"><div class="ttname"><a href="classllvm_1_1InnerAnalysisManagerProxy.html">llvm::InnerAnalysisManagerProxy</a></div><div class="ttdoc">An analysis over an &quot;outer&quot; IR unit that provides access to an analysis manager over an &quot;inner&quot; IR un...</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00937">PassManager.h:939</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8h_source.html#l00043">Instruction.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a4b8faae4ff9e7434a1d226d03d15dcd2"><div class="ttname"><a href="classllvm_1_1Instruction.html#a4b8faae4ff9e7434a1d226d03d15dcd2">llvm::Instruction::getDebugLoc</a></div><div class="ttdeci">const DebugLoc &amp; getDebugLoc() const</div><div class="ttdoc">Return the debug location for this node as a DebugLoc.</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8h_source.html#l00368">Instruction.h:368</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a51d5735829e1f043630dd403f01d4219"><div class="ttname"><a href="classllvm_1_1Instruction.html#a51d5735829e1f043630dd403f01d4219">llvm::Instruction::extractProfTotalWeight</a></div><div class="ttdeci">bool extractProfTotalWeight(uint64_t &amp;TotalVal) const</div><div class="ttdoc">Retrieve total raw weight values of a branch.</div><div class="ttdef"><b>Definition</b> <a href="Metadata_8cpp_source.html#l01426">Metadata.cpp:1426</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a5e6364c710de3afb5449588baab260fd"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8h_source.html#l00092">Instruction.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a9247a212ea89acc9573fa7e7f557eaba"><div class="ttname"><a href="classllvm_1_1Instruction.html#a9247a212ea89acc9573fa7e7f557eaba">llvm::Instruction::setMetadata</a></div><div class="ttdeci">void setMetadata(unsigned KindID, MDNode *Node)</div><div class="ttdoc">Set the metadata of the specified kind to the specified node.</div><div class="ttdef"><b>Definition</b> <a href="Metadata_8cpp_source.html#l01332">Metadata.cpp:1332</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a944c50b4f5440b3914f5e2a157bb0fd3"><div class="ttname"><a href="classllvm_1_1Instruction.html#a944c50b4f5440b3914f5e2a157bb0fd3">llvm::Instruction::getSuccessor</a></div><div class="ttdeci">BasicBlock * getSuccessor(unsigned Idx) const</div><div class="ttdoc">Return the specified successor. This instruction must be a terminator.</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8cpp_source.html#l00786">Instruction.cpp:786</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ad449a11cc9b14b0ac93bd61bd0bd9293"><div class="ttname"><a href="classllvm_1_1Instruction.html#ad449a11cc9b14b0ac93bd61bd0bd9293">llvm::Instruction::getNumSuccessors</a></div><div class="ttdeci">unsigned getNumSuccessors() const</div><div class="ttdoc">Return the number of successors that this instruction has.</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8cpp_source.html#l00774">Instruction.cpp:774</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition</b> <a href="LLVMContext_8h_source.html#l00067">LLVMContext.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1MDBuilder_html"><div class="ttname"><a href="classllvm_1_1MDBuilder.html">llvm::MDBuilder</a></div><div class="ttdef"><b>Definition</b> <a href="MDBuilder_8h_source.html#l00035">MDBuilder.h:35</a></div></div>
<div class="ttc" id="aclassllvm_1_1ModulePass_html"><div class="ttname"><a href="classllvm_1_1ModulePass.html">llvm::ModulePass</a></div><div class="ttdoc">ModulePass class - This class is used to implement unstructured interprocedural optimizations and ana...</div><div class="ttdef"><b>Definition</b> <a href="Pass_8h_source.html#l00238">Pass.h:238</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition</b> <a href="Module_8h_source.html#l00065">Module.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkAnalysis.html">llvm::OptimizationRemarkAnalysis</a></div><div class="ttdoc">Diagnostic information for optimization analysis remarks.</div><div class="ttdef"><b>Definition</b> <a href="DiagnosticInfo_8h_source.html#l00780">DiagnosticInfo.h:780</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemarkEmitterAnalysis_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemarkEmitterAnalysis.html">llvm::OptimizationRemarkEmitterAnalysis</a></div><div class="ttdef"><b>Definition</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00164">OptimizationRemarkEmitter.h:165</a></div></div>
<div class="ttc" id="aclassllvm_1_1OptimizationRemark_html"><div class="ttname"><a href="classllvm_1_1OptimizationRemark.html">llvm::OptimizationRemark</a></div><div class="ttdoc">Diagnostic information for applied optimization remarks.</div><div class="ttdef"><b>Definition</b> <a href="DiagnosticInfo_8h_source.html#l00689">DiagnosticInfo.h:689</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition</b> <a href="PassRegistry_8cpp_source.html#l00031">PassRegistry.cpp:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00152">PassManager.h:152</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00155">PassManager.h:155</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00158">PassManager.h:158</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryAnalysis_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryAnalysis.html">llvm::ProfileSummaryAnalysis</a></div><div class="ttdoc">An analysis pass based on the new PM to deliver ProfileSummaryInfo.</div><div class="ttdef"><b>Definition</b> <a href="ProfileSummaryInfo_8h_source.html#l00211">ProfileSummaryInfo.h:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfoWrapperPass.html">llvm::ProfileSummaryInfoWrapperPass</a></div><div class="ttdoc">An analysis pass based on legacy pass manager to deliver ProfileSummaryInfo.</div><div class="ttdef"><b>Definition</b> <a href="ProfileSummaryInfo_8h_source.html#l00193">ProfileSummaryInfo.h:193</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummaryInfo_html"><div class="ttname"><a href="classllvm_1_1ProfileSummaryInfo.html">llvm::ProfileSummaryInfo</a></div><div class="ttdoc">Analysis providing profile information.</div><div class="ttdef"><b>Definition</b> <a href="ProfileSummaryInfo_8h_source.html#l00039">ProfileSummaryInfo.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummary_html_a59f76c736c482a9d03fbb0f5c42b3992"><div class="ttname"><a href="classllvm_1_1ProfileSummary.html#a59f76c736c482a9d03fbb0f5c42b3992">llvm::ProfileSummary::getMD</a></div><div class="ttdeci">Metadata * getMD(LLVMContext &amp;Context, bool AddPartialField=true, bool AddPartialProfileRatioField=true)</div><div class="ttdoc">Return summary information as metadata.</div><div class="ttdef"><b>Definition</b> <a href="ProfileSummary_8cpp_source.html#l00080">ProfileSummary.cpp:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1ProfileSummary_html_aa5aa682b3904e88749fa973b3da370c2a0c86eaeebf5b6120b601ecc93a1c2e3a"><div class="ttname"><a href="classllvm_1_1ProfileSummary.html#aa5aa682b3904e88749fa973b3da370c2a0c86eaeebf5b6120b601ecc93a1c2e3a">llvm::ProfileSummary::PSK_Sample</a></div><div class="ttdeci">@ PSK_Sample</div><div class="ttdef"><b>Definition</b> <a href="ProfileSummary_8h_source.html#l00047">ProfileSummary.h:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileLoaderBaseImpl_html"><div class="ttname"><a href="classllvm_1_1SampleProfileLoaderBaseImpl.html">llvm::SampleProfileLoaderBaseImpl</a></div><div class="ttdef"><b>Definition</b> <a href="SampleProfileLoaderBaseImpl_8h_source.html#l00080">SampleProfileLoaderBaseImpl.h:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1SampleProfileLoaderPass_html_a324d3696b255beea7cfd1e8b901b2363"><div class="ttname"><a href="classllvm_1_1SampleProfileLoaderPass.html#a324d3696b255beea7cfd1e8b901b2363">llvm::SampleProfileLoaderPass::run</a></div><div class="ttdeci">PreservedAnalyses run(Module &amp;M, ModuleAnalysisManager &amp;AM)</div><div class="ttdef"><b>Definition</b> <a href="#l02171">SampleProfile.cpp:2171</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringMap_html"><div class="ttname"><a href="classllvm_1_1StringMap.html">llvm::StringMap&lt; uint64_t &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringMap_html_a132b998e118193914fa4e2b694005b2c"><div class="ttname"><a href="classllvm_1_1StringMap.html#a132b998e118193914fa4e2b694005b2c">llvm::StringMap::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition</b> <a href="StringMap_8h_source.html#l00348">StringMap.h:348</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringMap_html_a9846bb2bc5672e7627011260772b8d09"><div class="ttname"><a href="classllvm_1_1StringMap.html#a9846bb2bc5672e7627011260772b8d09">llvm::StringMap::count</a></div><div class="ttdeci">size_type count(StringRef Key) const</div><div class="ttdoc">count - Return 1 if the element is in the map, 0 otherwise.</div><div class="ttdef"><b>Definition</b> <a href="StringMap_8h_source.html#l00246">StringMap.h:246</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition</b> <a href="StringRef_8h_source.html#l00058">StringRef.h:58</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringSet_html_add93efa62e06c599f1734f3b206232a0"><div class="ttname"><a href="classllvm_1_1StringSet.html#add93efa62e06c599f1734f3b206232a0">llvm::StringSet::insert</a></div><div class="ttdeci">std::pair&lt; typename Base::iterator, bool &gt; insert(StringRef key)</div><div class="ttdef"><b>Definition</b> <a href="StringSet_8h_source.html#l00034">StringSet.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetIRAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetIRAnalysis.html">llvm::TargetIRAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetTransformInfo.</div><div class="ttdef"><b>Definition</b> <a href="TargetTransformInfo_8h_source.html#l02420">TargetTransformInfo.h:2420</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryAnalysis_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryAnalysis.html">llvm::TargetLibraryAnalysis</a></div><div class="ttdoc">Analysis pass providing the TargetLibraryInfo.</div><div class="ttdef"><b>Definition</b> <a href="TargetLibraryInfo_8h_source.html#l00435">TargetLibraryInfo.h:435</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfoWrapperPass.html">llvm::TargetLibraryInfoWrapperPass</a></div><div class="ttdef"><b>Definition</b> <a href="TargetLibraryInfo_8h_source.html#l00460">TargetLibraryInfo.h:460</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetLibraryInfo_html"><div class="ttname"><a href="classllvm_1_1TargetLibraryInfo.html">llvm::TargetLibraryInfo</a></div><div class="ttdoc">Provides information about what library functions are available for the current target.</div><div class="ttdef"><b>Definition</b> <a href="TargetLibraryInfo_8h_source.html#l00221">TargetLibraryInfo.h:221</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfoWrapperPass_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfoWrapperPass.html">llvm::TargetTransformInfoWrapperPass</a></div><div class="ttdoc">Wrapper pass for TargetTransformInfo.</div><div class="ttdef"><b>Definition</b> <a href="TargetTransformInfo_8h_source.html#l02476">TargetTransformInfo.h:2476</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetTransformInfo_html"><div class="ttname"><a href="classllvm_1_1TargetTransformInfo.html">llvm::TargetTransformInfo</a></div><div class="ttdoc">This pass provides access to the codegen interfaces that are needed for IR-level transformations.</div><div class="ttdef"><b>Definition</b> <a href="TargetTransformInfo_8h_source.html#l00168">TargetTransformInfo.h:168</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition</b> <a href="Twine_8h_source.html#l00083">Twine.h:83</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00306">Value.cpp:306</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1Option_html_a2dc75fafb68e7669e776e19da7857cdf"><div class="ttname"><a href="classllvm_1_1cl_1_1Option.html#a2dc75fafb68e7669e776e19da7857cdf">llvm::cl::Option::getNumOccurrences</a></div><div class="ttdeci">int getNumOccurrences() const</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00402">CommandLine.h:402</a></div></div>
<div class="ttc" id="aclassllvm_1_1cl_1_1opt_html"><div class="ttname"><a href="classllvm_1_1cl_1_1opt.html">llvm::cl::opt</a></div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l01432">CommandLine.h:1434</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html">llvm::ilist_node_impl</a></div><div class="ttdoc">Implementation for an ilist node.</div><div class="ttdef"><b>Definition</b> <a href="ilist__node_8h_source.html#l00040">ilist_node.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html">llvm::sampleprof::FunctionSamples</a></div><div class="ttdoc">Representation of the samples collected for a function.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00691">SampleProf.h:691</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_a2b2898e95dd1947ace149447cb9ef137"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a2b2898e95dd1947ace149447cb9ef137">llvm::sampleprof::FunctionSamples::getGUID</a></div><div class="ttdeci">static uint64_t getGUID(StringRef Name)</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l01075">SampleProf.h:1075</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_a557fbb31fc3a0ed3e2a1cdbb7382d560"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a557fbb31fc3a0ed3e2a1cdbb7382d560">llvm::sampleprof::FunctionSamples::findInlinedFunctions</a></div><div class="ttdeci">void findInlinedFunctions(DenseSet&lt; GlobalValue::GUID &gt; &amp;S, const StringMap&lt; Function * &gt; &amp;SymbolMap, uint64_t Threshold) const</div><div class="ttdoc">Recursively traverses all children, if the total sample count of the corresponding function is no les...</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00916">SampleProf.h:916</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_a821a2271fa79d60de64ce7f2d923299e"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#a821a2271fa79d60de64ce7f2d923299e">llvm::sampleprof::FunctionSamples::ProfileIsCSFlat</a></div><div class="ttdeci">static bool ProfileIsCSFlat</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l01049">SampleProf.h:1049</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aa1b0659ee7d8e17ab407b3bd902e280c"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa1b0659ee7d8e17ab407b3bd902e280c">llvm::sampleprof::FunctionSamples::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00817">SampleProf.h:817</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aa37fe7429ffcf70c306c27a55d714d31"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa37fe7429ffcf70c306c27a55d714d31">llvm::sampleprof::FunctionSamples::ProfileIsProbeBased</a></div><div class="ttdeci">static bool ProfileIsProbeBased</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l01047">SampleProf.h:1047</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aa7122a07ea48e47fc71083e68b829003"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa7122a07ea48e47fc71083e68b829003">llvm::sampleprof::FunctionSamples::getCanonicalFnName</a></div><div class="ttdeci">static StringRef getCanonicalFnName(const Function &amp;F)</div><div class="ttdoc">Return the canonical name for a function, taking into account suffix elision policy attributes.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00957">SampleProf.h:957</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aa9a46c80625ff1813b321b3a1d46ee37"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aa9a46c80625ff1813b321b3a1d46ee37">llvm::sampleprof::FunctionSamples::getFuncName</a></div><div class="ttdeci">StringRef getFuncName() const</div><div class="ttdoc">Return the original function name.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00949">SampleProf.h:949</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aac9d9812a5a2e1902e92b485bbf6819b"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aac9d9812a5a2e1902e92b485bbf6819b">llvm::sampleprof::FunctionSamples::getEntrySamples</a></div><div class="ttdeci">uint64_t getEntrySamples() const</div><div class="ttdoc">Return the sample count of the first instruction of the function.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00831">SampleProf.h:831</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_ad117577730085f895045fc7ff90d8fc2"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#ad117577730085f895045fc7ff90d8fc2">llvm::sampleprof::FunctionSamples::getContext</a></div><div class="ttdeci">SampleContext &amp; getContext() const</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l01053">SampleProf.h:1053</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_aeea4c49a1040f9305f6a09d7d7815544"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#aeea4c49a1040f9305f6a09d7d7815544">llvm::sampleprof::FunctionSamples::getCallSiteIdentifier</a></div><div class="ttdeci">static LineLocation getCallSiteIdentifier(const DILocation *DIL, bool ProfileIsFS=false)</div><div class="ttdoc">Returns a unique call site identifier for a given debug location of a call instruction.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8cpp_source.html#l00228">SampleProf.cpp:228</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_afb88e30fa94efb7c7f12c84b52b61b3d"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#afb88e30fa94efb7c7f12c84b52b61b3d">llvm::sampleprof::FunctionSamples::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return the function name.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00946">SampleProf.h:946</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1FunctionSamples_html_afddaa81316d56f125de69793e0ddb33c"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1FunctionSamples.html#afddaa81316d56f125de69793e0ddb33c">llvm::sampleprof::FunctionSamples::UseMD5</a></div><div class="ttdeci">static bool UseMD5</div><div class="ttdoc">Whether the profile uses MD5 to represent string.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l01060">SampleProf.h:1060</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1ProfiledCallGraph_html"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1ProfiledCallGraph.html">llvm::sampleprof::ProfiledCallGraph</a></div><div class="ttdef"><b>Definition</b> <a href="ProfiledCallGraph_8h_source.html#l00065">ProfiledCallGraph.h:65</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleContext_html"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleContext.html">llvm::sampleprof::SampleContext</a></div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00472">SampleProf.h:472</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html">llvm::sampleprof::SampleProfileReader</a></div><div class="ttdoc">Sample-based profile reader.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00345">SampleProfReader.h:345</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a08811be4d55763d43b55278d760065d9"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a08811be4d55763d43b55278d760065d9">llvm::sampleprof::SampleProfileReader::profileIsCSFlat</a></div><div class="ttdeci">bool profileIsCSFlat() const</div><div class="ttdoc">Whether input profile is fully context-sensitive and flat.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00477">SampleProfReader.h:477</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a19892ef729b441b25d21f69ea15c9118"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a19892ef729b441b25d21f69ea15c9118">llvm::sampleprof::SampleProfileReader::getProfiles</a></div><div class="ttdeci">SampleProfileMap &amp; getProfiles()</div><div class="ttdoc">Return all the profiles.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00441">SampleProfReader.h:441</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a1f372a7784eaec8c761af0ed7c38b1b2"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a1f372a7784eaec8c761af0ed7c38b1b2">llvm::sampleprof::SampleProfileReader::profileIsProbeBased</a></div><div class="ttdeci">bool profileIsProbeBased() const</div><div class="ttdoc">Whether input profile is based on pseudo probes.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00474">SampleProfReader.h:474</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a231496cee212bad0c2b9fa7877dc0cb4"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a231496cee212bad0c2b9fa7877dc0cb4">llvm::sampleprof::SampleProfileReader::getSamplesFor</a></div><div class="ttdeci">FunctionSamples * getSamplesFor(const Function &amp;F)</div><div class="ttdoc">Return the samples collected for function F.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00398">SampleProfReader.h:398</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a3af68fe6182b0855269ef3578910df4c"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a3af68fe6182b0855269ef3578910df4c">llvm::sampleprof::SampleProfileReader::getOrCreateSamplesFor</a></div><div class="ttdeci">FunctionSamples * getOrCreateSamplesFor(const Function &amp;F)</div><div class="ttdoc">Return the samples collected for function F, create empty FunctionSamples if it doesn't exist.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00408">SampleProfReader.h:408</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a3bdbf84fa8e3f0e789653587d5c85515"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a3bdbf84fa8e3f0e789653587d5c85515">llvm::sampleprof::SampleProfileReader::read</a></div><div class="ttdeci">std::error_code read()</div><div class="ttdoc">The interface to read sample profiles from the associated file.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00373">SampleProfReader.h:373</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a530222c3b645acc9170003d046753e94"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a530222c3b645acc9170003d046753e94">llvm::sampleprof::SampleProfileReader::getRemapper</a></div><div class="ttdeci">SampleProfileReaderItaniumRemapper * getRemapper()</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00500">SampleProfReader.h:500</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a55f2425598ac25a3e028f96ac39a56ce"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a55f2425598ac25a3e028f96ac39a56ce">llvm::sampleprof::SampleProfileReader::setModule</a></div><div class="ttdeci">void setModule(const Module *Mod)</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00502">SampleProfReader.h:502</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a6dd2d2051faff77f927c11a25a851b81"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a6dd2d2051faff77f927c11a25a851b81">llvm::sampleprof::SampleProfileReader::getNameTable</a></div><div class="ttdeci">virtual std::vector&lt; StringRef &gt; * getNameTable()</div><div class="ttdoc">It includes all the names that have samples either in outline instance or inline instance.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00488">SampleProfReader.h:488</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a6f828f6cbdc46c9fc6dc254de51c354a"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a6f828f6cbdc46c9fc6dc254de51c354a">llvm::sampleprof::SampleProfileReader::create</a></div><div class="ttdeci">static ErrorOr&lt; std::unique_ptr&lt; SampleProfileReader &gt; &gt; create(const std::string Filename, LLVMContext &amp;C, FSDiscriminatorPass P=FSDiscriminatorPass::Base, const std::string RemapFilename=&quot;&quot;)</div><div class="ttdoc">Create a sample profile reader appropriate to the file format.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8cpp_source.html#l01787">SampleProfReader.cpp:1787</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a7870bf43f8e5b80b21caea5ea2e23977"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a7870bf43f8e5b80b21caea5ea2e23977">llvm::sampleprof::SampleProfileReader::getSummary</a></div><div class="ttdeci">ProfileSummary &amp; getSummary() const</div><div class="ttdoc">Return the profile summary.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00466">SampleProfReader.h:466</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_a7af14f4292ed5d6787b576e1ae9a0bcf"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#a7af14f4292ed5d6787b576e1ae9a0bcf">llvm::sampleprof::SampleProfileReader::profileIsCSNested</a></div><div class="ttdeci">bool profileIsCSNested() const</div><div class="ttdoc">Whether input profile is fully context-sensitive and nested.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00480">SampleProfReader.h:480</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_ac2c3cd528ebcb5fbe487fe9e0b3a9de6"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#ac2c3cd528ebcb5fbe487fe9e0b3a9de6">llvm::sampleprof::SampleProfileReader::setSkipFlatProf</a></div><div class="ttdeci">virtual void setSkipFlatProf(bool Skip)</div><div class="ttdoc">Don't read profile without context if the flag is set.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00496">SampleProfReader.h:496</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleProfileReader_html_af9976cd2d8ddf787f19d5dbca4530fa6"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleProfileReader.html#af9976cd2d8ddf787f19d5dbca4530fa6">llvm::sampleprof::SampleProfileReader::getProfileSymbolList</a></div><div class="ttdeci">virtual std::unique_ptr&lt; ProfileSymbolList &gt; getProfileSymbolList()</div><div class="ttdef"><b>Definition</b> <a href="SampleProfReader_8h_source.html#l00482">SampleProfReader.h:482</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleRecord_html_ab818a10bb93f9f5b08f1f85ed4733b3c"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleRecord.html#ab818a10bb93f9f5b08f1f85ed4733b3c">llvm::sampleprof::SampleRecord::SortCallTargets</a></div><div class="ttdeci">static const SortedCallTargetSet SortCallTargets(const CallTargetMap &amp;Targets)</div><div class="ttdoc">Sort call targets in descending order of call frequency.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00371">SampleProf.h:371</a></div></div>
<div class="ttc" id="aclassllvm_1_1sampleprof_1_1SampleRecord_html_abfed1f1dfd251457d62aa20c4c4e95eb"><div class="ttname"><a href="classllvm_1_1sampleprof_1_1SampleRecord.html#abfed1f1dfd251457d62aa20c4c4e95eb">llvm::sampleprof::SampleRecord::adjustCallTargets</a></div><div class="ttdeci">static const CallTargetMap adjustCallTargets(const CallTargetMap &amp;Targets, float DistributionFactor)</div><div class="ttdoc">Prorate call targets by a distribution factor.</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00380">SampleProf.h:380</a></div></div>
<div class="ttc" id="aclassuint32__t_html"><div class="ttname"><a href="classuint32__t.html">uint32_t</a></div></div>
<div class="ttc" id="aclassuint64__t_html"><div class="ttname"><a href="classuint64__t.html">uint64_t</a></div></div>
<div class="ttc" id="allvm_2Support_2ErrorHandling_8h_html"><div class="ttname"><a href="llvm_2Support_2ErrorHandling_8h.html">ErrorHandling.h</a></div></div>
<div class="ttc" id="allvm_2Transforms_2IPO_8h_html"><div class="ttname"><a href="llvm_2Transforms_2IPO_8h.html">IPO.h</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition</b> <a href="StackSlotColoring_8cpp_source.html#l00142">StackSlotColoring.cpp:142</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AttributeFuncs_html_ae05b3471aef6ffe376ceef99af9b4709"><div class="ttname"><a href="namespacellvm_1_1AttributeFuncs.html#ae05b3471aef6ffe376ceef99af9b4709">llvm::AttributeFuncs::mergeAttributesForInlining</a></div><div class="ttdeci">void mergeAttributesForInlining(Function &amp;Caller, const Function &amp;Callee)</div><div class="ttdoc">Merge caller's and callee's attributes.</div><div class="ttdef"><b>Definition</b> <a href="Attributes_8cpp_source.html#l01962">Attributes.cpp:1962</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_a80add6b3b1cdaec560907995127adc16"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">llvm::Intrinsic::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdef"><b>Definition</b> <a href="TargetTransformInfo_8h_source.html#l00038">TargetTransformInfo.h:38</a></div></div>
<div class="ttc" id="anamespacellvm_1_1RISCVFenceField_html_a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf"><div class="ttname"><a href="namespacellvm_1_1RISCVFenceField.html#a147be9e9780c1e33363ea572d4c7b25fa05c79fbfc58d9dd2851c467a1ef166bf">llvm::RISCVFenceField::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition</b> <a href="RISCVBaseInfo_8h_source.html#l00210">RISCVBaseInfo.h:209</a></div></div>
<div class="ttc" id="anamespacellvm_1_1X86AS_html_a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f"><div class="ttname"><a href="namespacellvm_1_1X86AS.html#a35ef1556078ae8d6f86e285e50a781d1a5b3a782ccae295a254e2794ad30ad07f">llvm::X86AS::FS</a></div><div class="ttdeci">@ FS</div><div class="ttdef"><b>Definition</b> <a href="X86_8h_source.html#l00188">X86.h:188</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9"><div class="ttname"><a href="namespacellvm_1_1cl.html#a492234b10e0c5918d72a3a15a6f0fa6ea61d3cb794533763159788c493ad266d9">llvm::cl::ZeroOrMore</a></div><div class="ttdeci">@ ZeroOrMore</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00120">CommandLine.h:120</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6"><div class="ttname"><a href="namespacellvm_1_1cl.html#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">llvm::cl::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00143">CommandLine.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_a8fa743aa76b6902028f8a643dfb87171"><div class="ttname"><a href="namespacellvm_1_1cl.html#a8fa743aa76b6902028f8a643dfb87171">llvm::cl::values</a></div><div class="ttdeci">ValuesClass values(OptsTy... Options)</div><div class="ttdoc">Helper to build a ValuesClass by forwarding a variable number of arguments as an initializer list to ...</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00697">CommandLine.h:697</a></div></div>
<div class="ttc" id="anamespacellvm_1_1cl_html_ac12e6a8f3a1b511f0dee2ed6de0ae806"><div class="ttname"><a href="namespacellvm_1_1cl.html#ac12e6a8f3a1b511f0dee2ed6de0ae806">llvm::cl::init</a></div><div class="ttdeci">initializer&lt; Ty &gt; init(const Ty &amp;Val)</div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00441">CommandLine.h:441</a></div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b"><div class="ttname"><a href="namespacellvm_1_1codeview.html#a2e1cbb0e2bd7a35ed99c31853dc45374a3fd6b696867d70225deda7868308679b">llvm::codeview::CompileSym2Flags::EC</a></div><div class="ttdeci">@ EC</div></div>
<div class="ttc" id="anamespacellvm_1_1codeview_html_ad25a1310d512e19d2f6318e963dcb30bafc6d010fc5b3d8ff4400670e597c4e7b"><div class="ttname"><a href="namespacellvm_1_1codeview.html#ad25a1310d512e19d2f6318e963dcb30bafc6d010fc5b3d8ff4400670e597c4e7b">llvm::codeview::FrameProcedureOptions::Inlined</a></div><div class="ttdeci">@ Inlined</div></div>
<div class="ttc" id="anamespacellvm_1_1ifs_html_adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df"><div class="ttname"><a href="namespacellvm_1_1ifs.html#adfe04e1a9cc096fb571e8372debaa67ea00d0b4f2d7dcdaaef835b97cf5d1e0df">llvm::ifs::IFSSymbolType::Func</a></div><div class="ttdeci">@ Func</div></div>
<div class="ttc" id="anamespacellvm_1_1msgpack_html_afdae9da66bac09f4b2bfc0fd9f0559e6a46f3ea056caa3126b91f3f70beea068c"><div class="ttname"><a href="namespacellvm_1_1msgpack.html#afdae9da66bac09f4b2bfc0fd9f0559e6a46f3ea056caa3126b91f3f70beea068c">llvm::msgpack::Type::Map</a></div><div class="ttdeci">@ Map</div></div>
<div class="ttc" id="anamespacellvm_1_1orc_html_a6a31d56a05a94b79b1c5eb0b85ae0283"><div class="ttname"><a href="namespacellvm_1_1orc.html#a6a31d56a05a94b79b1c5eb0b85ae0283">llvm::orc::SymbolMap</a></div><div class="ttdeci">DenseMap&lt; SymbolStringPtr, JITEvaluatedSymbol &gt; SymbolMap</div><div class="ttdoc">A map from symbol names (as SymbolStringPtrs) to JITSymbols (address/flags pairs).</div><div class="ttdef"><b>Definition</b> <a href="llvm_2ExecutionEngine_2Orc_2Core_8h_source.html#l00113">Core.h:113</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ore_html_a5ca06dfbc998afac005414d8e9b7c234"><div class="ttname"><a href="namespacellvm_1_1ore.html#a5ca06dfbc998afac005414d8e9b7c234">llvm::ore::NV</a></div><div class="ttdeci">DiagnosticInfoOptimizationBase::Argument NV</div><div class="ttdef"><b>Definition</b> <a href="OptimizationRemarkEmitter_8h_source.html#l00136">OptimizationRemarkEmitter.h:136</a></div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30ba14e7dd71a82eb3c2500ac2687efef82b">llvm::pdb::PDB_SymType::Caller</a></div><div class="ttdeci">@ Caller</div></div>
<div class="ttc" id="anamespacellvm_1_1pdb_html_a33e853ec74d48b1340d1d4bae772d30bad7a2c9c146ac9c6636e1a009ca1e9413"><div class="ttname"><a href="namespacellvm_1_1pdb.html#a33e853ec74d48b1340d1d4bae772d30bad7a2c9c146ac9c6636e1a009ca1e9413">llvm::pdb::PDB_SymType::CallSite</a></div><div class="ttdeci">@ CallSite</div></div>
<div class="ttc" id="anamespacellvm_1_1pgo_html_ac3ab1f99a5d99ba23fcfec6044ebc805"><div class="ttname"><a href="namespacellvm_1_1pgo.html#ac3ab1f99a5d99ba23fcfec6044ebc805">llvm::pgo::promoteIndirectCall</a></div><div class="ttdeci">CallBase &amp; promoteIndirectCall(CallBase &amp;CB, Function *F, uint64_t Count, uint64_t TotalCount, bool AttachProfToDirectCall, OptimizationRemarkEmitter *ORE)</div><div class="ttdef"><b>Definition</b> <a href="IndirectCallPromotion_8cpp_source.html#l00304">IndirectCallPromotion.cpp:304</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a659a52f7008b83957eb326a57a737cf9"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a659a52f7008b83957eb326a57a737cf9">llvm::sampleprof::FunctionSamplesMap</a></div><div class="ttdeci">std::map&lt; std::string, FunctionSamples, std::less&lt;&gt; &gt; FunctionSamplesMap</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00683">SampleProf.h:683</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a6cff5a57b476680e6b28e4dbfd2da8acab2e6b6d8b22672f40e617c7dfedd302a"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a6cff5a57b476680e6b28e4dbfd2da8acab2e6b6d8b22672f40e617c7dfedd302a">llvm::sampleprof::SyntheticContext</a></div><div class="ttdeci">@ SyntheticContext</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00406">SampleProf.h:406</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprof_html_a9c9cec0dc85381494fb418ae0e88a40fa9a35039dfc5e52a8ee9289957a726bee"><div class="ttname"><a href="namespacellvm_1_1sampleprof.html#a9c9cec0dc85381494fb418ae0e88a40fa9a35039dfc5e52a8ee9289957a726bee">llvm::sampleprof::ContextShouldBeInlined</a></div><div class="ttdeci">@ ContextShouldBeInlined</div><div class="ttdef"><b>Definition</b> <a href="SampleProf_8h_source.html#l00415">SampleProf.h:415</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprofutil_html"><div class="ttname"><a href="namespacellvm_1_1sampleprofutil.html">llvm::sampleprofutil</a></div><div class="ttdef"><b>Definition</b> <a href="SampleProfileLoaderBaseUtil_8h_source.html#l00039">SampleProfileLoaderBaseUtil.h:39</a></div></div>
<div class="ttc" id="anamespacellvm_1_1sampleprofutil_html_ab6789a9522443425d339fa34c25f89d5"><div class="ttname"><a href="namespacellvm_1_1sampleprofutil.html#ab6789a9522443425d339fa34c25f89d5">llvm::sampleprofutil::callsiteIsHot</a></div><div class="ttdeci">bool callsiteIsHot(const FunctionSamples *CallsiteFS, ProfileSummaryInfo *PSI, bool ProfAccForSymsInList)</div><div class="ttdoc">Return true if the given callsite is hot wrt to hot cutoff threshold.</div><div class="ttdef"><b>Definition</b> <a href="SampleProfileLoaderBaseUtil_8cpp_source.html#l00060">SampleProfileLoaderBaseUtil.cpp:60</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">/file This file defines the SmallVector class.</div><div class="ttdef"><b>Definition</b> <a href="AllocatorList_8h_source.html#l00022">AllocatorList.h:22</a></div></div>
<div class="ttc" id="anamespacellvm_html_a00fba4013f1a5b882b91cad397791f9f"><div class="ttname"><a href="namespacellvm.html#a00fba4013f1a5b882b91cad397791f9f">llvm::extractProbe</a></div><div class="ttdeci">Optional&lt; PseudoProbe &gt; extractProbe(const Instruction &amp;Inst)</div><div class="ttdef"><b>Definition</b> <a href="PseudoProbe_8cpp_source.html#l00048">PseudoProbe.cpp:48</a></div></div>
<div class="ttc" id="anamespacellvm_html_a03503773241005f01b090b9862aad304"><div class="ttname"><a href="namespacellvm.html#a03503773241005f01b090b9862aad304">llvm::dump</a></div><div class="ttdeci">void dump(const SparseBitVector&lt; ElementSize &gt; &amp;LHS, raw_ostream &amp;out)</div><div class="ttdef"><b>Definition</b> <a href="SparseBitVector_8h_source.html#l00877">SparseBitVector.h:877</a></div></div>
<div class="ttc" id="anamespacellvm_html_a070cea0b95536a427b3ebbcedba2a630"><div class="ttname"><a href="namespacellvm.html#a070cea0b95536a427b3ebbcedba2a630">llvm::isIndirectCall</a></div><div class="ttdeci">static bool isIndirectCall(const MachineInstr &amp;MI)</div><div class="ttdef"><b>Definition</b> <a href="ARMBaseInstrInfo_8h_source.html#l00650">ARMBaseInstrInfo.h:650</a></div></div>
<div class="ttc" id="anamespacellvm_html_a08a01d88ce50410b70088afeabd8c662"><div class="ttname"><a href="namespacellvm.html#a08a01d88ce50410b70088afeabd8c662">llvm::getValueProfDataFromInst</a></div><div class="ttdeci">bool getValueProfDataFromInst(const Instruction &amp;Inst, InstrProfValueKind ValueKind, uint32_t MaxNumValueData, InstrProfValueData ValueData[], uint32_t &amp;ActualNumValueData, uint64_t &amp;TotalC, bool GetNoICPValue=false)</div><div class="ttdoc">Extract the value profile data from Inst which is annotated with value profile meta data.</div><div class="ttdef"><b>Definition</b> <a href="InstrProf_8cpp_source.html#l01042">InstrProf.cpp:1042</a></div></div>
<div class="ttc" id="anamespacellvm_html_a0e5b9e42ea84622605acea0b0d721fda"><div class="ttname"><a href="namespacellvm.html#a0e5b9e42ea84622605acea0b0d721fda">llvm::isLegalToPromote</a></div><div class="ttdeci">bool isLegalToPromote(const CallBase &amp;CB, Function *Callee, const char **FailureReason=nullptr)</div><div class="ttdoc">Return true if the given indirect call site can be made to call Callee.</div><div class="ttdef"><b>Definition</b> <a href="CallPromotionUtils_8cpp_source.html#l00382">CallPromotionUtils.cpp:382</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2f18b256797f90ed7933e51e26fa6505"><div class="ttname"><a href="namespacellvm.html#a2f18b256797f90ed7933e51e26fa6505">llvm::createSampleProfileLoaderPass</a></div><div class="ttdeci">ModulePass * createSampleProfileLoaderPass()</div><div class="ttdef"><b>Definition</b> <a href="#l02025">SampleProfile.cpp:2025</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3c1a67796e24a843db8a6766baa54c21"><div class="ttname"><a href="namespacellvm.html#a3c1a67796e24a843db8a6766baa54c21">llvm::scc_begin</a></div><div class="ttdeci">scc_iterator&lt; T &gt; scc_begin(const T &amp;G)</div><div class="ttdoc">Construct the begin iterator for a deduced graph type T.</div><div class="ttdef"><b>Definition</b> <a href="SCCIterator_8h_source.html#l00232">SCCIterator.h:232</a></div></div>
<div class="ttc" id="anamespacellvm_html_a469101ea87b8b432a1b4f7935c97f35c"><div class="ttname"><a href="namespacellvm.html#a469101ea87b8b432a1b4f7935c97f35c">llvm::reverse</a></div><div class="ttdeci">auto reverse(ContainerTy &amp;&amp;C, std::enable_if_t&lt; has_rbegin&lt; ContainerTy &gt;::value &gt; *=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="STLExtras_8h_source.html#l00359">STLExtras.h:359</a></div></div>
<div class="ttc" id="anamespacellvm_html_a4fb32c986b105bb7a53700e5988aab6e"><div class="ttname"><a href="namespacellvm.html#a4fb32c986b105bb7a53700e5988aab6e">llvm::setProbeDistributionFactor</a></div><div class="ttdeci">void setProbeDistributionFactor(Instruction &amp;Inst, float Factor)</div><div class="ttdef"><b>Definition</b> <a href="PseudoProbe_8cpp_source.html#l00065">PseudoProbe.cpp:65</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5d737fb4258bb27586a1bffd557fbb49"><div class="ttname"><a href="namespacellvm.html#a5d737fb4258bb27586a1bffd557fbb49">llvm::ThinOrFullLTOPhase</a></div><div class="ttdeci">ThinOrFullLTOPhase</div><div class="ttdoc">This enumerates the LLVM full LTO or ThinLTO optimization phases.</div><div class="ttdef"><b>Definition</b> <a href="Pass_8h_source.html#l00073">Pass.h:73</a></div></div>
<div class="ttc" id="anamespacellvm_html_a5f5f248d08aa55c63e5bc7a8304a7319"><div class="ttname"><a href="namespacellvm.html#a5f5f248d08aa55c63e5bc7a8304a7319">llvm::getInlineCost</a></div><div class="ttdeci">InlineCost getInlineCost(CallBase &amp;Call, const InlineParams &amp;Params, TargetTransformInfo &amp;CalleeTTI, function_ref&lt; AssumptionCache &amp;(Function &amp;)&gt; GetAssumptionCache, function_ref&lt; const TargetLibraryInfo &amp;(Function &amp;)&gt; GetTLI, function_ref&lt; BlockFrequencyInfo &amp;(Function &amp;)&gt; GetBFI=nullptr, ProfileSummaryInfo *PSI=nullptr, OptimizationRemarkEmitter *ORE=nullptr)</div><div class="ttdoc">Get an InlineCost object representing the cost of inlining this callsite.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8cpp_source.html#l02796">InlineCost.cpp:2796</a></div></div>
<div class="ttc" id="anamespacellvm_html_a68ee9c22fcc77e40d4ae44e5b37c7998"><div class="ttname"><a href="namespacellvm.html#a68ee9c22fcc77e40d4ae44e5b37c7998">llvm::annotateValueSite</a></div><div class="ttdeci">void annotateValueSite(Module &amp;M, Instruction &amp;Inst, const InstrProfRecord &amp;InstrProfR, InstrProfValueKind ValueKind, uint32_t SiteIndx, uint32_t MaxMDCount=3)</div><div class="ttdoc">Get the value profile data for value site SiteIdx from InstrProfR and annotate the instruction Inst w...</div><div class="ttdef"><b>Definition</b> <a href="InstrProf_8cpp_source.html#l00997">InstrProf.cpp:997</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition</b> <a href="Debug_8cpp_source.html#l00163">Debug.cpp:163</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7e39b6f753eab4236840973d7f6ddbfe"><div class="ttname"><a href="namespacellvm.html#a7e39b6f753eab4236840973d7f6ddbfe">llvm::InlineFunction</a></div><div class="ttdeci">InlineResult InlineFunction(CallBase &amp;CB, InlineFunctionInfo &amp;IFI, AAResults *CalleeAAR=nullptr, bool InsertLifetime=true, Function *ForwardVarArgsTo=nullptr)</div><div class="ttdoc">This function inlines the called function into the basic block of the caller.</div><div class="ttdef"><b>Definition</b> <a href="InlineFunction_8cpp_source.html#l01749">InlineFunction.cpp:1749</a></div></div>
<div class="ttc" id="anamespacellvm_html_a830041552b81a6cea1f497490d0f41d9"><div class="ttname"><a href="namespacellvm.html#a830041552b81a6cea1f497490d0f41d9">llvm::sort</a></div><div class="ttdeci">void sort(IteratorTy Start, IteratorTy End)</div><div class="ttdef"><b>Definition</b> <a href="STLExtras_8h_source.html#l01529">STLExtras.h:1529</a></div></div>
<div class="ttc" id="anamespacellvm_html_a83035d5c2bb6a64f3c35b716a994b586"><div class="ttname"><a href="namespacellvm.html#a83035d5c2bb6a64f3c35b716a994b586">llvm::emitInlinedIntoBasedOnCost</a></div><div class="ttdeci">void emitInlinedIntoBasedOnCost(OptimizationRemarkEmitter &amp;ORE, DebugLoc DLoc, const BasicBlock *Block, const Function &amp;Callee, const Function &amp;Caller, const InlineCost &amp;IC, bool ForProfileContext=false, const char *PassName=nullptr)</div><div class="ttdoc">Emit ORE message based in cost (default heuristic).</div><div class="ttdef"><b>Definition</b> <a href="InlineAdvisor_8cpp_source.html#l00488">InlineAdvisor.cpp:488</a></div></div>
<div class="ttc" id="anamespacellvm_html_a854ac9cfc31bb306b1495a508707dc26"><div class="ttname"><a href="namespacellvm.html#a854ac9cfc31bb306b1495a508707dc26">llvm::ProfileCount</a></div><div class="ttdeci">Function::ProfileCount ProfileCount</div><div class="ttdef"><b>Definition</b> <a href="SampleProfileLoaderBaseImpl_8h_source.html#l00047">SampleProfileLoaderBaseImpl.h:47</a></div></div>
<div class="ttc" id="anamespacellvm_html_a939bc2108d47080767f0c06ba56caec7"><div class="ttname"><a href="namespacellvm.html#a939bc2108d47080767f0c06ba56caec7">llvm::format</a></div><div class="ttdeci">format_object&lt; Ts... &gt; format(const char *Fmt, const Ts &amp;... Vals)</div><div class="ttdoc">These are helper functions used to produce formatted output.</div><div class="ttdef"><b>Definition</b> <a href="Format_8h_source.html#l00124">Format.h:124</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a7b5c68c90f85baaedaa854cc5002cc"><div class="ttname"><a href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">llvm::errs</a></div><div class="ttdeci">raw_fd_ostream &amp; errs()</div><div class="ttdoc">This returns a reference to a raw_ostream for standard error.</div><div class="ttdef"><b>Definition</b> <a href="raw__ostream_8cpp_source.html#l00893">raw_ostream.cpp:893</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa2e1a9c1b1be6e7e53d3ec19b2de473b"><div class="ttname"><a href="namespacellvm.html#aa2e1a9c1b1be6e7e53d3ec19b2de473b">llvm::SampleProfileUseProfi</a></div><div class="ttdeci">cl::opt&lt; bool &gt; SampleProfileUseProfi</div></div>
<div class="ttc" id="anamespacellvm_html_aa7cd2cc36098475563ad0fd3371df2a6"><div class="ttname"><a href="namespacellvm.html#aa7cd2cc36098475563ad0fd3371df2a6">llvm::updateProfileCallee</a></div><div class="ttdeci">void updateProfileCallee(Function *Callee, int64_t EntryDelta, const ValueMap&lt; const Value *, WeakTrackingVH &gt; *VMap=nullptr)</div><div class="ttdoc">Updates profile information by adjusting the entry count by adding EntryDelta then scaling callsite i...</div><div class="ttdef"><b>Definition</b> <a href="InlineFunction_8cpp_source.html#l01608">InlineFunction.cpp:1608</a></div></div>
<div class="ttc" id="anamespacellvm_html_aba7063dea024346c7b70099c63703f50"><div class="ttname"><a href="namespacellvm.html#aba7063dea024346c7b70099c63703f50">llvm::getInlineParams</a></div><div class="ttdeci">InlineParams getInlineParams()</div><div class="ttdoc">Generate the parameters to tune the inline cost analysis based only on the commandline options.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8cpp_source.html#l03071">InlineCost.cpp:3071</a></div></div>
<div class="ttc" id="anamespacellvm_html_abfc9c7ecf70f66901e439f7c04ef3dbb"><div class="ttname"><a href="namespacellvm.html#abfc9c7ecf70f66901e439f7c04ef3dbb">llvm::move</a></div><div class="ttdeci">OutputIt move(R &amp;&amp;Range, OutputIt Out)</div><div class="ttdoc">Provide wrappers to std::move which take ranges instead of having to pass begin/end explicitly.</div><div class="ttdef"><b>Definition</b> <a href="STLExtras_8h_source.html#l01642">STLExtras.h:1642</a></div></div>
<div class="ttc" id="anamespacellvm_html_abfcab32516704f11d146c757f402ad5ca1cde8c8828756cdaf2a93260e247ae31"><div class="ttname"><a href="namespacellvm.html#abfcab32516704f11d146c757f402ad5ca1cde8c8828756cdaf2a93260e247ae31">llvm::DS_Warning</a></div><div class="ttdeci">@ DS_Warning</div><div class="ttdef"><b>Definition</b> <a href="DiagnosticInfo_8h_source.html#l00051">DiagnosticInfo.h:51</a></div></div>
<div class="ttc" id="anamespacellvm_html_ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6"><div class="ttname"><a href="namespacellvm.html#ac226f3d2b9ca090171a8e0a8cb92c343a91921ada405fd6ba65dff028df047cb6">llvm::HighlightColor::Remark</a></div><div class="ttdeci">@ Remark</div></div>
<div class="ttc" id="anamespacellvm_html_ad579b1aaccc266c26012224c61ce29da"><div class="ttname"><a href="namespacellvm.html#ad579b1aaccc266c26012224c61ce29da">llvm::initializeSampleProfileLoaderLegacyPassPass</a></div><div class="ttdeci">void initializeSampleProfileLoaderLegacyPassPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="anamespacellvm_html_ad8b4a8280867e4435043b760a879124d"><div class="ttname"><a href="namespacellvm.html#ad8b4a8280867e4435043b760a879124d">llvm::getReplayInlineAdvisor</a></div><div class="ttdeci">std::unique_ptr&lt; InlineAdvisor &gt; getReplayInlineAdvisor(Module &amp;M, FunctionAnalysisManager &amp;FAM, LLVMContext &amp;Context, std::unique_ptr&lt; InlineAdvisor &gt; OriginalAdvisor, const ReplayInlinerSettings &amp;ReplaySettings, bool EmitRemarks)</div><div class="ttdef"><b>Definition</b> <a href="ReplayInlineAdvisor_8cpp_source.html#l00078">ReplayInlineAdvisor.cpp:78</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d"><div class="ttname"><a href="namespacellvm.html#ae551fe3e2b167b36005b26473e993884a26aa2e7865f749b52f3b77991776c40d">llvm::Data</a></div><div class="ttdeci">@ Data</div><div class="ttdef"><b>Definition</b> <a href="SIMachineScheduler_8h_source.html#l00056">SIMachineScheduler.h:55</a></div></div>
<div class="ttc" id="anamespacellvm_html_aee20e86d3817849199a21d19bcc273c5"><div class="ttname"><a href="namespacellvm.html#aee20e86d3817849199a21d19bcc273c5">llvm::NOMORE_ICP_MAGICNUM</a></div><div class="ttdeci">const uint64_t NOMORE_ICP_MAGICNUM</div><div class="ttdoc">Magic number in the value profile metadata showing a target has been promoted for the instruction and...</div><div class="ttdef"><b>Definition</b> <a href="Metadata_8h_source.html#l00057">Metadata.h:57</a></div></div>
<div class="ttc" id="anamespacellvm_html_af02a478b5fdda18781d7c7edd5709ed7"><div class="ttname"><a href="namespacellvm.html#af02a478b5fdda18781d7c7edd5709ed7">llvm::UseIterativeBFIInference</a></div><div class="ttdeci">llvm::cl::opt&lt; bool &gt; UseIterativeBFIInference</div></div>
<div class="ttc" id="anamespacellvm_html_afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7"><div class="ttname"><a href="namespacellvm.html#afe5a7327058c6702e128c22292fb66c6a9d3d9048db16a7eee539e93e3618cbe7">llvm::InstrProfKind::BB</a></div><div class="ttdeci">@ BB</div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="BitVector_8h_source.html#l00851">BitVector.h:851</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="astructllvm_1_1DiagnosticInfoOptimizationBase_1_1Argument_html"><div class="ttname"><a href="structllvm_1_1DiagnosticInfoOptimizationBase_1_1Argument.html">llvm::DiagnosticInfoOptimizationBase::Argument</a></div><div class="ttdoc">Used in the streaming interface as the general argument type.</div><div class="ttdef"><b>Definition</b> <a href="DiagnosticInfo_8h_source.html#l00426">DiagnosticInfo.h:426</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html"><div class="ttname"><a href="structllvm_1_1InlineParams.html">llvm::InlineParams</a></div><div class="ttdoc">Thresholds to tune inline cost analysis.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00187">InlineCost.h:187</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_a7cde54d76b55a38309b65c712f1525c3"><div class="ttname"><a href="structllvm_1_1InlineParams.html#a7cde54d76b55a38309b65c712f1525c3">llvm::InlineParams::AllowRecursiveCall</a></div><div class="ttdeci">Optional&lt; bool &gt; AllowRecursiveCall</div><div class="ttdoc">Indicate whether we allow inlining for recursive call.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00220">InlineCost.h:220</a></div></div>
<div class="ttc" id="astructllvm_1_1InlineParams_html_afbfdb6bed9436fc13b4df5ac67f8b9f7"><div class="ttname"><a href="structllvm_1_1InlineParams.html#afbfdb6bed9436fc13b4df5ac67f8b9f7">llvm::InlineParams::ComputeFullInlineCost</a></div><div class="ttdeci">Optional&lt; bool &gt; ComputeFullInlineCost</div><div class="ttdoc">Compute inline cost even when the cost has exceeded the threshold.</div><div class="ttdef"><b>Definition</b> <a href="InlineCost_8h_source.html#l00214">InlineCost.h:214</a></div></div>
<div class="ttc" id="astructllvm_1_1ReplayInlinerSettings_html"><div class="ttname"><a href="structllvm_1_1ReplayInlinerSettings.html">llvm::ReplayInlinerSettings</a></div><div class="ttdoc">Replay Inliner Setup.</div><div class="ttdef"><b>Definition</b> <a href="ReplayInlineAdvisor_8h_source.html#l00043">ReplayInlineAdvisor.h:43</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1desc.html">llvm::cl::desc</a></div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00412">CommandLine.h:412</a></div></div>
<div class="ttc" id="astructllvm_1_1cl_1_1value__desc_html"><div class="ttname"><a href="structllvm_1_1cl_1_1value__desc.html">llvm::cl::value_desc</a></div><div class="ttdef"><b>Definition</b> <a href="CommandLine_8h_source.html#l00422">CommandLine.h:422</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 20 2024 18:30:39 for LLVM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
