<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Transforms/Coroutines/CoroSplit.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLVM<span id="projectnumber">&#160;11.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a72932e0778af28115095468f6286ff8.html">Transforms</a></li><li class="navelem"><a class="el" href="dir_41b0844b37bf482660c9a400b410eb70.html">Coroutines</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">CoroSplit.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="CoroSplit_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//===- CoroSplit.cpp - Converts a coroutine into a state machine ----------===//</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// This pass builds the coroutine frame and outlines resume and destroy parts</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// of the coroutine into separate functions.</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">//</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// We present a coroutine to an LLVM as an ordinary function with suspension</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">// points marked up with intrinsics. We let the optimizer party on the coroutine</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// as a single function for as long as possible. Shortly before the coroutine is</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">// eligible to be inlined into its callers, we split up the coroutine into parts</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">// corresponding to an initial, resume and destroy invocations of the coroutine,</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">// add them to the current SCC and restart the IPO pipeline to optimize the</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">// coroutine subfunctions we extracted before proceeding to the caller of the</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">// coroutine.</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="CoroSplit_8h.html">llvm/Transforms/Coroutines/CoroSplit.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="CoroInstr_8h.html">CoroInstr.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="CoroInternal_8h.html">CoroInternal.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="DenseMap_8h.html">llvm/ADT/DenseMap.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="SmallPtrSet_8h.html">llvm/ADT/SmallPtrSet.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="SmallVector_8h.html">llvm/ADT/SmallVector.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="StringRef_8h.html">llvm/ADT/StringRef.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="Twine_8h.html">llvm/ADT/Twine.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="CallGraph_8h.html">llvm/Analysis/CallGraph.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="CallGraphSCCPass_8h.html">llvm/Analysis/CallGraphSCCPass.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="Argument_8h.html">llvm/IR/Argument.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="Attributes_8h.html">llvm/IR/Attributes.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="BasicBlock_8h.html">llvm/IR/BasicBlock.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="IR_2CFG_8h.html">llvm/IR/CFG.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="CallingConv_8h.html">llvm/IR/CallingConv.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="Constants_8h.html">llvm/IR/Constants.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="DerivedTypes_8h.html">llvm/IR/DerivedTypes.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="GlobalValue_8h.html">llvm/IR/GlobalValue.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="GlobalVariable_8h.html">llvm/IR/GlobalVariable.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="InstIterator_8h.html">llvm/IR/InstIterator.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;<a class="code" href="InstrTypes_8h.html">llvm/IR/InstrTypes.h</a>&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="IR_2Instruction_8h.html">llvm/IR/Instruction.h</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &quot;<a class="code" href="LLVMContext_8h.html">llvm/IR/LLVMContext.h</a>&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;<a class="code" href="LegacyPassManager_8h.html">llvm/IR/LegacyPassManager.h</a>&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="Module_8h.html">llvm/IR/Module.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="Type_8h.html">llvm/IR/Type.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="Value_8h.html">llvm/IR/Value.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;<a class="code" href="Verifier_8h.html">llvm/IR/Verifier.h</a>&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="Casting_8h.html">llvm/Support/Casting.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &quot;<a class="code" href="Debug_8h.html">llvm/Support/Debug.h</a>&quot;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &quot;<a class="code" href="PrettyStackTrace_8h.html">llvm/Support/PrettyStackTrace.h</a>&quot;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &quot;<a class="code" href="raw__ostream_8h.html">llvm/Support/raw_ostream.h</a>&quot;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#include &quot;<a class="code" href="llvm_2Transforms_2Scalar_8h.html">llvm/Transforms/Scalar.h</a>&quot;</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#include &quot;<a class="code" href="BasicBlockUtils_8h.html">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#include &quot;<a class="code" href="CallGraphUpdater_8h.html">llvm/Transforms/Utils/CallGraphUpdater.h</a>&quot;</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#include &quot;<a class="code" href="Cloning_8h.html">llvm/Transforms/Utils/Cloning.h</a>&quot;</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#include &quot;<a class="code" href="Transforms_2Utils_2Local_8h.html">llvm/Transforms/Utils/Local.h</a>&quot;</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#include &quot;<a class="code" href="ValueMapper_8h.html">llvm/Transforms/Utils/ValueMapper.h</a>&quot;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#include &lt;initializer_list&gt;</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   74</a></span><span class="preprocessor">#define DEBUG_TYPE &quot;coro-split&quot;</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment"></span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">/// A little helper class for building</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="comment"></span><span class="keyword">class </span>CoroCloner {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keyword">enum class</span> Kind {<span class="comment"></span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="comment">    /// The shared resume function for a switch lowering.</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="comment"></span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchResume</a>,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="comment"></span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="comment">    /// The shared unwind function for a switch lowering.</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="comment"></span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchUnwind</a>,</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment"></span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment">    /// The shared cleanup function for a switch lowering.</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="comment"></span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchCleanup</a>,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="comment"></span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment">    /// An individual continuation function.</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment"></span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Continuation</a>,</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  };</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;OrigF;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *NewF;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  Kind FKind;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  <a class="code hl_class" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> VMap;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> Builder;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *NewFramePtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *SwiftErrorSlot = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="comment"></span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="comment">  /// The active suspend instruction; meaningful only for continuation ABIs.</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="comment"></span>  <a class="code hl_class" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *ActiveSuspend = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span><span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="comment">  /// Create a cloner for a switch lowering.</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment"></span>  CoroCloner(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>             Kind FKind)</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    : OrigF(OrigF), NewF(<span class="keyword">nullptr</span>), Suffix(Suffix), Shape(Shape),</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      FKind(FKind), Builder(OrigF.<a class="code hl_function" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>()) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  }</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment"></span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">  /// Create a cloner for a continuation lowering.</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment"></span>  CoroCloner(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>             <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *NewF, <a class="code hl_class" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *ActiveSuspend)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    : OrigF(OrigF), NewF(NewF), Suffix(Suffix), Shape(Shape),</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      FKind(Kind::Continuation), Builder(OrigF.<a class="code hl_function" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>()),</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      ActiveSuspend(ActiveSuspend) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon ||</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>           Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewF &amp;&amp; <span class="stringliteral">&quot;need existing function for continuation&quot;</span>);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ActiveSuspend &amp;&amp; <span class="stringliteral">&quot;need active suspend point for continuation&quot;</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_function" href="Evaluator_8cpp.html#a92efb02157b6836e1232c577d34678d6">getFunction</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewF != <span class="keyword">nullptr</span> &amp;&amp; <span class="stringliteral">&quot;declaration not yet set&quot;</span>);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="keywordflow">return</span> NewF;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  <span class="keywordtype">void</span> create();</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isSwitchDestroyFunction</a>() {</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordflow">switch</span> (FKind) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">case</span> Kind::Continuation:</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordflow">case</span> Kind::SwitchResume:</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordflow">case</span> Kind::SwitchUnwind:</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="keywordflow">case</span> Kind::SwitchCleanup:</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <a class="code hl_define" href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Unknown CoroCloner::Kind enum&quot;</span>);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  }</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">createDeclaration</a>();</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceEntryBlock</a>();</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">deriveNewFramePointer</a>();</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceRetconSuspendUses</a>();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceCoroSuspends</a>();</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceCoroEnds</a>();</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>();</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">handleFinalSuspend</a>();</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  <span class="keywordtype">void</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">maybeFreeContinuationStorage</a>();</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>};</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="foldopen" id="foldopen00162" data-start="{" data-end="}">
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">  162</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> &amp;Builder,</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                                   <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                                   <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon ||</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>         Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a>)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">emitDealloc</a>(Builder, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>}</div>
</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="comment"></span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="comment">/// Replace a non-unwind call to llvm.coro.end.</span></div>
<div class="foldopen" id="foldopen00174" data-start="{" data-end="}">
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a2adc4e4216fd4176a7775ac446467989">  174</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a2adc4e4216fd4176a7775ac446467989">replaceFallthroughCoroEnd</a>(<a class="code hl_class" href="classllvm_1_1CoroEndInst.html">CoroEndInst</a> *End,</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                                      <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>,</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                                      <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  <span class="comment">// Start inserting right before the coro.end.</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(End);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  <span class="comment">// Create the return instruction.</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="comment">// The cloned functions in switch-lowering always return void.</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// coro.end doesn&#39;t immediately end the coroutine in the main function</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// in this lowering, because we need to deallocate the coroutine.</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    Builder.CreateRetVoid();</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  <span class="comment">// In unique continuation lowering, the continuations always return void.</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  <span class="comment">// But we may have implicitly allocated storage.</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(Builder, Shape, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    Builder.CreateRetVoid();</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  <span class="comment">// In non-unique continuation lowering, we signal completion by returning</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <span class="comment">// a null continuation.</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="keywordflow">case</span> coro::ABI::Retcon: {</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(Builder, Shape, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="keyword">auto</span> <a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a> = Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a1a578073d9d2487a3806e8a51abb1b6e">getResumeFunctionType</a>()-&gt;<a class="code hl_function" href="classllvm_1_1FunctionType.html#ad65790aa94dd4678a1d339d8304e1965">getReturnType</a>();</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetStructTy</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;StructType&gt;</a>(<a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a>);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <a class="code hl_class" href="classPointerType.html">PointerType</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ContinuationTy</a> =</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;PointerType&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetStructTy</a> ? <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetStructTy</a>-&gt;getElementType(0) : <a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a>);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnValue</a> = <a class="code hl_function" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ContinuationTy</a>);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetStructTy</a>) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnValue</a> = Builder.CreateInsertValue(<a class="code hl_function" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetStructTy</a>),</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                                              <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnValue</a>, 0);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    }</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    Builder.CreateRet(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnValue</a>);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  <span class="comment">// Remove the rest of the block, by splitting it into an unreachable block.</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  <span class="keyword">auto</span> *BB = End-&gt;getParent();</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  BB-&gt;splitBasicBlock(End);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  BB-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>}</div>
</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="comment"></span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="comment">/// Replace an unwind call to llvm.coro.end.</span></div>
<div class="foldopen" id="foldopen00224" data-start="{" data-end="}">
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a03604902e333b54be2da59880a5b2f37">  224</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a03604902e333b54be2da59880a5b2f37">replaceUnwindCoroEnd</a>(<a class="code hl_class" href="classllvm_1_1CoroEndInst.html">CoroEndInst</a> *End, <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                                 <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>){</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(End);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  <span class="comment">// In switch-lowering, this does nothing in the main function.</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>)</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <span class="comment">// In continuation-lowering, this frees the continuation storage.</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a>(Builder, Shape, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="comment">// If coro.end has an associated bundle, add cleanupret instruction.</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> Bundle = End-&gt;getOperandBundle(<a class="code hl_enumvalue" href="classllvm_1_1LLVMContext.html#aac05e688583e3d2bb9b04f767b22ac32a8997c6b0930e2c05209e95e7172c6cf3">LLVMContext::OB_funclet</a>)) {</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FromPad</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CleanupPadInst&gt;</a>(Bundle-&gt;Inputs[0]);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupRet</a> = Builder.CreateCleanupRet(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FromPad</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    End-&gt;getParent()-&gt;splitBasicBlock(End);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupRet</a>-&gt;getParent()-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>}</div>
</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="foldopen" id="foldopen00251" data-start="{" data-end="}">
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a32be6dd93194bade824548c9247d8947">  251</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a32be6dd93194bade824548c9247d8947">replaceCoroEnd</a>(<a class="code hl_class" href="classllvm_1_1CoroEndInst.html">CoroEndInst</a> *End, <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>                           <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  <span class="keywordflow">if</span> (End-&gt;isUnwind())</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a03604902e333b54be2da59880a5b2f37">replaceUnwindCoroEnd</a>(End, Shape, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a2adc4e4216fd4176a7775ac446467989">replaceFallthroughCoroEnd</a>(End, Shape, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  <span class="keyword">auto</span> &amp;Context = End-&gt;getContext();</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>  End-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InResume</a> ? <a class="code hl_function" href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(Context)</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                                   : <a class="code hl_function" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(Context));</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  End-&gt;eraseFromParent();</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>}</div>
</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="comment">// Create an entry block for a resume function with a switch that will jump to</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="comment">// suspend points.</span></div>
<div class="foldopen" id="foldopen00266" data-start="{" data-end="}">
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">  266</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="comment">// resume.entry:</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  <span class="comment">//  %index.addr = getelementptr inbounds %f.Frame, %f.Frame* %FramePtr, i32 0,</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>  <span class="comment">//  i32 2</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="comment">//  % index = load i32, i32* %index.addr</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  <span class="comment">//  switch i32 %index, label %unreachable [</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>  <span class="comment">//    i32 0, label %resume.0</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>  <span class="comment">//    i32 1, label %resume.1</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <span class="comment">//    ...</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="comment">//  ]</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewEntry</a> = <a class="code hl_function" href="classllvm_1_1BasicBlock.html#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <span class="stringliteral">&quot;resume.entry&quot;</span>, &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnreachBB</a> = <a class="code hl_function" href="classllvm_1_1BasicBlock.html#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <span class="stringliteral">&quot;unreachable&quot;</span>, &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewEntry</a>);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <span class="keyword">auto</span> *<a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a> = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>  <span class="keyword">auto</span> *FrameTy = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a> = Builder.CreateStructGEP(</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      FrameTy, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">getSwitchIndexField</a>(), <span class="stringliteral">&quot;index.addr&quot;</span>);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  <span class="keyword">auto</span> *Index = Builder.CreateLoad(Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a22c53726eaeafbc188994ecbc7e27674">getIndexType</a>(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a>, <span class="stringliteral">&quot;index&quot;</span>);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  <span class="keyword">auto</span> *Switch =</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      Builder.CreateSwitch(Index, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnreachBB</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>  Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ab9ff52a8227ec3fe5547af29ed59622f">ResumeSwitch</a> = Switch;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  <span class="keywordtype">size_t</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendIndex</a> = 0;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AnyS</a> : Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>) {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="keyword">auto</span> *S = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroSuspendInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AnyS</a>);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <a class="code hl_class" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IndexVal</a> = Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a9e8a88398e176735a277b77269570c50">getIndex</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendIndex</a>);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    <span class="comment">// Replace CoroSave with a store to Index:</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="comment">//    %index.addr = getelementptr %f.frame... (index field number)</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="comment">//    store i32 0, i32* %index.addr1</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="keyword">auto</span> *Save = S-&gt;getCoroSave();</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    Builder.SetInsertPoint(Save);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="keywordflow">if</span> (S-&gt;isFinal()) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      <span class="comment">// Final suspend point is represented by storing zero in ResumeFnAddr.</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a> = Builder.CreateStructGEP(FrameTy, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>,</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                                 <a class="code hl_enumvalue" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                                  <span class="stringliteral">&quot;ResumeFn.addr&quot;</span>);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      <span class="keyword">auto</span> *NullPtr = <a class="code hl_function" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;PointerType&gt;</a>(</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;PointerType&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a>-&gt;getType())-&gt;getElementType()));</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      Builder.CreateStore(NullPtr, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a>);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a> = Builder.CreateStructGEP(</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>          FrameTy, <a class="code hl_variable" href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a>, Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">getSwitchIndexField</a>(), <span class="stringliteral">&quot;index.addr&quot;</span>);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      Builder.CreateStore(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IndexVal</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a>);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    Save-&gt;replaceAllUsesWith(<a class="code hl_function" href="classllvm_1_1ConstantTokenNone.html#a8e29fb8e39fb67b3bb746dbba47fcb29">ConstantTokenNone::get</a>(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>));</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    Save-&gt;eraseFromParent();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <span class="comment">// Split block before and after coro.suspend and add a jump from an entry</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="comment">// switch:</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="comment">//  whateverBB:</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <span class="comment">//    whatever</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">//    %0 = call i8 @llvm.coro.suspend(token none, i1 false)</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="comment">//    switch i8 %0, label %suspend[i8 0, label %resume</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="comment">//                                 i8 1, label %cleanup]</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="comment">// becomes:</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="comment">//  whateverBB:</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="comment">//     whatever</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="comment">//     br label %resume.0.landing</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="comment">//  resume.0: ; &lt;--- jump from the switch in the resume.entry</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">//     %0 = tail call i8 @llvm.coro.suspend(token none, i1 false)</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="comment">//     br label %resume.0.landing</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="comment">//  resume.0.landing:</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="comment">//     %1 = phi i8[-1, %whateverBB], [%0, %resume.0]</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="comment">//     switch i8 % 1, label %suspend [i8 0, label %resume</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="comment">//                                    i8 1, label %cleanup]</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a> = S-&gt;getParent();</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a> =</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>-&gt;splitBasicBlock(S, <span class="stringliteral">&quot;resume.&quot;</span> + <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendIndex</a>));</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LandingBB</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a>-&gt;splitBasicBlock(</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        S-&gt;getNextNode(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a>-&gt;getName() + <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.landing&quot;</span>));</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    Switch-&gt;addCase(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IndexVal</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a>);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BranchInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>-&gt;getTerminator())-&gt;setSuccessor(0, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LandingBB</a>);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    <span class="keyword">auto</span> *PN = <a class="code hl_function" href="classllvm_1_1PHINode.html#a923cca615da7f7e3387cf7a87fc53cad">PHINode::Create</a>(Builder.getInt8Ty(), 2, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">LandingBB</a>-&gt;front());</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    S-&gt;replaceAllUsesWith(PN);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    PN-&gt;addIncoming(Builder.getInt8(-1), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    PN-&gt;addIncoming(S, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a>);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendIndex</a>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>  }</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  Builder.SetInsertPoint(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnreachBB</a>);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>  Builder.CreateUnreachable();</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ae5f82081e3f2b39a7e795491bb5d7a6e">ResumeEntryBlock</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewEntry</a>;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>}</div>
</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment">// Rewrite final suspend point handling. We do not use suspend index to</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment">// represent the final suspend point. Instead we zero-out ResumeFnAddr in the</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment">// coroutine frame, since it is undefined behavior to resume a coroutine</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">// suspended at the final suspend point. Thus, in the resume function, we can</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment">// simply remove the last case (when coro::Shape is built, the final suspend</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">// point (if present) is always the last element of CoroSuspends array).</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment">// In the destroy function, we add a code sequence to check if ResumeFnAddress</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment">// is Null, and if so, jump to the appropriate label to handle cleanup from the</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span><span class="comment">// final suspend point.</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span><span class="keywordtype">void</span> CoroCloner::handleFinalSuspend() {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch &amp;&amp;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>         Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a443e8b3df70f81937afd7c6bf52f9f84">HasFinalSuspend</a>);</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keyword">auto</span> *<a class="code hl_enumvalue" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;SwitchInst&gt;</a>(VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ab9ff52a8227ec3fe5547af29ed59622f">ResumeSwitch</a>]);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FinalCaseIt</a> = std::prev(<a class="code hl_enumvalue" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;case_end());</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FinalCaseIt</a>-&gt;getCaseSuccessor();</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  <a class="code hl_enumvalue" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;removeCase(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FinalCaseIt</a>);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isSwitchDestroyFunction</a>()) {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSwitchBB</a> = <a class="code hl_enumvalue" href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;getParent();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewSwitchBB</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSwitchBB</a>-&gt;splitBasicBlock(Switch, <span class="stringliteral">&quot;Switch&quot;</span>);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    Builder.SetInsertPoint(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSwitchBB</a>-&gt;getTerminator());</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a> = Builder.CreateStructGEP(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, NewFramePtr,</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                                       <a class="code hl_enumvalue" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                                             <span class="stringliteral">&quot;ResumeFn.addr&quot;</span>);</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="keyword">auto</span> *<a class="code hl_enumvalue" href="namespacellvm_1_1SPII.html#ac8789a4d36d2b7d2c4baf84cf9021279a5069619ca8fdce305534f3fe85091a0f">Load</a> = Builder.CreateLoad(Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a2e44b079291a98a6f381ddc2f4e613d0">getSwitchResumePointerType</a>(),</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                                    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">GepIndex</a>);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keyword">auto</span> *<a class="code hl_variable" href="BBSectionsPrepare_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = Builder.CreateIsNull(Load);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    Builder.CreateCondBr(<a class="code hl_variable" href="BBSectionsPrepare_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeBB</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewSwitchBB</a>);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldSwitchBB</a>-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>  }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>}</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="foldopen" id="foldopen00396" data-start="{" data-end="}">
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a890a9012085abcc24f186c98388e45e5">  396</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_function" href="CoroSplit_8cpp.html#a890a9012085abcc24f186c98388e45e5">createCloneDeclaration</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;OrigF, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>                                        <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix,</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>                                        <a class="code hl_typedef" href="classllvm_1_1Module.html#a7893161303eb07ae7864db6b3d004d9e">Module::iterator</a> InsertBefore) {</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> *M = OrigF.<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">getParent</a>();</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keyword">auto</span> *FnTy = Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a1a578073d9d2487a3806e8a51abb1b6e">getResumeFunctionType</a>();</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *NewF =</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>      <a class="code hl_function" href="classllvm_1_1Function.html#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FnTy, GlobalValue::LinkageTypes::InternalLinkage,</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                       OrigF.<a class="code hl_function" href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + Suffix);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NonNull);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoAlias);</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>  M-&gt;getFunctionList().insert(InsertBefore, NewF);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  <span class="keywordflow">return</span> NewF;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>}</div>
</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="comment"></span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span><span class="comment">/// Replace uses of the active llvm.coro.suspend.retcon call with the</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span><span class="comment">/// arguments to the continuation function.</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span><span class="comment">///</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="comment">/// This assumes that the builder has a meaningful insertion point.</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment"></span><span class="keywordtype">void</span> CoroCloner::replaceRetconSuspendUses() {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon ||</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>         Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a> = VMap[ActiveSuspend];</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;use_empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>  <span class="comment">// Copy out all the continuation arguments after the buffer pointer into</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  <span class="comment">// an easily-indexed data structure for convenience.</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;Value*, 8&gt;</a> <a class="code hl_variable" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = std::next(NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">arg_begin</a>()), <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a8300ac1ef141b8a7c63c13fa9369d976">arg_end</a>(); <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>; ++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <a class="code hl_variable" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.push_back(&amp;*<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>  <span class="comment">// If the suspend returns a single scalar value, we can just do a simple</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  <span class="comment">// replacement.</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;StructType&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;getType())) {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_variable" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.size() == 1);</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;replaceAllUsesWith(<a class="code hl_variable" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.front());</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  <span class="comment">// Try to peephole extracts of an aggregate return.</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> UI = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;use_begin(), UE = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;use_end(); UI != UE; ) {</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;ExtractValueInst&gt;</a>((UI++)-&gt;getUser());</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a> || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a>-&gt;getNumIndices() != 1)</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a>-&gt;replaceAllUsesWith(Args[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a>-&gt;getIndices().front()]);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">EVI</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// If we have no remaining uses, we&#39;re done.</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;use_empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  <span class="comment">// Otherwise, we need to create an aggregate.</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Agg</a> = <a class="code hl_function" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;getType());</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a> = <a class="code hl_variable" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>.size(); <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>; ++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Agg</a> = Builder.CreateInsertValue(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Agg</a>, Args[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewS</a>-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Agg</a>);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>}</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="keywordtype">void</span> CoroCloner::replaceCoroSuspends() {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendResult</a>;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="comment">// In switch lowering, replace coro.suspend with the appropriate value</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>  <span class="comment">// for the type of function we&#39;re extracting.</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="comment">// Replacing coro.suspend with (0) will result in control flow proceeding to</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="comment">// a resume label associated with a suspend point, replacing it with (1) will</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="comment">// result in control flow proceeding to a cleanup label associated with this</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>  <span class="comment">// suspend point.</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendResult</a> = Builder.getInt8(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isSwitchDestroyFunction</a>() ? 1 : 0);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <span class="comment">// In returned-continuation lowering, the arguments from earlier</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>  <span class="comment">// continuations are theoretically arbitrary, and they should have been</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  <span class="comment">// spilled.</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1AnyCoroSuspendInst.html">AnyCoroSuspendInst</a> *CS : Shape.CoroSuspends) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <span class="comment">// The active suspend was handled earlier.</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keywordflow">if</span> (CS == ActiveSuspend) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedCS</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;AnyCoroSuspendInst&gt;</a>(VMap[CS]);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedCS</a>-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendResult</a>);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedCS</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>  }</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>}</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><span class="keywordtype">void</span> CoroCloner::replaceCoroEnds() {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CoroEndInst.html">CoroEndInst</a> *CE : Shape.CoroEnds) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="comment">// We use a null call graph because there&#39;s no call graph node for</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="comment">// the cloned function yet.  We&#39;ll just be rebuilding that later.</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCE</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroEndInst&gt;</a>(VMap[CE]);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a32be6dd93194bade824548c9247d8947">replaceCoroEnd</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewCE</a>, Shape, NewFramePtr, <span class="comment">/*in resume*/</span> <span class="keyword">true</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>  }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>}</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="foldopen" id="foldopen00500" data-start="{" data-end="}">
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">  500</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                                 <a class="code hl_class" href="classllvm_1_1ValueMap.html">ValueToValueMapTy</a> *VMap) {</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getSwiftErrorSlot</a> = [&amp;](<a class="code hl_class" href="classllvm_1_1Type.html">Type</a> *ValueTy) -&gt; <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> * {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a>) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>      <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a>-&gt;getType()-&gt;getPointerElementType() == ValueTy &amp;&amp;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>             <span class="stringliteral">&quot;multiple swifterror slots in function with different types&quot;</span>);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>      <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a>;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    }</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="comment">// Check if the function has a swifterror argument.</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a> : <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.args()) {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.isSwiftError()) {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a> = &amp;<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>.getType()-&gt;getPointerElementType() == ValueTy &amp;&amp;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>               <span class="stringliteral">&quot;swifterror argument does not have expected type&quot;</span>);</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a>;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>      }</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    }</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="comment">// Create a swifterror alloca.</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().getFirstNonPHIOrDbg());</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keyword">auto</span> Alloca = Builder.CreateAlloca(ValueTy);</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    Alloca-&gt;setSwiftError(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CachedSlot</a> = Alloca;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="keywordflow">return</span> Alloca;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>  };</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a> *Op : Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedOp</a> = VMap ? <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CallInst&gt;</a>((*VMap)[Op]) : Op;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedOp</a>);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="comment">// If there are no arguments, this is a &#39;get&#39; operation.</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedResult</a>;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="keywordflow">if</span> (Op-&gt;getNumArgOperands() == 0) {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      <span class="keyword">auto</span> ValueTy = Op-&gt;getType();</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      <span class="keyword">auto</span> Slot = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getSwiftErrorSlot</a>(ValueTy);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedResult</a> = Builder.CreateLoad(ValueTy, Slot);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>      <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Op-&gt;getNumArgOperands() == 1);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>      <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedOp</a>-&gt;getArgOperand(0);</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      <span class="keyword">auto</span> ValueTy = <a class="code hl_class" href="classllvm_1_1Value.html">Value</a>-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a0344a49526443edf90cc0aef3abd3337">getType</a>();</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>      <span class="keyword">auto</span> Slot = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getSwiftErrorSlot</a>(ValueTy);</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      Builder.CreateStore(<a class="code hl_class" href="classllvm_1_1Value.html">Value</a>, Slot);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedResult</a> = Slot;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedOp</a>-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedResult</a>);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedOp</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>  }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>  <span class="comment">// If we&#39;re updating the original function, we&#39;ve invalidated SwiftErrorOps.</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  <span class="keywordflow">if</span> (VMap == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">SwiftErrorOps</a>.clear();</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>}</div>
</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="keywordtype">void</span> CoroCloner::replaceSwiftErrorOps() {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">::replaceSwiftErrorOps</a>(*NewF, Shape, &amp;VMap);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>}</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="keywordtype">void</span> CoroCloner::replaceEntryBlock() {</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="comment">// In the original function, the AllocaSpillBlock is a block immediately</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  <span class="comment">// following the allocation of the frame object which defines GEPs for</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="comment">// all the allocas that have been moved into the frame, and it ends by</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>  <span class="comment">// branching to the original beginning of the coroutine.  Make this</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  <span class="comment">// the entry block of the cloned function.</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  <span class="keyword">auto</span> *Entry = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BasicBlock&gt;</a>(VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ae3a9a76ce45cff6c0385091993bccdcc">AllocaSpillBlock</a>]);</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldEntry</a> = &amp;NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>();</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  Entry-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<span class="stringliteral">&quot;entry&quot;</span> + Suffix);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  Entry-&gt;moveBefore(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldEntry</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  Entry-&gt;getTerminator()-&gt;eraseFromParent();</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="comment">// Clear all predecessors of the new entry block.  There should be</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="comment">// exactly one predecessor, which we created when splitting out</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>  <span class="comment">// AllocaSpillBlock to begin with.</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Entry-&gt;hasOneUse());</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchToEntry</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BranchInst&gt;</a>(Entry-&gt;user_back());</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchToEntry</a>-&gt;isUnconditional());</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  Builder.SetInsertPoint(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchToEntry</a>);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  Builder.CreateUnreachable();</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">BranchToEntry</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  <span class="comment">// Move any allocas into Entry that weren&#39;t moved into the frame.</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="ARMSubtarget_8cpp.html#a4d4aec1a60ca09085c2b909af09a8c8b">IT</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldEntry</a>-&gt;begin(), End = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldEntry</a>-&gt;end(); <a class="code hl_variable" href="ARMSubtarget_8cpp.html#a4d4aec1a60ca09085c2b909af09a8c8b">IT</a> != End;) {</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = *<a class="code hl_variable" href="ARMSubtarget_8cpp.html#a4d4aec1a60ca09085c2b909af09a8c8b">IT</a>++;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;AllocaInst&gt;</a>(&amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.use_empty())</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.moveBefore(*Entry, Entry-&gt;getFirstInsertionPt());</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="comment">// Branch from the entry to the appropriate place.</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  Builder.SetInsertPoint(Entry);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  <span class="keywordflow">case</span> coro::ABI::Switch: {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <span class="comment">// In switch-lowering, we built a resume-entry block in the original</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    <span class="comment">// function.  Make the entry block branch to this.</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchBB</a> =</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BasicBlock&gt;</a>(VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ae5f82081e3f2b39a7e795491bb5d7a6e">ResumeEntryBlock</a>]);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    Builder.CreateBr(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchBB</a>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce: {</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <span class="comment">// In continuation ABIs, we want to branch to immediately after the</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="comment">// active suspend point.  Earlier phases will have put the suspend in its</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <span class="comment">// own basic block, so just thread our jump directly to its successor.</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedCS</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroSuspendRetconInst&gt;</a>(VMap[ActiveSuspend]);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BranchInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">MappedCS</a>-&gt;getNextNode());</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_enumvalue" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;isUnconditional());</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    Builder.CreateBr(<a class="code hl_enumvalue" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a>-&gt;getSuccessor(0));</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  }</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  }</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>}</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span><span class="comment"></span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span><span class="comment">/// Derive the value of the new frame pointer.</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span><span class="comment"></span><a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *CoroCloner::deriveNewFramePointer() {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  <span class="comment">// Builder should be inserting to the front of the new entry block.</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span> </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  <span class="comment">// In switch-lowering, the argument is the frame pointer.</span></div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keywordflow">return</span> &amp;*NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">arg_begin</a>();</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  <span class="comment">// In continuation-lowering, the argument is the opaque storage.</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce: {</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <a class="code hl_class" href="classllvm_1_1Argument.html">Argument</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewStorage</a> = &amp;*NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">arg_begin</a>();</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrTy</a> = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>-&gt;<a class="code hl_function" href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">getPointerTo</a>();</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="comment">// If the storage is inline, just bitcast to the storage to the frame type.</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a>)</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      <span class="keywordflow">return</span> Builder.CreateBitCast(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewStorage</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrTy</a>);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="comment">// Otherwise, load the real frame from the opaque storage.</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrPtr</a> =</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      Builder.CreateBitCast(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewStorage</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrTy</a>-&gt;getPointerTo());</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    <span class="keywordflow">return</span> Builder.CreateLoad(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrTy</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FramePtrPtr</a>);</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <a class="code hl_define" href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;bad ABI&quot;</span>);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>}</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="foldopen" id="foldopen00647" data-start="{" data-end="}">
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ad6e01ddef1bbbcc78868710f00b00c68">  647</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ad6e01ddef1bbbcc78868710f00b00c68">addFramePointerAttrs</a>(<a class="code hl_class" href="classllvm_1_1AttributeList.html">AttributeList</a> &amp;Attrs, <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context,</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                                 <span class="keywordtype">unsigned</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamIndex</a>,</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                                 uint64_t <a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a>, <a class="code hl_struct" href="structllvm_1_1Align.html">Align</a> Alignment) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  <a class="code hl_class" href="classllvm_1_1AttrBuilder.html">AttrBuilder</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>.addAttribute(Attribute::NonNull);</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>.addAttribute(Attribute::NoAlias);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>.addAlignmentAttr(Alignment);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>.addDereferenceableAttr(<a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a>);</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  Attrs = Attrs.addParamAttributes(Context, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamIndex</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ParamAttrs</a>);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>}</div>
</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="comment"></span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span><span class="comment">/// Clone the body of the original function into a resume function of</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="comment">/// some sort.</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="comment"></span><span class="keywordtype">void</span> CoroCloner::create() {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="comment">// Create the new function if we don&#39;t already have one.</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="keywordflow">if</span> (!NewF) {</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    NewF = <a class="code hl_function" href="CoroSplit_8cpp.html#a890a9012085abcc24f186c98388e45e5">createCloneDeclaration</a>(OrigF, Shape, Suffix,</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>                                  OrigF.<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">getParent</a>()-&gt;<a class="code hl_function" href="classllvm_1_1Module.html#aa608a2d900dd6c15c18f4236b6548496">end</a>());</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <span class="comment">// Replace all args with undefs. The buildCoroutineFrame algorithm already</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <span class="comment">// rewritten access to the args that occurs after suspend points with loads</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <span class="comment">// and stores to/from the coroutine frame.</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1Argument.html">Argument</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a3545a9491d4dcf823feb79f6eb37e3ee">A</a> : OrigF.args())</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    VMap[&amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a3545a9491d4dcf823feb79f6eb37e3ee">A</a>] = <a class="code hl_class" href="classllvm_1_1UndefValue.html">UndefValue</a>::get(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a3545a9491d4dcf823feb79f6eb37e3ee">A</a>.<a class="code hl_function" href="WebAssemblyMCInstLower_8cpp.html#af678953060add50e8c34b34d5f4bdd65">getType</a>());</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;ReturnInst *, 4&gt;</a> Returns;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <span class="comment">// Ignore attempts to change certain attributes of the function.</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>  <span class="comment">// TODO: maybe there should be a way to suppress this during cloning?</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedVisibility</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a28b9561d9ef3d237ef894023187fa26c">getVisibility</a>();</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedUnnamedAddr</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#ac2417a3c6edd0db7a9ad84b82c4054b7">getUnnamedAddr</a>();</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedDLLStorageClass</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#af09a662b4e302d0683d0fe9dc2a9335f">getDLLStorageClass</a>();</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  <span class="comment">// NewF&#39;s linkage (which CloneFunctionInto does *not* change) might not</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="comment">// be compatible with the visibility of OrigF (which it *does* change),</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>  <span class="comment">// so protect against that.</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedLinkage</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a3547d58a060ee2e4a29cbea85bef91af">getLinkage</a>();</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a687973de03d041e04b50a76d19d4fd36">setLinkage</a>(<a class="code hl_enumvalue" href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e">llvm::GlobalValue::ExternalLinkage</a>);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <a class="code hl_function" href="namespacellvm.html#af773509e734af567c96f833f39247401">CloneFunctionInto</a>(NewF, &amp;OrigF, VMap, <span class="comment">/*ModuleLevelChanges=*/</span><span class="keyword">true</span>, Returns);</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a687973de03d041e04b50a76d19d4fd36">setLinkage</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedLinkage</a>);</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#aa242d8ab89216c14beab812e07009b2a">setVisibility</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedVisibility</a>);</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a38c97622dccff7ae31fe0be3b21c9b3d">setUnnamedAddr</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedUnnamedAddr</a>);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a40c699aba3d6b469357ef0b4e1aa2580">setDLLStorageClass</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">savedDLLStorageClass</a>);</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="keyword">auto</span> &amp;Context = NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="comment">// Replace the attributes of the new function:</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigAttrs</a> = NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>();</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a> = <a class="code hl_class" href="classllvm_1_1AttributeList.html">AttributeList</a>();</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="comment">// Bootstrap attributes by copying function attributes from the</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="comment">// original function.  This should include optimization settings and so on.</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a>.addAttributes(Context, <a class="code hl_enumvalue" href="classllvm_1_1AttributeList.html#af5dcb6d3da4b30a7d21c9fb39bbf1a68a895001b186ed51e1cb7a256dbd3545f8">AttributeList::FunctionIndex</a>,</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>                                      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OrigAttrs</a>.getFnAttributes());</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span> </div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#ad6e01ddef1bbbcc78868710f00b00c68">addFramePointerAttrs</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a>, Context, 0,</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>                         Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">FrameSize</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span> </div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <span class="comment">// If we have a continuation prototype, just use its attributes,</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <span class="comment">// full-stop.</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a> = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#ad216a4effb4c2371f7d42c8a6364b4d8">ResumePrototype</a>-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>();</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#ad6e01ddef1bbbcc78868710f00b00c68">addFramePointerAttrs</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a>, Context, 0,</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>                         Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a2acb69a078f9bb3184aa59c6d4966861">getRetconCoroId</a>()-&gt;<a class="code hl_function" href="classllvm_1_1AnyCoroIdRetconInst.html#a591b908fe4707059172b0ee3cd2ed4a2">getStorageSize</a>(),</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                         Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a2acb69a078f9bb3184aa59c6d4966861">getRetconCoroId</a>()-&gt;<a class="code hl_function" href="classllvm_1_1AnyCoroIdRetconInst.html#a3a0e2ffc025fe9de9569095d9ac140b8">getStorageAlignment</a>());</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  <span class="comment">// In these ABIs, the cloned functions always return &#39;void&#39;, and the</span></div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  <span class="comment">// existing return sites are meaningless.  Note that for unique</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <span class="comment">// continuations, this includes the returns associated with suspends;</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  <span class="comment">// this is fine because we can&#39;t suspend twice.</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <span class="comment">// Remove old returns.</span></div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1ReturnInst.html">ReturnInst</a> *Return : Returns)</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>      <a class="code hl_function" href="namespacellvm.html#afe3f17791a010d9d25790fc87ee3cca9">changeToUnreachable</a>(<a class="code hl_enumvalue" href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a5416d9f1bd5f533efddadf17d713e469">Return</a>, <span class="comment">/*UseLLVMTrap=*/</span><a class="code hl_namespace" href="namespacefalse.html">false</a>);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  <span class="comment">// With multi-suspend continuations, we&#39;ll already have eliminated the</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  <span class="comment">// original returns and inserted returns before all the suspend points,</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  <span class="comment">// so we want to leave any returns in place.</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>  }</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span> </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewAttrs</a>);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#ae6db8746934e6feae3649a8709fce3cc">setCallingConv</a>(Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a4e2e134e22f7bd3f6270ef63546e9994">getResumeFunctionCC</a>());</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  <span class="comment">// Set up the new entry block.</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceEntryBlock</a>();</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  Builder.SetInsertPoint(&amp;NewF-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>().<a class="code hl_function" href="classllvm_1_1BasicBlock.html#a4848d1a141ddc7cf0068460fba53ba37">front</a>());</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>  NewFramePtr = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">deriveNewFramePointer</a>();</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>  <span class="comment">// Remap frame pointer.</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldFramePtr</a> = VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>];</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>  NewFramePtr-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">takeName</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldFramePtr</a>);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldFramePtr</a>-&gt;replaceAllUsesWith(NewFramePtr);</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  <span class="comment">// Remap vFrame pointer.</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewVFrame</a> = Builder.CreateBitCast(</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>      NewFramePtr, Type::getInt8PtrTy(Builder.getContext()), <span class="stringliteral">&quot;vFrame&quot;</span>);</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldVFrame</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;Value&gt;</a>(VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>]);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">OldVFrame</a>-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewVFrame</a>);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>  <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="comment">// Rewrite final suspend handling as it is not done via switch (allows to</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <span class="comment">// remove final case from the switch, since it is undefined behavior to</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    <span class="comment">// resume the coroutine suspended at the final suspend point.</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">SwitchLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a443e8b3df70f81937afd7c6bf52f9f84">HasFinalSuspend</a>)</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">handleFinalSuspend</a>();</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    <span class="comment">// Replace uses of the active suspend with the corresponding</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    <span class="comment">// continuation-function arguments.</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ActiveSuspend != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>           <span class="stringliteral">&quot;no active suspend when lowering a continuation-style coroutine&quot;</span>);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceRetconSuspendUses</a>();</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>  }</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span> </div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>  <span class="comment">// Handle suspends.</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceCoroSuspends</a>();</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>  <span class="comment">// Handle swifterror.</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>();</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  <span class="comment">// Remove coro.end intrinsics.</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceCoroEnds</a>();</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span> </div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>  <span class="comment">// Eliminate coro.free from the clones, replacing it with &#39;null&#39; in cleanup,</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  <span class="comment">// to suppress deallocation code.</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch)</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    <a class="code hl_function" href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">coro::replaceCoroFree</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroIdInst&gt;</a>(VMap[Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code hl_function" href="classllvm_1_1CoroBeginInst.html#a30b3ddd0433d254830f61bf122e5eefc">getId</a>()]),</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>                          <span class="comment">/*Elide=*/</span> FKind == CoroCloner::Kind::SwitchCleanup);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>}</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">// Create a resume clone by cloning the body of the original function, setting</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">// new entry block and replacing coro.suspend an appropriate value to force</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span><span class="comment">// resume or cleanup pass for every suspend point.</span></div>
<div class="foldopen" id="foldopen00800" data-start="{" data-end="}">
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">  800</a></span><span class="keyword">static</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_function" href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">createClone</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a> &amp;Suffix,</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>                             <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, CoroCloner::Kind FKind) {</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>  CoroCloner Cloner(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Suffix, Shape, FKind);</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>  Cloner.create();</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>  <span class="keywordflow">return</span> Cloner.getFunction();</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>}</div>
</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment"></span> </div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="comment">/// Remove calls to llvm.coro.end in the original function.</span></div>
<div class="foldopen" id="foldopen00808" data-start="{" data-end="}">
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a3296d9f25bb33fa463f2e24c1c5cf3da">  808</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a3296d9f25bb33fa463f2e24c1c5cf3da">removeCoroEnds</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> *<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> End : Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a7be03390074e7829c25074165141a797">CoroEnds</a>) {</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a32be6dd93194bade824548c9247d8947">replaceCoroEnd</a>(End, Shape, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>, <span class="comment">/*in resume*/</span> <span class="keyword">false</span>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>  }</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>}</div>
</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="foldopen" id="foldopen00814" data-start="{" data-end="}">
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a2cbc874ec5612ccb47cad7f07ff51f94">  814</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a2cbc874ec5612ccb47cad7f07ff51f94">replaceFrameSize</a>(<a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>.empty())</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>  <span class="comment">// In the same function all coro.sizes should have the same result type.</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SizeIntrin</a> = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>.back();</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> *M = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SizeIntrin</a>-&gt;getModule();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>  <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code hl_variable" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = M-&gt;getDataLayout();</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a> = <a class="code hl_variable" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SizeConstant</a> = <a class="code hl_function" href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">ConstantInt::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SizeIntrin</a>-&gt;getType(), <a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a>);</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CoroSizeInst.html">CoroSizeInst</a> *CS : Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">CoroSizes</a>) {</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    CS-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SizeConstant</a>);</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    CS-&gt;eraseFromParent();</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>  }</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>}</div>
</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span> </div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span><span class="comment">// Create a global constant array containing pointers to functions provided and</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span><span class="comment">// set Info parameter of CoroBegin to point at this constant. Example:</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span><span class="comment">//</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span><span class="comment">//   @f.resumers = internal constant [2 x void(%f.frame*)*]</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span><span class="comment">//                    [void(%f.frame*)* @f.resume, void(%f.frame*)* @f.destroy]</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="comment">//   define void @f() {</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="comment">//     ...</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span><span class="comment">//     call i8* @llvm.coro.begin(i8* null, i32 0, i8* null,</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span><span class="comment">//                    i8* bitcast([2 x void(%f.frame*)*] * @f.resumers to i8*))</span></div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span><span class="comment">//</span></div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span><span class="comment">// Assumes that all the functions have the same signature.</span></div>
<div class="foldopen" id="foldopen00842" data-start="{" data-end="}">
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">  842</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>                        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ArrayRef&lt;Function *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Fns</a>) {</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>  <span class="comment">// This only works under the switch-lowering ABI because coro elision</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>  <span class="comment">// only works on the switch-lowering ABI.</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span> </div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;Constant *, 4&gt;</a> Args(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Fns</a>.begin(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Fns</a>.end());</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Args.empty());</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *Part = *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Fns</a>.begin();</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> *M = Part-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">getParent</a>();</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ArrTy</a> = ArrayType::get(Part-&gt;<a class="code hl_function" href="classllvm_1_1GlobalValue.html#a913a5d4b2cddde762446bd494e81a3f2">getType</a>(), Args.size());</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>  <span class="keyword">auto</span> *ConstVal = <a class="code hl_function" href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ArrTy</a>, Args);</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>  <span class="keyword">auto</span> *GV = <span class="keyword">new</span> <a class="code hl_class" href="classllvm_1_1GlobalVariable.html">GlobalVariable</a>(*M, ConstVal-&gt;getType(), <span class="comment">/*isConstant=*/</span><span class="keyword">true</span>,</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>                                GlobalVariable::PrivateLinkage, ConstVal,</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>                                <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName() + <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<span class="stringliteral">&quot;.resumers&quot;</span>));</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span> </div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>  <span class="comment">// Update coro.begin instruction to refer to this constant.</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>  <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>  <span class="keyword">auto</span> *BC = <a class="code hl_function" href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">ConstantExpr::getPointerCast</a>(GV, Type::getInt8PtrTy(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>));</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>  Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a3660324b8035c8b52afd23e54623ddf8">getSwitchCoroId</a>()-&gt;<a class="code hl_function" href="classllvm_1_1CoroIdInst.html#a11b71b3b2f2b4d214a7eac47e628b3d2">setInfo</a>(BC);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>}</div>
</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span><span class="comment">// Store addresses of Resume/Destroy/Cleanup functions in the coroutine frame.</span></div>
<div class="foldopen" id="foldopen00866" data-start="{" data-end="}">
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">  866</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a>(<a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape, <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeFn</a>,</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>                            <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyFn</a>, <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupFn</a>) {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span> </div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>-&gt;<a class="code hl_function" href="classllvm_1_1ilist__node__with__parent.html#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>());</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>  <span class="keyword">auto</span> *ResumeAddr = Builder.CreateStructGEP(</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>      Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>, <a class="code hl_enumvalue" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a012dd1dc85c718e8159980fa4273d9e6">coro::Shape::SwitchFieldIndex::Resume</a>,</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>      <span class="stringliteral">&quot;resume.addr&quot;</span>);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  Builder.CreateStore(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeFn</a>, ResumeAddr);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyOrCleanupFn</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyFn</a>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  <a class="code hl_class" href="classllvm_1_1CoroIdInst.html">CoroIdInst</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CoroId</a> = Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a3660324b8035c8b52afd23e54623ddf8">getSwitchCoroId</a>();</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1CoroAllocInst.html">CoroAllocInst</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CA</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CoroId</a>-&gt;getCoroAlloc()) {</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    <span class="comment">// If there is a CoroAlloc and it returns false (meaning we elide the</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    <span class="comment">// allocation, use CleanupFn instead of DestroyFn).</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyOrCleanupFn</a> = Builder.CreateSelect(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CA</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyFn</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupFn</a>);</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>  }</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  <span class="keyword">auto</span> *DestroyAddr = Builder.CreateStructGEP(</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>      Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>, <a class="code hl_enumvalue" href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a0416e9f2fbff942bd66bfa6d7e759d47">coro::Shape::SwitchFieldIndex::Destroy</a>,</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>      <span class="stringliteral">&quot;destroy.addr&quot;</span>);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  Builder.CreateStore(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyOrCleanupFn</a>, DestroyAddr);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>}</div>
</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span> </div>
<div class="foldopen" id="foldopen00891" data-start="{" data-end="}">
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">  891</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>  <a class="code hl_function" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span> </div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>  <span class="comment">// For now, we do a mandatory verification step because we don&#39;t</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>  <span class="comment">// entirely trust this pass.  Note that we don&#39;t want to add a verifier</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>  <span class="comment">// pass to FPM below because it will also verify all the global data.</span></div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">verifyFunction</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &amp;<a class="code hl_function" href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()))</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <a class="code hl_function" href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">report_fatal_error</a>(<span class="stringliteral">&quot;Broken function&quot;</span>);</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span> </div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>  <a class="code hl_class" href="classllvm_1_1legacy_1_1FunctionPassManager.html">legacy::FunctionPassManager</a> FPM(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent());</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a1bec72c759c38b748ff60434eb4d0c80">add</a>(<a class="code hl_function" href="namespacellvm.html#a2ccc7974c411d5dc087a920b621d73b6">createSCCPPass</a>());</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a1bec72c759c38b748ff60434eb4d0c80">add</a>(<a class="code hl_function" href="namespacellvm.html#a3403fbb934119728341c679714eafa1b">createCFGSimplificationPass</a>());</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a1bec72c759c38b748ff60434eb4d0c80">add</a>(<a class="code hl_function" href="namespacellvm.html#ae28159c054fa79ac71652e2bb0972082">createEarlyCSEPass</a>());</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a1bec72c759c38b748ff60434eb4d0c80">add</a>(<a class="code hl_function" href="namespacellvm.html#a3403fbb934119728341c679714eafa1b">createCFGSimplificationPass</a>());</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a7cb64dd75fa1775aeb32cde0bc17b72a">doInitialization</a>();</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#a02e592cc8ca8a049fbe052f809514c73">run</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>  FPM.<a class="code hl_function" href="classllvm_1_1legacy_1_1FunctionPassManager.html#aabcf819b6866d85a9fc8f882ff0e9ead">doFinalization</a>();</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>}</div>
</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span> </div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span><span class="comment">// Assuming we arrived at the block NewBlock from Prev instruction, store</span></div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span><span class="comment">// PHI&#39;s incoming values in the ResolvedValues map.</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00915" data-start="{" data-end="}">
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">  915</a></span><a class="code hl_function" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *Prev, <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewBlock</a>,</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>                          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;Value *, Value *&gt;</a> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>) {</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>  <span class="keyword">auto</span> *PrevBB = Prev-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>();</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1PHINode.html">PHINode</a> &amp;PN : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewBlock</a>-&gt;phis()) {</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>    <span class="keyword">auto</span> V = PN.getIncomingValueForBlock(PrevBB);</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    <span class="comment">// See if we already resolved it.</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>    <span class="keyword">auto</span> VI = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.find(V);</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    <span class="keywordflow">if</span> (VI != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.end())</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>      V = VI-&gt;second;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    <span class="comment">// Remember the value.</span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>[&amp;PN] = V;</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>  }</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>}</div>
</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span> </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span><span class="comment">// Replace a sequence of branches leading to a ret, with a clone of a ret</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span><span class="comment">// instruction. Suspend instruction represented by a switch, track the PHI</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span><span class="comment">// values and select the correct case successor when possible.</span></div>
<div class="foldopen" id="foldopen00932" data-start="{" data-end="}">
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">  932</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a>(<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>) {</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DenseMap&lt;Value *, Value *&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>  <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnconditionalSucc</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>  <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>;</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>  <span class="keywordflow">while</span> (<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;isTerminator() ||</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>         (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;CmpInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode()-&gt;isTerminator())) {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;ReturnInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <span class="comment">// If InitialInst is an unconditional branch,</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>        <span class="comment">// remove PHI values that come from basic block of InitialInst</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnconditionalSucc</a>)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnconditionalSucc</a>-&gt;removePredecessor(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>-&gt;getParent(), <span class="keyword">true</span>);</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <a class="code hl_function" href="namespacellvm.html#aa6aa39b86007ee97f50248d2fb1b7220">ReplaceInstWithInst</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>, <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;clone());</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>      }</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    }</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *BR = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;BranchInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>      <span class="keywordflow">if</span> (BR-&gt;isUnconditional()) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = BR-&gt;getSuccessor(0);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">InitialInst</a>)</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">UnconditionalSucc</a> = BB;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <a class="code hl_function" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BB, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code hl_function" href="classllvm_1_1BasicBlock.html#af892b6cfca15dd251950e0954b828dc2">getFirstNonPHIOrDbgOrLifetime</a>();</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>      }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondCmp</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CmpInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      <span class="keyword">auto</span> *BR = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;BranchInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getNextNode());</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>      <span class="keywordflow">if</span> (BR &amp;&amp; BR-&gt;isConditional() &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondCmp</a> == BR-&gt;getCondition()) {</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        <span class="comment">// If the case number of suspended switch instruction is reduced to</span></div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>        <span class="comment">// 1, then it is simplified to CmpInst in llvm::ConstantFoldTerminator.</span></div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>        <span class="comment">// And the comparsion looks like : %cond = icmp eq i8 %V, constant.</span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        <a class="code hl_class" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondConst</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;ConstantInt&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondCmp</a>-&gt;getOperand(1));</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondConst</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondCmp</a>-&gt;getPredicate() == <a class="code hl_enumvalue" href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP_EQ</a>) {</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>          <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *V = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondCmp</a>-&gt;getOperand(0);</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>          <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.find(V);</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.end())</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>            V = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>-&gt;second;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>          <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cond0</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;ConstantInt&gt;</a>(V)) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cond0</a>-&gt;equalsInt(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CondConst</a>-&gt;getZExtValue())</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>                                 ? BR-&gt;getSuccessor(0)</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                                 : BR-&gt;getSuccessor(1);</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>            <a class="code hl_function" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BB, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>);</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>            <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code hl_function" href="classllvm_1_1BasicBlock.html#af892b6cfca15dd251950e0954b828dc2">getFirstNonPHIOrDbgOrLifetime</a>();</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>          }</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        }</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>      }</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;SwitchInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) {</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>      <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *V = <a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;getCondition();</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>      <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.find(V);</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>.end())</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>        V = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">it</a>-&gt;second;</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *<a class="code hl_variable" href="BBSectionsPrepare_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;ConstantInt&gt;</a>(V)) {</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>        <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *BB = <a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;findCaseValue(<a class="code hl_variable" href="BBSectionsPrepare_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a>)-&gt;getCaseSuccessor();</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>        <a class="code hl_function" href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BB, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResolvedValues</a>);</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>        <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = BB-&gt;<a class="code hl_function" href="classllvm_1_1BasicBlock.html#af892b6cfca15dd251950e0954b828dc2">getFirstNonPHIOrDbgOrLifetime</a>();</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>      }</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    }</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>  }</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>}</div>
</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span> </div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="comment">// Check whether CI obeys the rules of musttail attribute.</span></div>
<div class="foldopen" id="foldopen00999" data-start="{" data-end="}">
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">  999</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a> &amp;CI, <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  <span class="keywordflow">if</span> (CI.<a class="code hl_function" href="classllvm_1_1CallBase.html#a018f0394a375233d538109968b76a05a">isInlineAsm</a>())</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span> </div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>  <span class="comment">// Match prototypes and calling conventions of resume function.</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>  <a class="code hl_class" href="classFunctionType.html">FunctionType</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeTy</a> = CI.<a class="code hl_function" href="classllvm_1_1CallBase.html#ac3c35bd078a268a207f607d0f57dadba">getFunctionType</a>();</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeTy</a>-&gt;getReturnType()-&gt;isVoidTy() || (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeTy</a>-&gt;getNumParams() != 1))</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span> </div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  <a class="code hl_class" href="classllvm_1_1Type.html">Type</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeParmTy</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeTy</a>-&gt;getParamType(0);</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeParmTy</a>-&gt;isPointerTy() ||</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalleeParmTy</a>-&gt;getPointerAddressSpace() != 0))</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span> </div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>  <span class="keywordflow">if</span> (CI.<a class="code hl_function" href="classllvm_1_1CallBase.html#a3ff92cec76009e859cb0c419d6e8ba5f">getCallingConv</a>() != <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getCallingConv())</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span> </div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>  <span class="comment">// CI should not has any ABI-impacting function attributes.</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_enumeration" href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">Attribute::AttrKind</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ABIAttrs</a>[] = {</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>      Attribute::StructRet,    Attribute::ByVal,     Attribute::InAlloca,</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>      Attribute::Preallocated, Attribute::InReg,     Attribute::Returned,</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>      Attribute::SwiftSelf,    Attribute::SwiftError};</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>  <a class="code hl_class" href="classllvm_1_1AttributeList.html">AttributeList</a> Attrs = CI.<a class="code hl_function" href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">getAttributes</a>();</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AK</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ABIAttrs</a>)</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (Attrs.hasParamAttribute(0, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AK</a>))</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>}</div>
</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span> </div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span><span class="comment">// Add musttail to any resume instructions that is immediately followed by a</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span><span class="comment">// suspend (i.e. ret). We do this even in -O0 to support guaranteed tail call</span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span><span class="comment">// for symmetrical coroutine control transfer (C++ Coroutines TS extension).</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span><span class="comment">// This transformation is done only in the resume part of the coroutine that has</span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span><span class="comment">// identical signature and calling convention as the coro.resume call.</span></div>
<div class="foldopen" id="foldopen01034" data-start="{" data-end="}">
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a61bb4a52ef184d616270d2440ae550d4"> 1034</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a61bb4a52ef184d616270d2440ae550d4">addMustTailToCoroResumes</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>  <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">changed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span> </div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>  <span class="comment">// Collect potential resume instructions.</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallInst *, 4&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Resumes</a>;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code hl_variable" href="MustExecute_8cpp.html#a2b8cdcb5ff2dc7197a4e2b5a38c11580">instructions</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *Call = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallInst&gt;</a>(&amp;<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a>(*Call, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Resumes</a>.push_back(Call);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span> </div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>  <span class="comment">// Set musttail on those that are followed by a ret instruction.</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a> *Call : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Resumes</a>)</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a>(Call-&gt;getNextNode())) {</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>      Call-&gt;setTailCallKind(<a class="code hl_enumvalue" href="classllvm_1_1CallInst.html#ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e">CallInst::TCK_MustTail</a>);</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">changed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>    }</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">changed</a>)</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    <a class="code hl_function" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>}</div>
</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="comment">// Coroutine has no suspend points. Remove heap allocation for the coroutine</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span><span class="comment">// frame if possible.</span></div>
<div class="foldopen" id="foldopen01057" data-start="{" data-end="}">
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0"> 1057</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a>(<a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>  <span class="keyword">auto</span> *CoroBegin = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CoroId</a> = CoroBegin-&gt;getId();</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CoroId</a>-&gt;getCoroAlloc();</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>  <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>  <span class="keywordflow">case</span> coro::ABI::Switch: {</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchId</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroIdInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CoroId</a>);</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>    <a class="code hl_function" href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">coro::replaceCoroFree</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SwitchId</a>, <span class="comment">/*Elide=*/</span><a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a>) {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a>);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>      <span class="keyword">auto</span> *Frame = Builder.CreateAlloca(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      Frame-&gt;setAlignment(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">FrameAlign</a>);</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>      <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">VFrame</a> = Builder.CreateBitCast(Frame, Builder.getInt8PtrTy());</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a>-&gt;replaceAllUsesWith(Builder.getFalse());</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">AllocInst</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>      CoroBegin-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">VFrame</a>);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>      CoroBegin-&gt;replaceAllUsesWith(CoroBegin-&gt;getMem());</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    }</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>  }</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>  <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>  <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>    CoroBegin-&gt;replaceAllUsesWith(<a class="code hl_function" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(CoroBegin-&gt;getType()));</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>  }</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span> </div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>  CoroBegin-&gt;eraseFromParent();</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>}</div>
</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span><span class="comment">// SimplifySuspendPoint needs to check that there is no calls between</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">// coro_save and coro_suspend, since any of the calls may potentially resume</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">// the coroutine and if that is the case we cannot eliminate the suspend point.</span></div>
<div class="foldopen" id="foldopen01091" data-start="{" data-end="}">
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74"> 1091</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_variable" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>, <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *To) {</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code hl_variable" href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a>; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != To; <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;<a class="code hl_function" href="classllvm_1_1ilist__node__with__parent.html#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>()) {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    <span class="comment">// Assume that no intrinsic can resume the coroutine.</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;IntrinsicInst&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">isa&lt;CallBase&gt;</a>(<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>  }</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>}</div>
</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span> </div>
<div class="foldopen" id="foldopen01103" data-start="{" data-end="}">
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde"> 1103</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a>(<a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a>, <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResDesBB</a>) {</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallPtrSet&lt;BasicBlock *, 8&gt;</a> Set;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;BasicBlock *, 8&gt;</a> Worklist;</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>  Set.insert(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a>);</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>  Worklist.push_back(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResDesBB</a>);</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span> </div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>  <span class="comment">// Accumulate all blocks between SaveBB and ResDesBB. Because CoroSaveIntr</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>  <span class="comment">// returns a token consumed by suspend instruction, all blocks in between</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>  <span class="comment">// will have to eventually hit SaveBB when going backwards from ResDesBB.</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>  <span class="keywordflow">while</span> (!Worklist.empty()) {</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>    <span class="keyword">auto</span> *BB = Worklist.pop_back_val();</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>    Set.insert(BB);</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Pred : <a class="code hl_function" href="namespacellvm.html#a91d9d210ba428cc67e3c2e892f24529e">predecessors</a>(BB))</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>      <span class="keywordflow">if</span> (Set.count(Pred) == 0)</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>        Worklist.push_back(Pred);</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>  }</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span> </div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>  <span class="comment">// SaveBB and ResDesBB are checked separately in hasCallsBetween.</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>  Set.erase(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a>);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  Set.erase(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResDesBB</a>);</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span> </div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *BB : Set)</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(BB-&gt;getFirstNonPHI(), <span class="keyword">nullptr</span>))</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>}</div>
</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span> </div>
<div class="foldopen" id="foldopen01132" data-start="{" data-end="}">
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63"> 1132</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a>(<a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *Save, <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroy</a>) {</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a> = Save-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>();</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroyBB</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroy</a>-&gt;getParent();</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span> </div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a> == <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroyBB</a>)</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(Save-&gt;<a class="code hl_function" href="classllvm_1_1ilist__node__with__parent.html#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroy</a>);</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  <span class="comment">// Any calls from Save to the end of the block?</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(Save-&gt;<a class="code hl_function" href="classllvm_1_1ilist__node__with__parent.html#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>(), <span class="keyword">nullptr</span>))</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span> </div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>  <span class="comment">// Any calls from begging of the block up to ResumeOrDestroy?</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroyBB</a>-&gt;getFirstNonPHI(),</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>                             <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroy</a>))</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span> </div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  <span class="comment">// Any calls in all of the blocks between SaveBB and ResumeOrDestroyBB?</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SaveBB</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeOrDestroyBB</a>))</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span> </div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>}</div>
</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span><span class="comment">// If a SuspendIntrin is preceded by Resume or Destroy, we can eliminate the</span></div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span><span class="comment">// suspend point and replace it with nornal control flow.</span></div>
<div class="foldopen" id="foldopen01157" data-start="{" data-end="}">
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0"> 1157</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a>(<a class="code hl_class" href="classllvm_1_1CoroSuspendInst.html">CoroSuspendInst</a> *Suspend,</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>                                 <a class="code hl_class" href="classllvm_1_1CoroBeginInst.html">CoroBeginInst</a> *CoroBegin) {</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>  <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *Prev = Suspend-&gt;<a class="code hl_function" href="classllvm_1_1ilist__node__with__parent.html#a1dfdcf6998ec28bfd2f8d2cdebc984a9">getPrevNode</a>();</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>  <span class="keywordflow">if</span> (!Prev) {</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>    <span class="keyword">auto</span> *Pred = Suspend-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">getParent</a>()-&gt;<a class="code hl_function" href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>    <span class="keywordflow">if</span> (!Pred)</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>    Prev = Pred-&gt;getTerminator();</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  }</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>  <a class="code hl_class" href="classllvm_1_1CallBase.html">CallBase</a> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(Prev);</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>  <span class="keywordflow">if</span> (!CB)</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>  <span class="keyword">auto</span> *<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a> = CB-&gt;<a class="code hl_function" href="classllvm_1_1CallBase.html#a8d13199cbf4d080d3b5dcf330dad5d2c">getCalledOperand</a>()-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">stripPointerCasts</a>();</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>  <span class="comment">// See if the callsite is for resumption or destruction of the coroutine.</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CoroSubFnInst&gt;</a>(<a class="code hl_variable" href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a>);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>  <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a>)</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>  <span class="comment">// Does not refer to the current coroutine, we cannot do anything with it.</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a>-&gt;getFrame() != CoroBegin)</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span> </div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>  <span class="comment">// See if the transformation is safe. Specifically, see if there are any</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>  <span class="comment">// calls in between Save and CallInstr. They can potenitally resume the</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>  <span class="comment">// coroutine rendering this optimization unsafe.</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>  <span class="keyword">auto</span> *Save = Suspend-&gt;<a class="code hl_function" href="classllvm_1_1CoroSuspendInst.html#aa359a0b614626b5bfafbc095eef26e04">getCoroSave</a>();</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a>(Save, CB))</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span> </div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>  <span class="comment">// Replace llvm.coro.suspend with the value that results in resumption over</span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>  <span class="comment">// the resume or cleanup path.</span></div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  Suspend-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a>-&gt;getRawIndex());</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>  Suspend-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>  Save-&gt;eraseFromParent();</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span> </div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>  <span class="comment">// No longer need a call to coro.resume or coro.destroy.</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Invoke</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;InvokeInst&gt;</a>(CB)) {</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    <a class="code hl_function" href="classllvm_1_1BranchInst.html#a8072a8e1bd8e8f03b34f9b50830c0e31">BranchInst::Create</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Invoke</a>-&gt;getNormalDest(), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Invoke</a>);</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  }</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>  <span class="comment">// Grab the CalledValue from CB before erasing the CallInstr.</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledValue</a> = CB-&gt;<a class="code hl_function" href="classllvm_1_1CallBase.html#a8d13199cbf4d080d3b5dcf330dad5d2c">getCalledOperand</a>();</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>  CB-&gt;<a class="code hl_function" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span> </div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>  <span class="comment">// If no more users remove it. Usually it is a bitcast of SubFn.</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledValue</a> != <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledValue</a>-&gt;user_empty())</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;Instruction&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CalledValue</a>))</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>      <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>  <span class="comment">// Now we are good to remove SubFn.</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a>-&gt;user_empty())</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SubFn</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>}</div>
</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span> </div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span><span class="comment">// Remove suspend points that are simplified.</span></div>
<div class="foldopen" id="foldopen01217" data-start="{" data-end="}">
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2"> 1217</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a>(<a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape) {</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>  <span class="comment">// Currently, the only simplification we do is switch-lowering-specific.</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> != coro::ABI::Switch)</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span> </div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>  <span class="keyword">auto</span> &amp;S = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>;</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>  <span class="keywordtype">size_t</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> = S.size();</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == 0)</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <span class="keyword">auto</span> <a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroSuspendInst&gt;</a>(S[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>]);</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    <span class="comment">// Leave final.suspend to handleFinalSuspend since it is undefined behavior</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    <span class="comment">// to resume a coroutine suspended at the final suspend point.</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    <span class="keywordflow">if</span> (!<a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>-&gt;isFinal() &amp;&amp; <a class="code hl_function" href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a>(<a class="code hl_enumvalue" href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)) {</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>      <span class="keywordflow">if</span> (--<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> == <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>      <a class="code hl_function" href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(S[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], S[<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>]);</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    }</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    <span class="keywordflow">if</span> (++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> == <a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>)</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>  }</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>  S.resize(<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>}</div>
</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span> </div>
<div class="foldopen" id="foldopen01242" data-start="{" data-end="}">
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab481cb6df9b3f1cdc39ffe0311067195"> 1242</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab481cb6df9b3f1cdc39ffe0311067195">splitSwitchCoroutine</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>                                 <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones) {</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Switch);</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span> </div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape);</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeClone</a> = <a class="code hl_function" href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">createClone</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.resume&quot;</span>, Shape,</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>                                 CoroCloner::Kind::SwitchResume);</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyClone</a> = <a class="code hl_function" href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">createClone</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.destroy&quot;</span>, Shape,</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>                                  CoroCloner::Kind::SwitchUnwind);</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupClone</a> = <a class="code hl_function" href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">createClone</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;.cleanup&quot;</span>, Shape,</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>                                  CoroCloner::Kind::SwitchCleanup);</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span> </div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeClone</a>);</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyClone</a>);</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupClone</a>);</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span> </div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a61bb4a52ef184d616270d2440ae550d4">addMustTailToCoroResumes</a>(*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeClone</a>);</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span> </div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>  <span class="comment">// Store addresses resume/destroy/cleanup functions in the coroutine frame.</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a>(Shape, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeClone</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyClone</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupClone</a>);</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span> </div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.empty());</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>  Clones.push_back(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ResumeClone</a>);</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>  Clones.push_back(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DestroyClone</a>);</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>  Clones.push_back(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CleanupClone</a>);</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span> </div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>  <span class="comment">// Create a constant array referring to resume/destroy/clone functions pointed</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>  <span class="comment">// by the last argument of @llvm.coro.info, so that CoroElide pass can</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>  <span class="comment">// determined correct function to call.</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>}</div>
</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span> </div>
<div class="foldopen" id="foldopen01274" data-start="{" data-end="}">
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c"> 1274</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                                 <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones) {</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::Retcon ||</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>         Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a> == coro::ABI::RetconOnce);</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.empty());</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span> </div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>  <span class="comment">// Reset various things that the optimizer might have decided it</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>  <span class="comment">// &quot;knows&quot; about the coroutine function due to not seeing a return.</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>  <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeFnAttr(Attribute::NoReturn);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>  <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeAttribute(<a class="code hl_enumvalue" href="classllvm_1_1AttributeList.html#af5dcb6d3da4b30a7d21c9fb39bbf1a68a167699508089d6cf7e6afe448d82e6df">AttributeList::ReturnIndex</a>, Attribute::NoAlias);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>  <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeAttribute(<a class="code hl_enumvalue" href="classllvm_1_1AttributeList.html#af5dcb6d3da4b30a7d21c9fb39bbf1a68a167699508089d6cf7e6afe448d82e6df">AttributeList::ReturnIndex</a>, Attribute::NonNull);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span> </div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>  <span class="comment">// Allocate the frame.</span></div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>  <span class="keyword">auto</span> *Id = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;AnyCoroIdRetconInst&gt;</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code hl_function" href="classllvm_1_1CoroBeginInst.html#a30b3ddd0433d254830f61bf122e5eefc">getId</a>());</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>  <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a>;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">IsFrameInlineInStorage</a>) {</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a> = Id-&gt;getStorage();</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(Id);</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span> </div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <span class="comment">// Determine the size of the frame.</span></div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code hl_variable" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.<a class="code hl_function" href="classllvm_1_1MachineBasicBlock.html#acf6442108e21e7e5379feb8962de65b7">getParent</a>()-&gt;<a class="code hl_function" href="classllvm_1_1MachineFunction.html#a82dd10b626a629b9bb7d32d53a8e0884">getDataLayout</a>();</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <span class="keyword">auto</span> <a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a> = <a class="code hl_variable" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeAllocSize(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">FrameTy</a>);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span> </div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>    <span class="comment">// Allocate.  We don&#39;t need to update the call graph node because we&#39;re</span></div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>    <span class="comment">// going to recompute it from scratch after splitting.</span></div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>    <span class="comment">// FIXME: pass the required alignment</span></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a> = Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">emitAlloc</a>(Builder, Builder.getInt64(<a class="code hl_variable" href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a>), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a> =</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>      Builder.CreateBitCast(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a>, Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a0344a49526443edf90cc0aef3abd3337">getType</a>());</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> </div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    <span class="comment">// Stash the allocated frame pointer in the continuation storage.</span></div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>    <span class="keyword">auto</span> Dest = Builder.CreateBitCast(Id-&gt;getStorage(),</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>                                      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a>-&gt;getType()-&gt;getPointerTo());</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>    Builder.CreateStore(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a>, Dest);</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>  }</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>  <span class="comment">// Map all uses of llvm.coro.begin to the allocated frame pointer.</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>  {</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    <span class="comment">// Make sure we don&#39;t invalidate Shape.FramePtr.</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">TrackingVH&lt;Instruction&gt;</a> Handle(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a>);</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>-&gt;<a class="code hl_function" href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RawFramePtr</a>);</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>    Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">FramePtr</a> = Handle.getValPtr();</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>  }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>  <span class="comment">// Create a unique return block.</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  <a class="code hl_class" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;PHINode *, 4&gt;</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span> </div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>  <span class="comment">// Create all the functions in order after the main function.</span></div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NextF</a> = std::next(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getIterator());</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span> </div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>  <span class="comment">// Create a continuation function for each of the suspend points.</span></div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>  Clones.reserve(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a> = 0, e = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a> != e; ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>) {</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    <span class="keyword">auto</span> Suspend = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CoroSuspendRetconInst&gt;</a>(Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>]);</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span> </div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>    <span class="comment">// Create the clone declaration.</span></div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Continuation</a> =</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>      <a class="code hl_function" href="CoroSplit_8cpp.html#a890a9012085abcc24f186c98388e45e5">createCloneDeclaration</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, <span class="stringliteral">&quot;.resume.&quot;</span> + <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>), <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NextF</a>);</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    Clones.push_back(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Continuation</a>);</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span> </div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>    <span class="comment">// Insert a branch to the unified return block immediately before</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>    <span class="comment">// the suspend point.</span></div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a> = Suspend-&gt;getParent();</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewSuspendBB</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>-&gt;splitBasicBlock(Suspend);</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>    <span class="keyword">auto</span> Branch = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;BranchInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>-&gt;getTerminator());</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span> </div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>    <span class="comment">// Create the unified return block.</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a>) {</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>      <span class="comment">// Place it before the first suspend.</span></div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a> = <a class="code hl_function" href="classllvm_1_1BasicBlock.html#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext(), <span class="stringliteral">&quot;coro.return&quot;</span>, &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>                                    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NewSuspendBB</a>);</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>      Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">RetconLowering</a>.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a872685aee4d3b7567d0538ccaa326228">ReturnBlock</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a>;</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span> </div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IRBuilder&lt;&gt;</a> <a class="code hl_variable" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a>);</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span> </div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>      <span class="comment">// Create PHIs for all the return values.</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>      <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.empty());</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>      <span class="comment">// First, the continuation.</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.push_back(Builder.CreatePHI(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Continuation</a>-&gt;getType(),</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>                                             Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size()));</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span> </div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>      <span class="comment">// Next, all the directly-yielded values.</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ResultTy : Shape.<a class="code hl_function" href="structllvm_1_1coro_1_1Shape.html#ac91071b50ec814bdcb75af662c3b8b28">getRetconResultTypes</a>())</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.push_back(Builder.CreatePHI(ResultTy,</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>                                               Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size()));</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span> </div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>      <span class="comment">// Build the return value.</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>      <span class="keyword">auto</span> <a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a> = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getReturnType();</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      <span class="comment">// Cast the continuation value if necessary.</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>      <span class="comment">// We can&#39;t rely on the types matching up because that type would</span></div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      <span class="comment">// have to be infinite.</span></div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>      <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastedContinuationTy</a> =</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.size() == 1 ? <a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a> : <a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a>-&gt;getStructElementType(0));</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>      <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastedContinuation</a> =</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>        Builder.CreateBitCast(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>[0], <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastedContinuationTy</a>);</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span> </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>      <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a>;</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.size() == 1) {</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastedContinuation</a>;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a> = <a class="code hl_function" href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(<a class="code hl_variable" href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a>);</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>        <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a> = Builder.CreateInsertValue(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastedContinuation</a>, 0);</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1, <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.size(); <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code hl_variable" href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a>; ++<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a> = Builder.CreateInsertValue(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>[<a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>], <a class="code hl_define" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>      }</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span> </div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      Builder.CreateRet(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">RetV</a>);</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>    }</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span> </div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>    <span class="comment">// Branch to the return block.</span></div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>    Branch-&gt;setSuccessor(0, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnBB</a>);</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>[0]-&gt;addIncoming(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Continuation</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>);</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>    <span class="keywordtype">size_t</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NextPHIIndex</a> = 1;</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">VUse</a> : Suspend-&gt;value_operands())</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NextPHIIndex</a>++]-&gt;addIncoming(&amp;*<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">VUse</a>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SuspendBB</a>);</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>    <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">NextPHIIndex</a> == <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ReturnPHIs</a>.size());</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>  }</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span> </div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Clones.size() == Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size());</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a> = 0, e = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.size(); <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a> != e; ++<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>) {</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>    <span class="keyword">auto</span> Suspend = Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>];</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>    <span class="keyword">auto</span> Clone = Clones[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>];</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span> </div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>    CoroCloner(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="stringliteral">&quot;resume.&quot;</span> + <a class="code hl_class" href="classllvm_1_1Twine.html">Twine</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">i</a>), Shape, Clone, Suspend).create();</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>  }</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>}</div>
</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span> </div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>  <span class="keyword">class </span>PrettyStackTraceFunction : <span class="keyword">public</span> <a class="code hl_class" href="classllvm_1_1PrettyStackTraceEntry.html">PrettyStackTraceEntry</a> {</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>    PrettyStackTraceFunction(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) : <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {}</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a class="code hl_class" href="classllvm_1_1raw__ostream.html">raw_ostream</a> &amp;OS)<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>      OS &lt;&lt; <span class="stringliteral">&quot;While splitting coroutine &quot;</span>;</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>      <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.printAsOperand(OS, <span class="comment">/*print type*/</span> <span class="keyword">false</span>, <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent());</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>      OS &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>    }</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>  };</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>}</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="foldopen" id="foldopen01418" data-start="{" data-end="}">
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#abf6fd4d7d6bc12f868a22eff33fbad53"> 1418</a></span><span class="keyword">static</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> <a class="code hl_function" href="CoroSplit_8cpp.html#abf6fd4d7d6bc12f868a22eff33fbad53">splitCoroutine</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>                                  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones) {</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>  PrettyStackTraceFunction <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">prettyStackTrace</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span> </div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>  <span class="comment">// The suspend-crossing algorithm in buildCoroutineFrame get tripped</span></div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>  <span class="comment">// up by uses in unreachable blocks, so remove them as a first pass.</span></div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>  <a class="code hl_function" href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">removeUnreachableBlocks</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span> </div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>  <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> Shape(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>  <span class="keywordflow">if</span> (!Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    <span class="keywordflow">return</span> Shape;</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a>(Shape);</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>  buildCoroutineFrame(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape);</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a2cbc874ec5612ccb47cad7f07ff51f94">replaceFrameSize</a>(Shape);</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span> </div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>  <span class="comment">// If there are no suspend points, no split required, just remove</span></div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>  <span class="comment">// the allocation and deallocation blocks, they are not needed.</span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>  <span class="keywordflow">if</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">CoroSuspends</a>.empty()) {</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a>(Shape);</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>    <span class="keywordflow">switch</span> (Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">ABI</a>) {</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>    <span class="keywordflow">case</span> coro::ABI::Switch:</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>      <a class="code hl_function" href="CoroSplit_8cpp.html#ab481cb6df9b3f1cdc39ffe0311067195">splitSwitchCoroutine</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>    <span class="keywordflow">case</span> coro::ABI::Retcon:</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>    <span class="keywordflow">case</span> coro::ABI::RetconOnce:</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>      <a class="code hl_function" href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones);</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>    }</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>  }</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span> </div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>  <span class="comment">// Replace all the swifterror operations in the original function.</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>  <span class="comment">// This invalidates SwiftErrorOps in the Shape.</span></div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span> </div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>  <span class="keywordflow">return</span> Shape;</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>}</div>
</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span> </div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01458" data-start="{" data-end="}">
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864"> 1458</a></span><a class="code hl_function" href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864">updateCallGraphAfterCoroutineSplit</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>                                   <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones,</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>                                   <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, <a class="code hl_class" href="classllvm_1_1CallGraphSCC.html">CallGraphSCC</a> &amp;SCC) {</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>  <span class="keywordflow">if</span> (!Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span> </div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#a3296d9f25bb33fa463f2e24c1c5cf3da">removeCoroEnds</a>(Shape, &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span> </div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>  <span class="comment">// Update call graph and add the functions we created to the SCC.</span></div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>  <a class="code hl_function" href="namespacellvm_1_1coro.html#aa5afa83874bf2b24b54fc07894df1add">coro::updateCallGraph</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Clones, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, SCC);</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>}</div>
</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span> </div>
<div class="foldopen" id="foldopen01471" data-start="{" data-end="}">
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a71999132e148b3feb5a3fc97031a0692"> 1471</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864">updateCallGraphAfterCoroutineSplit</a>(</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>    <a class="code hl_class" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> &amp;Shape,</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>    <span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVectorImpl&lt;Function *&gt;</a> &amp;Clones, <a class="code hl_class" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>,</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>    <a class="code hl_class" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">CGSCCAnalysisManager</a> &amp;AM, <a class="code hl_struct" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR,</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>    <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">FunctionAnalysisManager</a> &amp;FAM) {</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>  <span class="keywordflow">if</span> (!Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">CoroBegin</a>)</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span> </div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CoroEndInst.html">llvm::CoroEndInst</a> *End : Shape.<a class="code hl_variable" href="structllvm_1_1coro_1_1Shape.html#a7be03390074e7829c25074165141a797">CoroEnds</a>) {</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>    <span class="keyword">auto</span> &amp;Context = End-&gt;getContext();</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>    End-&gt;replaceAllUsesWith(<a class="code hl_function" href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(Context));</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>    End-&gt;eraseFromParent();</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>  }</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span> </div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>  <a class="code hl_function" href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a>(<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction());</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>  <span class="comment">// To insert the newly created coroutine funclets &#39;f.resume&#39;, &#39;f.destroy&#39;, and</span></div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>  <span class="comment">// &#39;f.cleanup&#39; into the same SCC as the coroutine &#39;f&#39; they were outlined from,</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>  <span class="comment">// we make use of the CallGraphUpdater class, which can modify the internal</span></div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>  <span class="comment">// state of the LazyCallGraph.</span></div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *Clone : Clones)</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>    <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>.addNewFunctionIntoRefSCC(*Clone, <a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>.getOuterRefSCC());</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span> </div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>  <span class="comment">// We&#39;ve inserted instructions into coroutine &#39;f&#39; that reference the three new</span></div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>  <span class="comment">// coroutine funclets. We must now update the call graph so that reference</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>  <span class="comment">// edges between &#39;f&#39; and its funclets are added to it. LazyCallGraph only</span></div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>  <span class="comment">// allows CGSCC passes to insert &quot;trivial&quot; reference edges. We&#39;ve ensured</span></div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>  <span class="comment">// above, by inserting the funclets into the same SCC as the corutine, that</span></div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>  <span class="comment">// the edges are trivial.</span></div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>  <span class="comment">//</span></div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>  <span class="comment">// N.B.: If we didn&#39;t update the call graph here, a CGSCCToFunctionPassAdaptor</span></div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>  <span class="comment">// later in this CGSCC pass pipeline may be run, triggering a call graph</span></div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>  <span class="comment">// update of its own. Function passes run by the adaptor are not permitted to</span></div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>  <span class="comment">// add new edges of any kind to the graph, and the new edges inserted by this</span></div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>  <span class="comment">// pass would be misattributed to that unrelated function pass.</span></div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>  <a class="code hl_function" href="namespacellvm.html#a2e739fb4907159062aacbbafea669592">updateCGAndAnalysisManagerForCGSCCPass</a>(<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, <a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, AM, UR, FAM);</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>}</div>
</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span> </div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span><span class="comment">// When we see the coroutine the first time, we insert an indirect call to a</span></div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span><span class="comment">// devirt trigger function and mark the coroutine that it is now ready for</span></div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span><span class="comment">// split.</span></div>
<div class="foldopen" id="foldopen01512" data-start="{" data-end="}">
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#aa2a5070972b7da6066e2f1d49360c983"> 1512</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#aa2a5070972b7da6066e2f1d49360c983">prepareForSplit</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M = *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getParent();</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>  <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Context = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getContext();</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a> = M.getFunction(<a class="code hl_define" href="CoroInternal_8h.html#ac7fb164db65d90f230af6e90dad14353">CORO_DEVIRT_TRIGGER_FN</a>);</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>  <a class="code hl_function" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a> &amp;&amp; <span class="stringliteral">&quot;coro.devirt.trigger function not found&quot;</span>);</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span> </div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>  <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.addFnAttr(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>, <a class="code hl_define" href="CoroInternal_8h.html#aac2a1a4f2fcee7d92a68536873797e9a">PREPARED_FOR_SPLIT</a>);</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span> </div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>  <span class="comment">// Insert an indirect call sequence that will be devirtualized by CoroElide</span></div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>  <span class="comment">// pass:</span></div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>  <span class="comment">//    %0 = call i8* @llvm.coro.subfn.addr(i8* null, i8 -1)</span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>  <span class="comment">//    %1 = bitcast i8* %0 to void(i8*)*</span></div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>  <span class="comment">//    call void %1(i8* null)</span></div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>  <a class="code hl_struct" href="structllvm_1_1coro_1_1LowererBase.html">coro::LowererBase</a> Lowerer(M);</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>  <a class="code hl_class" href="classllvm_1_1Instruction.html">Instruction</a> *InsertPt = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().getTerminator();</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>  <span class="keyword">auto</span> *Null = <a class="code hl_function" href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(Type::getInt8PtrTy(Context));</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFnAddr</a> =</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>      Lowerer.makeSubFnCall(Null, <a class="code hl_enumvalue" href="classllvm_1_1CoroSubFnInst.html#abb112419696544e53611285949f18783a3863ef6dc67cdba9c44c42a15c51e786">CoroSubFnInst::RestartTrigger</a>, InsertPt);</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>  <a class="code hl_class" href="classFunctionType.html">FunctionType</a> *FnTy = FunctionType::get(Type::getVoidTy(Context),</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>                                         {Type::getInt8PtrTy(Context)}, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IndirectCall</a> = <a class="code hl_function" href="classllvm_1_1CallInst.html#aeeed015ff391a8b170e446a05618f59d">CallInst::Create</a>(FnTy, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFnAddr</a>, Null, <span class="stringliteral">&quot;&quot;</span>, InsertPt);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span> </div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>  <span class="comment">// Update CG graph with an indirect call we just added.</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>  <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>[&amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>]-&gt;addCalledFunction(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">IndirectCall</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>.getCallsExternalNode());</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>}</div>
</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span> </div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span><span class="comment">// Make sure that there is a devirtualization trigger function that the</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span><span class="comment">// coro-split pass uses to force a restart of the CGSCC pipeline. If the devirt</span></div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span><span class="comment">// trigger function is not found, we will create one and add it to the current</span></div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span><span class="comment">// SCC.</span></div>
<div class="foldopen" id="foldopen01544" data-start="{" data-end="}">
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a41861a50c3f91a35e7f25434d07ccd58"> 1544</a></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a41861a50c3f91a35e7f25434d07ccd58">createDevirtTriggerFunc</a>(<a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, <a class="code hl_class" href="classllvm_1_1CallGraphSCC.html">CallGraphSCC</a> &amp;SCC) {</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M = <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>.getModule();</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>  <span class="keywordflow">if</span> (M.getFunction(<a class="code hl_define" href="CoroInternal_8h.html#ac7fb164db65d90f230af6e90dad14353">CORO_DEVIRT_TRIGGER_FN</a>))</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>  <a class="code hl_class" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a> = M.getContext();</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>  <span class="keyword">auto</span> *FnTy = FunctionType::get(Type::getVoidTy(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>), Type::getInt8PtrTy(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>),</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>                                 <span class="comment">/*isVarArg=*/</span><span class="keyword">false</span>);</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>  <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a> =</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>      <a class="code hl_function" href="classllvm_1_1Function.html#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FnTy, GlobalValue::LinkageTypes::PrivateLinkage,</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>                       <a class="code hl_define" href="CoroInternal_8h.html#ac7fb164db65d90f230af6e90dad14353">CORO_DEVIRT_TRIGGER_FN</a>, &amp;M);</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a>-&gt;addFnAttr(Attribute::AlwaysInline);</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>  <span class="keyword">auto</span> *Entry = <a class="code hl_function" href="classllvm_1_1BasicBlock.html#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <span class="stringliteral">&quot;entry&quot;</span>, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a>);</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>  <a class="code hl_function" href="classllvm_1_1ReturnInst.html#ae4f6f04648c60d8e135a2a740a2eb0e1">ReturnInst::Create</a>(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, Entry);</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span> </div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>  <span class="keyword">auto</span> *<a class="code hl_class" href="classNode.html">Node</a> = <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>.getOrInsertFunction(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">DevirtFn</a>);</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span> </div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;CallGraphNode *, 8&gt;</a> Nodes(SCC.<a class="code hl_function" href="classllvm_1_1CallGraphSCC.html#abc1462ee74423b01bf6afa30d85cca9e">begin</a>(), SCC.<a class="code hl_function" href="classllvm_1_1CallGraphSCC.html#aebb35c664157dd1a6c8b58e715498015">end</a>());</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>  Nodes.push_back(<a class="code hl_class" href="classNode.html">Node</a>);</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>  SCC.<a class="code hl_function" href="classllvm_1_1CallGraphSCC.html#a87e1b8515d22eb833375761e19a2d0fe">initialize</a>(Nodes);</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>}</div>
</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span><span class="comment"></span> </div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span><span class="comment">/// Replace a call to llvm.coro.prepare.retcon.</span></div>
<div class="foldopen" id="foldopen01567" data-start="{" data-end="}">
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ab8e976512a25b571502b4ede569f7759"> 1567</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="CoroSplit_8cpp.html#ab8e976512a25b571502b4ede569f7759">replacePrepare</a>(<a class="code hl_class" href="classllvm_1_1CallInst.html">CallInst</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>  <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastFn</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;getArgOperand(0); <span class="comment">// as an i8*</span></div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>  <span class="keyword">auto</span> Fn = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastFn</a>-&gt;stripPointerCasts(); <span class="comment">// as its original type</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span> </div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>  <span class="comment">// Find call graph nodes for the preparation.</span></div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>  <a class="code hl_class" href="classllvm_1_1CallGraphNode.html">CallGraphNode</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareUserNode</a> = <span class="keyword">nullptr</span>, *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FnNode</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ConcreteFn</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;Function&gt;</a>(Fn)) {</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareUserNode</a> = <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;getFunction()];</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FnNode</a> = <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>[<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">ConcreteFn</a>];</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>  }</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span> </div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>  <span class="comment">// Attempt to peephole this pattern:</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>  <span class="comment">//    %0 = bitcast [[TYPE]] @some_function to i8*</span></div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>  <span class="comment">//    %1 = call @llvm.coro.prepare.retcon(i8* %0)</span></div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>  <span class="comment">//    %2 = bitcast %1 to [[TYPE]]</span></div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>  <span class="comment">// ==&gt;</span></div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>  <span class="comment">//    %2 = @some_function</span></div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> UI = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;use_begin(), UE = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;use_end();</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>         UI != UE; ) {</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>    <span class="comment">// Look for bitcasts back to the original function type.</span></div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;BitCastInst&gt;</a>((UI++)-&gt;getUser());</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a> || <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;getType() != Fn-&gt;getType()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span> </div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>    <span class="comment">// Check whether the replacement will introduce new direct calls.</span></div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>    <span class="comment">// If so, we&#39;ll need to update the call graph.</span></div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareUserNode</a>) {</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_class" href="classllvm_1_1Use.html">Use</a> : <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;uses()) {</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span> *CB = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;CallBase&gt;</a>(<a class="code hl_class" href="classllvm_1_1Use.html">Use</a>.<a class="code hl_function" href="classllvm_1_1Use.html#a53a48d67682705c5f7f06ffc850fd622">getUser</a>())) {</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>          <span class="keywordflow">if</span> (!CB-&gt;isCallee(&amp;<a class="code hl_class" href="classllvm_1_1Use.html">Use</a>))</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareUserNode</a>-&gt;removeCallEdgeFor(*CB);</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>          <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareUserNode</a>-&gt;addCalledFunction(CB, <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">FnNode</a>);</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>        }</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>      }</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>    }</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span> </div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>    <span class="comment">// Replace and remove the cast.</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;replaceAllUsesWith(Fn);</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>  }</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span> </div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>  <span class="comment">// Replace any remaining uses with the function as an i8*.</span></div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>  <span class="comment">// This can never directly be a callee, so we don&#39;t need to update CG.</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;replaceAllUsesWith(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastFn</a>);</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span> </div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>  <span class="comment">// Kill dead bitcasts.</span></div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>  <span class="keywordflow">while</span> (<span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">dyn_cast&lt;BitCastInst&gt;</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastFn</a>)) {</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>    <span class="keywordflow">if</span> (!<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;use_empty()) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CastFn</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;getOperand(0);</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Cast</a>-&gt;eraseFromParent();</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>  }</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>}</div>
</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span><span class="comment"></span> </div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a568f845d9384bdd93d899abb74078757"> 1621</a></span><span class="comment">/// Remove calls to llvm.coro.prepare.retcon, a barrier meant to prevent</span></div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span><span class="comment">/// IPO from operating on calls to a retcon coroutine before it&#39;s been</span></div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span><span class="comment">/// split.  This is only safe to do after we&#39;ve split all retcon</span></div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span><span class="comment">/// coroutines in the module.  We can do that this in this pass because</span></div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a28f0d24943ee2e003355337a8674fdaa"> 1625</a></span><span class="comment">/// this pass does promise to split all retcon coroutines (as opposed to</span></div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span><span class="comment">/// switch coroutines, which are lowered in multiple stages).</span></div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6"> 1627</a></span><span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceAllPrepares</a>(<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>, <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>) {</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">false</span>;</div>
<div class="foldopen" id="foldopen01629" data-start="{" data-end="}">
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ae19b8744dea34cb263595140896a6dd6"> 1629</a></span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> PI = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>-&gt;use_begin(), PE = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>-&gt;use_end();</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>         PI != PE; ) {</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>    <span class="comment">// Intrinsics can only be used in calls.</span></div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>    <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">cast&lt;CallInst&gt;</a>((PI++)-&gt;getUser());</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#ab8e976512a25b571502b4ede569f7759">replacePrepare</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">Prepare</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>    <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>  }</div>
</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span> </div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3"> 1637</a></span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a>;</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>}</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span> </div>
<div class="foldopen" id="foldopen01640" data-start="{" data-end="}">
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a318ad24f290024cedc74e23f0eb09f4f"> 1640</a></span><span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="CoroSplit_8cpp.html#a318ad24f290024cedc74e23f0eb09f4f">declaresCoroSplitIntrinsics</a>(<span class="keyword">const</span> <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M) {</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespacellvm_1_1coro.html#a6e95f844cc43fa4786df11ea5a1a3f10">coro::declaresIntrinsics</a>(</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>      M, {<span class="stringliteral">&quot;llvm.coro.begin&quot;</span>, <span class="stringliteral">&quot;llvm.coro.prepare.retcon&quot;</span>});</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>}</div>
</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span> </div>
<div class="foldopen" id="foldopen01645" data-start="{" data-end="}">
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"><a class="line" href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2"> 1645</a></span><a class="code hl_class" href="classllvm_1_1PreservedAnalyses.html">PreservedAnalyses</a> <a class="code hl_function" href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2">CoroSplitPass::run</a>(<a class="code hl_class" href="classllvm_1_1LazyCallGraph_1_1SCC.html">LazyCallGraph::SCC</a> &amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>,</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>                                     <a class="code hl_class" href="classllvm_1_1AnalysisManager.html">CGSCCAnalysisManager</a> &amp;AM,</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>                                     <a class="code hl_class" href="classllvm_1_1LazyCallGraph.html">LazyCallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, <a class="code hl_struct" href="structllvm_1_1CGSCCUpdateResult.html">CGSCCUpdateResult</a> &amp;UR) {</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>  <span class="comment">// NB: One invariant of a valid LazyCallGraph::SCC is that it must contain a</span></div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>  <span class="comment">//     non-zero number of nodes, so we assume that here and grab the first</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>  <span class="comment">//     node&#39;s function&#39;s module.</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>  <a class="code hl_class" href="classllvm_1_1Module.html">Module</a> &amp;M = *<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>.begin()-&gt;getFunction().getParent();</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>  <span class="keyword">auto</span> &amp;FAM =</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>      AM.<a class="code hl_function" href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a class="code hl_class" href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">FunctionAnalysisManagerCGSCCProxy</a>&gt;(<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>).getManager();</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span> </div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="CoroSplit_8cpp.html#a318ad24f290024cedc74e23f0eb09f4f">declaresCoroSplitIntrinsics</a>(M))</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span> </div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>  <span class="comment">// Check for uses of llvm.coro.prepare.retcon.</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>  <span class="keyword">const</span> <span class="keyword">auto</span> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> = M.getFunction(<span class="stringliteral">&quot;llvm.coro.prepare.retcon&quot;</span>);</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>-&gt;use_empty())</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span> </div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>  <span class="comment">// Find coroutines for processing.</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>  <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;LazyCallGraph::Node *, 4&gt;</a> Coroutines;</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> &amp;<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : <a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>)</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>.getFunction().hasFnAttribute(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>))</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>      Coroutines.push_back(&amp;<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span> </div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>  <span class="keywordflow">if</span> (Coroutines.empty() &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>)</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span> </div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>  <span class="keywordflow">if</span> (Coroutines.empty())</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>    <a class="code hl_define" href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;new pass manager cannot yet handle &quot;</span></div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>                     <span class="stringliteral">&quot;&#39;llvm.coro.prepare.retcon&#39;&quot;</span>);</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span> </div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>  <span class="comment">// Split all the coroutines.</span></div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>  <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1LazyCallGraph_1_1Node.html">LazyCallGraph::Node</a> *<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a> : Coroutines) {</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>    <a class="code hl_class" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;<a class="code hl_function" href="classllvm_1_1Function.html#a8743c58384e11cb6228f6f871304ad35">getFunction</a>();</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>    <a class="code hl_class" href="classllvm_1_1Attribute.html">Attribute</a> Attr = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getFnAttribute(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>);</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>    <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> = Attr.<a class="code hl_function" href="classllvm_1_1Attribute.html#a968930aea9d9efa8d46dd890fce75643">getValueAsString</a>();</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>    <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CoroSplit: Processing coroutine &#39;&quot;</span> &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getName()</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>                      &lt;&lt; <span class="stringliteral">&quot;&#39; state: &quot;</span> &lt;&lt; <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1Value.html">Value</a> == <a class="code hl_define" href="CoroInternal_8h.html#abb844f7b98ab7919d21939da9c945460">UNPREPARED_FOR_SPLIT</a>) {</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>      <span class="comment">// Enqueue a second iteration of the CGSCC pipeline.</span></div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>      <span class="comment">// N.B.:</span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>      <span class="comment">// The CoroSplitLegacy pass &quot;triggers&quot; a restart of the CGSCC pass</span></div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>      <span class="comment">// pipeline by inserting an indirect function call that the</span></div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>      <span class="comment">// CoroElideLegacy pass then replaces with a direct function call. The</span></div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>      <span class="comment">// legacy CGSCC pipeline&#39;s implicit behavior was as if wrapped in the new</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>      <span class="comment">// pass manager abstraction DevirtSCCRepeatedPass.</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      <span class="comment">//</span></div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      <span class="comment">// This pass does not need to &quot;trigger&quot; another run of the pipeline.</span></div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>      <span class="comment">// Instead, it simply enqueues the same RefSCC onto the pipeline&#39;s</span></div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>      <span class="comment">// worklist.</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>      UR.<a class="code hl_variable" href="structllvm_1_1CGSCCUpdateResult.html#a277c9d45b3b20308e166249fd56598ed">CWorklist</a>.insert(&amp;<a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>);</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.addFnAttr(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>, <a class="code hl_define" href="CoroInternal_8h.html#aac2a1a4f2fcee7d92a68536873797e9a">PREPARED_FOR_SPLIT</a>);</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>    }</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>    <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.removeFnAttr(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>);</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span> </div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;Function *, 4&gt;</a> Clones;</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> Shape = <a class="code hl_function" href="CoroSplit_8cpp.html#abf6fd4d7d6bc12f868a22eff33fbad53">splitCoroutine</a>(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Clones);</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864">updateCallGraphAfterCoroutineSplit</a>(*<a class="code hl_define" href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a>, Shape, Clones, <a class="code hl_variable" href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, AM, UR, FAM);</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>  }</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span> </div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>  <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>)</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>    <a class="code hl_define" href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;new pass manager cannot yet handle &quot;</span></div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>                     <span class="stringliteral">&quot;&#39;llvm.coro.prepare.retcon&#39;&quot;</span>);</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">PreservedAnalyses::none</a>();</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>}</div>
</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span> </div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span> </div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span><span class="comment">// We present a coroutine to LLVM as an ordinary function with suspension</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span><span class="comment">// points marked up with intrinsics. We let the optimizer party on the coroutine</span></div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span><span class="comment">// as a single function for as long as possible. Shortly before the coroutine is</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="comment">// eligible to be inlined into its callers, we split up the coroutine into parts</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span><span class="comment">// corresponding to initial, resume and destroy invocations of the coroutine,</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span><span class="comment">// add them to the current SCC and restart the IPO pipeline to optimize the</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span><span class="comment">// coroutine subfunctions we extracted before proceeding to the caller of the</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span><span class="comment">// coroutine.</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span><span class="keyword">struct </span>CoroSplitLegacy : <span class="keyword">public</span> <a class="code hl_class" href="classllvm_1_1CallGraphSCCPass.html">CallGraphSCCPass</a> {</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>  <span class="keyword">static</span> <span class="keywordtype">char</span> ID; <span class="comment">// Pass identification, replacement for typeid</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span> </div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>  CoroSplitLegacy() : <a class="code hl_class" href="classllvm_1_1CallGraphSCCPass.html">CallGraphSCCPass</a>(ID) {</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>    <a class="code hl_function" href="namespacellvm.html#a8159450ad7c9465105524275ca0d09e6">initializeCoroSplitLegacyPass</a>(*<a class="code hl_function" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>  }</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span> </div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>  <span class="keywordtype">bool</span> Run = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span> </div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>  <span class="comment">// A coroutine is identified by the presence of coro.begin intrinsic, if</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>  <span class="comment">// we don&#39;t have any, this pass has nothing to do.</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>  <span class="keywordtype">bool</span> doInitialization(<a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>    Run = <a class="code hl_function" href="CoroSplit_8cpp.html#a318ad24f290024cedc74e23f0eb09f4f">declaresCoroSplitIntrinsics</a>(<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>.getModule());</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classllvm_1_1CallGraphSCCPass.html#ad789278ad915ddf3e6d75eb29066f0b3">CallGraphSCCPass::doInitialization</a>(<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>  }</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span> </div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>  <span class="keywordtype">bool</span> runOnSCC(<a class="code hl_class" href="classllvm_1_1CallGraphSCC.html">CallGraphSCC</a> &amp;SCC)<span class="keyword"> override </span>{</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>    <span class="keywordflow">if</span> (!Run)</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span> </div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>    <span class="comment">// Check for uses of llvm.coro.prepare.retcon.</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>    <span class="keyword">auto</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> =</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>      SCC.<a class="code hl_function" href="classllvm_1_1CallGraphSCC.html#a3ac41a0c13e49229773f3f0084e8de9d">getCallGraph</a>().<a class="code hl_function" href="classllvm_1_1CallGraph.html#ac6148a4c6df56af41c63c0c3a798c447">getModule</a>().<a class="code hl_function" href="classllvm_1_1Module.html#a209a615a3a32241323420cca24b5520a">getFunction</a>(<span class="stringliteral">&quot;llvm.coro.prepare.retcon&quot;</span>);</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> &amp;&amp; <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>-&gt;use_empty())</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>    <span class="comment">// Find coroutines for processing.</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>    <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;Function *, 4&gt;</a> Coroutines;</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1CallGraphNode.html">CallGraphNode</a> *<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGN</a> : SCC)</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>      <a class="code hl_function" href="AArch64AdvSIMDScalarPass_8cpp.html#afb944a33b354e4709fb99864f82b9c16">if</a> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">auto</a> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">CGN</a>-&gt;<a class="code hl_function" href="Evaluator_8cpp.html#a92efb02157b6836e1232c577d34678d6">getFunction</a>())</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>        <a class="code hl_function" href="AArch64AdvSIMDScalarPass_8cpp.html#afb944a33b354e4709fb99864f82b9c16">if</a> (<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasFnAttribute(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>))</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>          Coroutines.push_back(<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span> </div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>    <span class="keywordflow">if</span> (Coroutines.empty() &amp;&amp; !<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>)</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span> </div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>    <a class="code hl_class" href="classllvm_1_1CallGraph.html">CallGraph</a> &amp;<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a> = <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">getAnalysis&lt;CallGraphWrapperPass&gt;</a>().getCallGraph();</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span> </div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>    <span class="keywordflow">if</span> (Coroutines.empty())</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>      <span class="keywordflow">return</span> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceAllPrepares</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span> </div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>    <a class="code hl_function" href="CoroSplit_8cpp.html#a41861a50c3f91a35e7f25434d07ccd58">createDevirtTriggerFunc</a>(<a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, SCC);</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>    <span class="comment">// Split all the coroutines.</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>    <span class="keywordflow">for</span> (<a class="code hl_class" href="classllvm_1_1Function.html">Function</a> *<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : Coroutines) {</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>      <a class="code hl_class" href="classllvm_1_1Attribute.html">Attribute</a> Attr = <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getFnAttribute(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>);</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>      <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> = Attr.<a class="code hl_function" href="classllvm_1_1Attribute.html#a968930aea9d9efa8d46dd890fce75643">getValueAsString</a>();</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>      <a class="code hl_define" href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a>(<a class="code hl_function" href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <span class="stringliteral">&quot;CoroSplit: Processing coroutine &#39;&quot;</span> &lt;&lt; <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName()</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>                        &lt;&lt; <span class="stringliteral">&quot;&#39; state: &quot;</span> &lt;&lt; <a class="code hl_class" href="classllvm_1_1Value.html">Value</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1Value.html">Value</a> == <a class="code hl_define" href="CoroInternal_8h.html#abb844f7b98ab7919d21939da9c945460">UNPREPARED_FOR_SPLIT</a>) {</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>        <a class="code hl_function" href="CoroSplit_8cpp.html#aa2a5070972b7da6066e2f1d49360c983">prepareForSplit</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>      }</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>      <a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;removeFnAttr(<a class="code hl_define" href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a>);</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">SmallVector&lt;Function *, 4&gt;</a> Clones;</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>      <span class="keyword">const</span> <a class="code hl_struct" href="structllvm_1_1coro_1_1Shape.html">coro::Shape</a> Shape = <a class="code hl_function" href="CoroSplit_8cpp.html#abf6fd4d7d6bc12f868a22eff33fbad53">splitCoroutine</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Clones);</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      <a class="code hl_function" href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864">updateCallGraphAfterCoroutineSplit</a>(*<a class="code hl_define" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Shape, Clones, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>, SCC);</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>    }</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span> </div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>)</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>      <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">replaceAllPrepares</a>(<a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">PrepareFn</a>, <a class="code hl_variable" href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a>);</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span> </div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>  }</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code hl_class" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>    <a class="code hl_function" href="classllvm_1_1CallGraphSCCPass.html#a6cc67c5a27b53bc940d292c0aeb6aba3">CallGraphSCCPass::getAnalysisUsage</a>(AU);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>  }</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span> </div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>  <a class="code hl_class" href="classllvm_1_1StringRef.html">StringRef</a> getPassName()<span class="keyword"> const override </span>{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;Coroutine Splitting&quot;</span>; }</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>};</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>} <span class="comment">// end anonymous namespace</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><span class="keywordtype">char</span> CoroSplitLegacy::ID = 0;</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span> </div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a345f56a1fe1b83c5f6b9bb01eecd37b4"> 1800</a></span><a class="code hl_define" href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a>(</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>    CoroSplitLegacy, <span class="stringliteral">&quot;coro-split&quot;</span>,</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <span class="stringliteral">&quot;Split coroutine into a set of functions driving its state machine&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>    <span class="keyword">false</span>)</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><a class="code hl_define" href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code hl_class" href="classllvm_1_1CallGraphWrapperPass.html">CallGraphWrapperPass</a>)</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><a class="code hl_define" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#a6a5f2cd728870f22736c763bbca4c366"> 1806</a></span>    CoroSplitLegacy, &quot;coro-<a class="code hl_variable" href="CoroSplit_8cpp.html#a6a5f2cd728870f22736c763bbca4c366">split</a>&quot;,</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"><a class="line" href="CoroSplit_8cpp.html#ae1453b849971964d98281a94307d1e05"> 1807</a></span>    &quot;Split <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">coroutine</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">into</a> a set <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">of</a> <a class="code hl_variable" href="AMDGPUPropagateAttributes_8cpp.html#a89aee22a588785ca0c0755b95871b79e">functions</a> <a class="code hl_class" href="classllvm_1_1ilist__node__impl.html">driving</a> its state <a class="code hl_variable" href="CoroSplit_8cpp.html#aae6ba3400a4a2f4de9f2f3091fc6bbe9">machine</a>&quot;, <a class="code hl_namespace" href="namespacefalse.html">false</a>,</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>    <a class="code hl_namespace" href="namespacefalse.html">false</a>)</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span> </div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"><a class="line" href="namespacellvm.html#a10388349dcc2684049303ffe10e271af"> 1810</a></span><a class="code hl_class" href="classllvm_1_1Pass.html">Pass</a> *<a class="code hl_namespace" href="namespacellvm.html">llvm</a>::<a class="code hl_function" href="namespacellvm.html#a10388349dcc2684049303ffe10e271af">createCoroSplitLegacyPass</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> CoroSplitLegacy(); }</div>
<div class="ttc" id="aAArch64AdvSIMDScalarPass_8cpp_html_afb944a33b354e4709fb99864f82b9c16"><div class="ttname"><a href="AArch64AdvSIMDScalarPass_8cpp.html#afb944a33b354e4709fb99864f82b9c16">if</a></div><div class="ttdeci">if(Register::isVirtualRegister(Reg)) return MRI -&gt; getRegClass(Reg) -&gt;hasSuperClassEq(&amp;AArch64::GPR64RegClass)</div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_a537c835c34f0b44b6ad2696643754390"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#a537c835c34f0b44b6ad2696643754390">Callee</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Callee</div><div class="ttdef"><b>Definition</b> <a href="AMDGPULibCalls_8cpp_source.html#l00220">AMDGPULibCalls.cpp:220</a></div></div>
<div class="ttc" id="aAMDGPULibCalls_8cpp_html_afecf1cc1292b07f57d343c0f4d682044"><div class="ttname"><a href="AMDGPULibCalls_8cpp.html#afecf1cc1292b07f57d343c0f4d682044">Arg</a></div><div class="ttdeci">amdgpu Simplify well known AMD library false FunctionCallee Value * Arg</div><div class="ttdef"><b>Definition</b> <a href="AMDGPULibCalls_8cpp_source.html#l00220">AMDGPULibCalls.cpp:220</a></div></div>
<div class="ttc" id="aAMDGPUPropagateAttributes_8cpp_html_a89aee22a588785ca0c0755b95871b79e"><div class="ttname"><a href="AMDGPUPropagateAttributes_8cpp.html#a89aee22a588785ca0c0755b95871b79e">functions</a></div><div class="ttdeci">amdgpu propagate attributes Late propagate attributes from kernels to functions</div><div class="ttdef"><b>Definition</b> <a href="AMDGPUPropagateAttributes_8cpp_source.html#l00199">AMDGPUPropagateAttributes.cpp:199</a></div></div>
<div class="ttc" id="aARMSubtarget_8cpp_html_a4d4aec1a60ca09085c2b909af09a8c8b"><div class="ttname"><a href="ARMSubtarget_8cpp.html#a4d4aec1a60ca09085c2b909af09a8c8b">IT</a></div><div class="ttdeci">static cl::opt&lt; ITMode &gt; IT(cl::desc(&quot;IT block support&quot;), cl::Hidden, cl::init(DefaultIT), cl::ZeroOrMore, cl::values(clEnumValN(DefaultIT, &quot;arm-default-it&quot;, &quot;Generate IT block based on arch&quot;), clEnumValN(RestrictedIT, &quot;arm-restrict-it&quot;, &quot;Disallow deprecated IT based on ARMv8&quot;), clEnumValN(NoRestrictedIT, &quot;arm-no-restrict-it&quot;, &quot;Allow IT blocks based on ARMv7&quot;)))</div></div>
<div class="ttc" id="aArchiveWriter_8cpp_html_aa9f638c7ae7fdd206a6c60e26bef9751"><div class="ttname"><a href="ArchiveWriter_8cpp.html#aa9f638c7ae7fdd206a6c60e26bef9751">print</a></div><div class="ttdeci">static void print(raw_ostream &amp;Out, object::Archive::Kind Kind, T Val)</div><div class="ttdef"><b>Definition</b> <a href="ArchiveWriter_8cpp_source.html#l00146">ArchiveWriter.cpp:146</a></div></div>
<div class="ttc" id="aArgument_8h_html"><div class="ttname"><a href="Argument_8h.html">Argument.h</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00618">AssumeBundleBuilder.cpp:618</a></div></div>
<div class="ttc" id="aAttributes_8h_html"><div class="ttname"><a href="Attributes_8h.html">Attributes.h</a></div><div class="ttdoc">This file contains the simple types necessary to represent the attributes associated with functions a...</div></div>
<div class="ttc" id="aBBSectionsPrepare_8cpp_html_a5fd0741d696f28faf65b33f6c6af8fda"><div class="ttname"><a href="BBSectionsPrepare_8cpp.html#a5fd0741d696f28faf65b33f6c6af8fda">Cond</a></div><div class="ttdeci">SmallVector&lt; MachineOperand, 4 &gt; Cond</div><div class="ttdef"><b>Definition</b> <a href="BBSectionsPrepare_8cpp_source.html#l00159">BBSectionsPrepare.cpp:159</a></div></div>
<div class="ttc" id="aBasicBlockUtils_8h_html"><div class="ttname"><a href="BasicBlockUtils_8h.html">BasicBlockUtils.h</a></div></div>
<div class="ttc" id="aBasicBlock_8h_html"><div class="ttname"><a href="BasicBlock_8h.html">BasicBlock.h</a></div></div>
<div class="ttc" id="aBlockVerifier_8cpp_html_ae45c7d73c0ff5d177b59153ffae77f84"><div class="ttname"><a href="BlockVerifier_8cpp.html#ae45c7d73c0ff5d177b59153ffae77f84">From</a></div><div class="ttdeci">BlockVerifier::State From</div><div class="ttdef"><b>Definition</b> <a href="BlockVerifier_8cpp_source.html#l00055">BlockVerifier.cpp:55</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a3545a9491d4dcf823feb79f6eb37e3ee"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a3545a9491d4dcf823feb79f6eb37e3ee">A</a></div><div class="ttdeci">static GCRegistry::Add&lt; ErlangGC &gt; A(&quot;erlang&quot;, &quot;erlang-compatible garbage collector&quot;)</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a694d9607a781d330039787de0726acc0"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a694d9607a781d330039787de0726acc0">C</a></div><div class="ttdeci">static GCRegistry::Add&lt; ShadowStackGC &gt; C(&quot;shadow-stack&quot;, &quot;Very portable GC for uncooperative code generators&quot;)</div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_ab5899ca200d34e3cc6bb09ebce5e5b3c"><div class="ttname"><a href="BuiltinGCs_8cpp.html#ab5899ca200d34e3cc6bb09ebce5e5b3c">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aCallGraphSCCPass_8h_html"><div class="ttname"><a href="CallGraphSCCPass_8h.html">CallGraphSCCPass.h</a></div></div>
<div class="ttc" id="aCallGraphUpdater_8h_html"><div class="ttname"><a href="CallGraphUpdater_8h.html">CallGraphUpdater.h</a></div><div class="ttdoc">This file provides interfaces used to manipulate a call graph, regardless if it is a &quot;old style&quot; Call...</div></div>
<div class="ttc" id="aCallGraph_8h_html"><div class="ttname"><a href="CallGraph_8h.html">CallGraph.h</a></div><div class="ttdoc">This file provides interfaces used to build and manipulate a call graph, which is a very useful tool ...</div></div>
<div class="ttc" id="aCallingConv_8h_html"><div class="ttname"><a href="CallingConv_8h.html">CallingConv.h</a></div></div>
<div class="ttc" id="aCasting_8h_html"><div class="ttname"><a href="Casting_8h.html">Casting.h</a></div></div>
<div class="ttc" id="aCloning_8h_html"><div class="ttname"><a href="Cloning_8h.html">Cloning.h</a></div></div>
<div class="ttc" id="aConstants_8h_html"><div class="ttname"><a href="Constants_8h.html">Constants.h</a></div><div class="ttdoc">This file contains the declarations for the subclasses of Constant, which represent the different fla...</div></div>
<div class="ttc" id="aCoroInstr_8h_html"><div class="ttname"><a href="CoroInstr_8h.html">CoroInstr.h</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html"><div class="ttname"><a href="CoroInternal_8h.html">CoroInternal.h</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html_a5ecd860ed137865325945e7760e6a8b5"><div class="ttname"><a href="CoroInternal_8h.html#a5ecd860ed137865325945e7760e6a8b5">CORO_PRESPLIT_ATTR</a></div><div class="ttdeci">#define CORO_PRESPLIT_ATTR</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00038">CoroInternal.h:38</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html_aac2a1a4f2fcee7d92a68536873797e9a"><div class="ttname"><a href="CoroInternal_8h.html#aac2a1a4f2fcee7d92a68536873797e9a">PREPARED_FOR_SPLIT</a></div><div class="ttdeci">#define PREPARED_FOR_SPLIT</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00040">CoroInternal.h:40</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html_abb844f7b98ab7919d21939da9c945460"><div class="ttname"><a href="CoroInternal_8h.html#abb844f7b98ab7919d21939da9c945460">UNPREPARED_FOR_SPLIT</a></div><div class="ttdeci">#define UNPREPARED_FOR_SPLIT</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00039">CoroInternal.h:39</a></div></div>
<div class="ttc" id="aCoroInternal_8h_html_ac7fb164db65d90f230af6e90dad14353"><div class="ttname"><a href="CoroInternal_8h.html#ac7fb164db65d90f230af6e90dad14353">CORO_DEVIRT_TRIGGER_FN</a></div><div class="ttdeci">#define CORO_DEVIRT_TRIGGER_FN</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00042">CoroInternal.h:42</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a03604902e333b54be2da59880a5b2f37"><div class="ttname"><a href="CoroSplit_8cpp.html#a03604902e333b54be2da59880a5b2f37">replaceUnwindCoroEnd</a></div><div class="ttdeci">static void replaceUnwindCoroEnd(CoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdoc">Replace an unwind call to llvm.coro.end.</div><div class="ttdef"><b>Definition</b> <a href="#l00224">CoroSplit.cpp:224</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a116742dc8bd808e796becf1166383f63"><div class="ttname"><a href="CoroSplit_8cpp.html#a116742dc8bd808e796becf1166383f63">hasCallsBetween</a></div><div class="ttdeci">static bool hasCallsBetween(Instruction *Save, Instruction *ResumeOrDestroy)</div><div class="ttdef"><b>Definition</b> <a href="#l01132">CoroSplit.cpp:1132</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a1b7259e431066a500b6b6e7267fad8c3"><div class="ttname"><a href="CoroSplit_8cpp.html#a1b7259e431066a500b6b6e7267fad8c3">Changed</a></div><div class="ttdeci">return Changed</div><div class="ttdef"><b>Definition</b> <a href="#l01637">CoroSplit.cpp:1637</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a236935b2df66a03a0a54350a6b9b84bc"><div class="ttname"><a href="CoroSplit_8cpp.html#a236935b2df66a03a0a54350a6b9b84bc">replaceSwiftErrorOps</a></div><div class="ttdeci">static void replaceSwiftErrorOps(Function &amp;F, coro::Shape &amp;Shape, ValueToValueMapTy *VMap)</div><div class="ttdef"><b>Definition</b> <a href="#l00500">CoroSplit.cpp:500</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a2982861c55ba9af63c532e242683f864"><div class="ttname"><a href="CoroSplit_8cpp.html#a2982861c55ba9af63c532e242683f864">updateCallGraphAfterCoroutineSplit</a></div><div class="ttdeci">static void updateCallGraphAfterCoroutineSplit(Function &amp;F, const coro::Shape &amp;Shape, const SmallVectorImpl&lt; Function * &gt; &amp;Clones, CallGraph &amp;CG, CallGraphSCC &amp;SCC)</div><div class="ttdef"><b>Definition</b> <a href="#l01458">CoroSplit.cpp:1458</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a2adc4e4216fd4176a7775ac446467989"><div class="ttname"><a href="CoroSplit_8cpp.html#a2adc4e4216fd4176a7775ac446467989">replaceFallthroughCoroEnd</a></div><div class="ttdeci">static void replaceFallthroughCoroEnd(CoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdoc">Replace a non-unwind call to llvm.coro.end.</div><div class="ttdef"><b>Definition</b> <a href="#l00174">CoroSplit.cpp:174</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a2cbc874ec5612ccb47cad7f07ff51f94"><div class="ttname"><a href="CoroSplit_8cpp.html#a2cbc874ec5612ccb47cad7f07ff51f94">replaceFrameSize</a></div><div class="ttdeci">static void replaceFrameSize(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition</b> <a href="#l00814">CoroSplit.cpp:814</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a318ad24f290024cedc74e23f0eb09f4f"><div class="ttname"><a href="CoroSplit_8cpp.html#a318ad24f290024cedc74e23f0eb09f4f">declaresCoroSplitIntrinsics</a></div><div class="ttdeci">static bool declaresCoroSplitIntrinsics(const Module &amp;M)</div><div class="ttdef"><b>Definition</b> <a href="#l01640">CoroSplit.cpp:1640</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a3296d9f25bb33fa463f2e24c1c5cf3da"><div class="ttname"><a href="CoroSplit_8cpp.html#a3296d9f25bb33fa463f2e24c1c5cf3da">removeCoroEnds</a></div><div class="ttdeci">static void removeCoroEnds(const coro::Shape &amp;Shape, CallGraph *CG)</div><div class="ttdoc">Remove calls to llvm.coro.end in the original function.</div><div class="ttdef"><b>Definition</b> <a href="#l00808">CoroSplit.cpp:808</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a32be6dd93194bade824548c9247d8947"><div class="ttname"><a href="CoroSplit_8cpp.html#a32be6dd93194bade824548c9247d8947">replaceCoroEnd</a></div><div class="ttdeci">static void replaceCoroEnd(CoroEndInst *End, const coro::Shape &amp;Shape, Value *FramePtr, bool InResume, CallGraph *CG)</div><div class="ttdef"><b>Definition</b> <a href="#l00251">CoroSplit.cpp:251</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a3907189466613e437b0ea2731bf9b159"><div class="ttname"><a href="CoroSplit_8cpp.html#a3907189466613e437b0ea2731bf9b159">maybeFreeRetconStorage</a></div><div class="ttdeci">static void maybeFreeRetconStorage(IRBuilder&lt;&gt; &amp;Builder, const coro::Shape &amp;Shape, Value *FramePtr, CallGraph *CG)</div><div class="ttdef"><b>Definition</b> <a href="#l00162">CoroSplit.cpp:162</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a41861a50c3f91a35e7f25434d07ccd58"><div class="ttname"><a href="CoroSplit_8cpp.html#a41861a50c3f91a35e7f25434d07ccd58">createDevirtTriggerFunc</a></div><div class="ttdeci">static void createDevirtTriggerFunc(CallGraph &amp;CG, CallGraphSCC &amp;SCC)</div><div class="ttdef"><b>Definition</b> <a href="#l01544">CoroSplit.cpp:1544</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a44c557dcf96034410cdb25dd01c12dde"><div class="ttname"><a href="CoroSplit_8cpp.html#a44c557dcf96034410cdb25dd01c12dde">hasCallsInBlocksBetween</a></div><div class="ttdeci">static bool hasCallsInBlocksBetween(BasicBlock *SaveBB, BasicBlock *ResDesBB)</div><div class="ttdef"><b>Definition</b> <a href="#l01103">CoroSplit.cpp:1103</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a61bb4a52ef184d616270d2440ae550d4"><div class="ttname"><a href="CoroSplit_8cpp.html#a61bb4a52ef184d616270d2440ae550d4">addMustTailToCoroResumes</a></div><div class="ttdeci">static void addMustTailToCoroResumes(Function &amp;F)</div><div class="ttdef"><b>Definition</b> <a href="#l01034">CoroSplit.cpp:1034</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a6a5f2cd728870f22736c763bbca4c366"><div class="ttname"><a href="CoroSplit_8cpp.html#a6a5f2cd728870f22736c763bbca4c366">split</a></div><div class="ttdeci">coro split</div><div class="ttdef"><b>Definition</b> <a href="#l01806">CoroSplit.cpp:1806</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a76d02f8354cb0d3c8b30eb7812ae01b2"><div class="ttname"><a href="CoroSplit_8cpp.html#a76d02f8354cb0d3c8b30eb7812ae01b2">simplifySuspendPoints</a></div><div class="ttdeci">static void simplifySuspendPoints(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition</b> <a href="#l01217">CoroSplit.cpp:1217</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a870dde7776fd5695fbfa39d3c6396fc6"><div class="ttname"><a href="CoroSplit_8cpp.html#a870dde7776fd5695fbfa39d3c6396fc6">CG</a></div><div class="ttdeci">Remove calls to llvm coro prepare a barrier meant to prevent IPO from operating on calls to a retcon coroutine before it s been split This is only safe to do after we ve split all retcon coroutines in the module We can do that this in this pass because this pass does promise to split all retcon CallGraph &amp; CG</div><div class="ttdef"><b>Definition</b> <a href="#l01627">CoroSplit.cpp:1627</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a890a9012085abcc24f186c98388e45e5"><div class="ttname"><a href="CoroSplit_8cpp.html#a890a9012085abcc24f186c98388e45e5">createCloneDeclaration</a></div><div class="ttdeci">static Function * createCloneDeclaration(Function &amp;OrigF, coro::Shape &amp;Shape, const Twine &amp;Suffix, Module::iterator InsertBefore)</div><div class="ttdef"><b>Definition</b> <a href="#l00396">CoroSplit.cpp:396</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_a9f3928b341e4412b8b66b794896014f0"><div class="ttname"><a href="CoroSplit_8cpp.html#a9f3928b341e4412b8b66b794896014f0">simplifySuspendPoint</a></div><div class="ttdeci">static bool simplifySuspendPoint(CoroSuspendInst *Suspend, CoroBeginInst *CoroBegin)</div><div class="ttdef"><b>Definition</b> <a href="#l01157">CoroSplit.cpp:1157</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aa2a5070972b7da6066e2f1d49360c983"><div class="ttname"><a href="CoroSplit_8cpp.html#aa2a5070972b7da6066e2f1d49360c983">prepareForSplit</a></div><div class="ttdeci">static void prepareForSplit(Function &amp;F, CallGraph &amp;CG)</div><div class="ttdef"><b>Definition</b> <a href="#l01512">CoroSplit.cpp:1512</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aa48f79e7f4c043c7e362c2ea8a7d5c74"><div class="ttname"><a href="CoroSplit_8cpp.html#aa48f79e7f4c043c7e362c2ea8a7d5c74">hasCallsInBlockBetween</a></div><div class="ttdeci">static bool hasCallsInBlockBetween(Instruction *From, Instruction *To)</div><div class="ttdef"><b>Definition</b> <a href="#l01091">CoroSplit.cpp:1091</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aae6ba3400a4a2f4de9f2f3091fc6bbe9"><div class="ttname"><a href="CoroSplit_8cpp.html#aae6ba3400a4a2f4de9f2f3091fc6bbe9">machine</a></div><div class="ttdeci">coro Split coroutine into a set of functions driving its state machine</div><div class="ttdef"><b>Definition</b> <a href="#l01807">CoroSplit.cpp:1807</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab2b08d89352a026bdcacac0229e93b66"><div class="ttname"><a href="CoroSplit_8cpp.html#ab2b08d89352a026bdcacac0229e93b66">setCoroInfo</a></div><div class="ttdeci">static void setCoroInfo(Function &amp;F, coro::Shape &amp;Shape, ArrayRef&lt; Function * &gt; Fns)</div><div class="ttdef"><b>Definition</b> <a href="#l00842">CoroSplit.cpp:842</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab481cb6df9b3f1cdc39ffe0311067195"><div class="ttname"><a href="CoroSplit_8cpp.html#ab481cb6df9b3f1cdc39ffe0311067195">splitSwitchCoroutine</a></div><div class="ttdeci">static void splitSwitchCoroutine(Function &amp;F, coro::Shape &amp;Shape, SmallVectorImpl&lt; Function * &gt; &amp;Clones)</div><div class="ttdef"><b>Definition</b> <a href="#l01242">CoroSplit.cpp:1242</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab7881567f602c3a94d11e2817f4464e0"><div class="ttname"><a href="CoroSplit_8cpp.html#ab7881567f602c3a94d11e2817f4464e0">handleNoSuspendCoroutine</a></div><div class="ttdeci">static void handleNoSuspendCoroutine(coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition</b> <a href="#l01057">CoroSplit.cpp:1057</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab8367d5021c982f2e56503edd6abde83"><div class="ttname"><a href="CoroSplit_8cpp.html#ab8367d5021c982f2e56503edd6abde83">updateCoroFrame</a></div><div class="ttdeci">static void updateCoroFrame(coro::Shape &amp;Shape, Function *ResumeFn, Function *DestroyFn, Function *CleanupFn)</div><div class="ttdef"><b>Definition</b> <a href="#l00866">CoroSplit.cpp:866</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab8d43a9eb23bbd336819153a60a26f36"><div class="ttname"><a href="CoroSplit_8cpp.html#ab8d43a9eb23bbd336819153a60a26f36">createResumeEntryBlock</a></div><div class="ttdeci">static void createResumeEntryBlock(Function &amp;F, coro::Shape &amp;Shape)</div><div class="ttdef"><b>Definition</b> <a href="#l00266">CoroSplit.cpp:266</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ab8e976512a25b571502b4ede569f7759"><div class="ttname"><a href="CoroSplit_8cpp.html#ab8e976512a25b571502b4ede569f7759">replacePrepare</a></div><div class="ttdeci">Replace a call to llvm coro prepare static retcon void replacePrepare(CallInst *Prepare, CallGraph &amp;CG)</div><div class="ttdef"><b>Definition</b> <a href="#l01567">CoroSplit.cpp:1567</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_abf6fd4d7d6bc12f868a22eff33fbad53"><div class="ttname"><a href="CoroSplit_8cpp.html#abf6fd4d7d6bc12f868a22eff33fbad53">splitCoroutine</a></div><div class="ttdeci">static coro::Shape splitCoroutine(Function &amp;F, SmallVectorImpl&lt; Function * &gt; &amp;Clones)</div><div class="ttdef"><b>Definition</b> <a href="#l01418">CoroSplit.cpp:1418</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ac2458e50c1358135964844abe8d8979d"><div class="ttname"><a href="CoroSplit_8cpp.html#ac2458e50c1358135964844abe8d8979d">postSplitCleanup</a></div><div class="ttdeci">static void postSplitCleanup(Function &amp;F)</div><div class="ttdef"><b>Definition</b> <a href="#l00891">CoroSplit.cpp:891</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ad6e01ddef1bbbcc78868710f00b00c68"><div class="ttname"><a href="CoroSplit_8cpp.html#ad6e01ddef1bbbcc78868710f00b00c68">addFramePointerAttrs</a></div><div class="ttdeci">static void addFramePointerAttrs(AttributeList &amp;Attrs, LLVMContext &amp;Context, unsigned ParamIndex, uint64_t Size, Align Alignment)</div><div class="ttdef"><b>Definition</b> <a href="#l00647">CoroSplit.cpp:647</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_ad7eb86fb2d6210e104805e7d7e1c4307"><div class="ttname"><a href="CoroSplit_8cpp.html#ad7eb86fb2d6210e104805e7d7e1c4307">simplifyTerminatorLeadingToRet</a></div><div class="ttdeci">static bool simplifyTerminatorLeadingToRet(Instruction *InitialInst)</div><div class="ttdef"><b>Definition</b> <a href="#l00932">CoroSplit.cpp:932</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aebe6fbeca9d67beead560579e1af9e8c"><div class="ttname"><a href="CoroSplit_8cpp.html#aebe6fbeca9d67beead560579e1af9e8c">splitRetconCoroutine</a></div><div class="ttdeci">static void splitRetconCoroutine(Function &amp;F, coro::Shape &amp;Shape, SmallVectorImpl&lt; Function * &gt; &amp;Clones)</div><div class="ttdef"><b>Definition</b> <a href="#l01274">CoroSplit.cpp:1274</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_aebee292426fd0bf7072b2beed8e95387"><div class="ttname"><a href="CoroSplit_8cpp.html#aebee292426fd0bf7072b2beed8e95387">scanPHIsAndUpdateValueMap</a></div><div class="ttdeci">static void scanPHIsAndUpdateValueMap(Instruction *Prev, BasicBlock *NewBlock, DenseMap&lt; Value *, Value * &gt; &amp;ResolvedValues)</div><div class="ttdef"><b>Definition</b> <a href="#l00915">CoroSplit.cpp:915</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_af7e642e539e37ca5ee21e8cf1e1748b8"><div class="ttname"><a href="CoroSplit_8cpp.html#af7e642e539e37ca5ee21e8cf1e1748b8">shouldBeMustTail</a></div><div class="ttdeci">static bool shouldBeMustTail(const CallInst &amp;CI, const Function &amp;F)</div><div class="ttdef"><b>Definition</b> <a href="#l00999">CoroSplit.cpp:999</a></div></div>
<div class="ttc" id="aCoroSplit_8cpp_html_af95620cf86b3f3c71dee78b6edc2f12d"><div class="ttname"><a href="CoroSplit_8cpp.html#af95620cf86b3f3c71dee78b6edc2f12d">createClone</a></div><div class="ttdeci">static Function * createClone(Function &amp;F, const Twine &amp;Suffix, coro::Shape &amp;Shape, CoroCloner::Kind FKind)</div><div class="ttdef"><b>Definition</b> <a href="#l00800">CoroSplit.cpp:800</a></div></div>
<div class="ttc" id="aCoroSplit_8h_html"><div class="ttname"><a href="CoroSplit_8h.html">CoroSplit.h</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aDeadArgumentElimination_8cpp_html_ae9e8b37f293199ceac2a52f811e26a3e"><div class="ttname"><a href="DeadArgumentElimination_8cpp.html#ae9e8b37f293199ceac2a52f811e26a3e">RetTy</a></div><div class="ttdeci">else return RetTy</div><div class="ttdef"><b>Definition</b> <a href="DeadArgumentElimination_8cpp_source.html#l00350">DeadArgumentElimination.cpp:350</a></div></div>
<div class="ttc" id="aDebug_8h_html"><div class="ttname"><a href="Debug_8h.html">Debug.h</a></div></div>
<div class="ttc" id="aDebug_8h_html_a08efc68d15935eb8889400a46c3749ba"><div class="ttname"><a href="Debug_8h.html#a08efc68d15935eb8889400a46c3749ba">LLVM_DEBUG</a></div><div class="ttdeci">#define LLVM_DEBUG(X)</div><div class="ttdef"><b>Definition</b> <a href="Debug_8h_source.html#l00122">Debug.h:122</a></div></div>
<div class="ttc" id="aDenseMap_8h_html"><div class="ttname"><a href="DenseMap_8h.html">DenseMap.h</a></div></div>
<div class="ttc" id="aDerivedTypes_8h_html"><div class="ttname"><a href="DerivedTypes_8h.html">DerivedTypes.h</a></div></div>
<div class="ttc" id="aEvaluator_8cpp_html_a92efb02157b6836e1232c577d34678d6"><div class="ttname"><a href="Evaluator_8cpp.html#a92efb02157b6836e1232c577d34678d6">getFunction</a></div><div class="ttdeci">static Function * getFunction(Constant *C)</div><div class="ttdef"><b>Definition</b> <a href="Evaluator_8cpp_source.html#l00256">Evaluator.cpp:256</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aGlobalValue_8h_html"><div class="ttname"><a href="GlobalValue_8h.html">GlobalValue.h</a></div></div>
<div class="ttc" id="aGlobalVariable_8h_html"><div class="ttname"><a href="GlobalVariable_8h.html">GlobalVariable.h</a></div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aIR_2CFG_8h_html"><div class="ttname"><a href="IR_2CFG_8h.html">CFG.h</a></div><div class="ttdoc">This file provides various utilities for inspecting and working with the control flow graph in LLVM I...</div></div>
<div class="ttc" id="aIR_2Instruction_8h_html"><div class="ttname"><a href="IR_2Instruction_8h.html">Instruction.h</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aInstIterator_8h_html"><div class="ttname"><a href="InstIterator_8h.html">InstIterator.h</a></div></div>
<div class="ttc" id="aInstrTypes_8h_html"><div class="ttname"><a href="InstrTypes_8h.html">InstrTypes.h</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aLLVMContext_8h_html"><div class="ttname"><a href="LLVMContext_8h.html">LLVMContext.h</a></div></div>
<div class="ttc" id="aLegacyPassManager_8h_html"><div class="ttname"><a href="LegacyPassManager_8h.html">LegacyPassManager.h</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition</b> <a href="MD5_8cpp_source.html#l00056">MD5.cpp:56</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition</b> <a href="MD5_8cpp_source.html#l00059">MD5.cpp:59</a></div></div>
<div class="ttc" id="aModule_8h_html"><div class="ttname"><a href="Module_8h.html">Module.h</a></div><div class="ttdoc">Module.h This file contains the declarations for the Module class.</div></div>
<div class="ttc" id="aMustExecute_8cpp_html_a2b8cdcb5ff2dc7197a4e2b5a38c11580"><div class="ttname"><a href="MustExecute_8cpp.html#a2b8cdcb5ff2dc7197a4e2b5a38c11580">instructions</a></div><div class="ttdeci">print must be executed print the must be executed contexed for all instructions</div><div class="ttdef"><b>Definition</b> <a href="MustExecute_8cpp_source.html#l00350">MustExecute.cpp:350</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a14724f1ccf528e73bb29bc9230737967"><div class="ttname"><a href="PassSupport_8h.html#a14724f1ccf528e73bb29bc9230737967">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">#define INITIALIZE_PASS_DEPENDENCY(depName)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00054">PassSupport.h:54</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00058">PassSupport.h:58</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_aaa970fc931c1c63037a8182e028d04b1"><div class="ttname"><a href="PassSupport_8h.html#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">#define INITIALIZE_PASS_BEGIN(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition</b> <a href="PassSupport_8h_source.html#l00051">PassSupport.h:51</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aPrettyStackTrace_8h_html"><div class="ttname"><a href="PrettyStackTrace_8h.html">PrettyStackTrace.h</a></div></div>
<div class="ttc" id="aProfile_8cpp_html_a1f5ab05b3305a959d954b796c63807c4"><div class="ttname"><a href="Profile_8cpp.html#a1f5ab05b3305a959d954b796c63807c4">Size</a></div><div class="ttdeci">uint32_t Size</div><div class="ttdef"><b>Definition</b> <a href="Profile_8cpp_source.html#l00046">Profile.cpp:46</a></div></div>
<div class="ttc" id="aSIInstrInfo_8cpp_html_a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="SIInstrInfo_8cpp.html#a0dfd55eaf0bcb495f09ecf8c55b256b2a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdef"><b>Definition</b> <a href="SIInstrInfo_8cpp_source.html#l06827">SIInstrInfo.cpp:6827</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aSmallPtrSet_8h_html"><div class="ttname"><a href="SmallPtrSet_8h.html">SmallPtrSet.h</a></div></div>
<div class="ttc" id="aSmallVector_8h_html"><div class="ttname"><a href="SmallVector_8h.html">SmallVector.h</a></div></div>
<div class="ttc" id="aStringRef_8h_html"><div class="ttname"><a href="StringRef_8h.html">StringRef.h</a></div></div>
<div class="ttc" id="aTransforms_2Utils_2Local_8h_html"><div class="ttname"><a href="Transforms_2Utils_2Local_8h.html">Local.h</a></div></div>
<div class="ttc" id="aTwine_8h_html"><div class="ttname"><a href="Twine_8h.html">Twine.h</a></div></div>
<div class="ttc" id="aType_8h_html"><div class="ttname"><a href="Type_8h.html">Type.h</a></div></div>
<div class="ttc" id="aValueMapper_8h_html"><div class="ttname"><a href="ValueMapper_8h.html">ValueMapper.h</a></div></div>
<div class="ttc" id="aValue_8h_html"><div class="ttname"><a href="Value_8h.html">Value.h</a></div></div>
<div class="ttc" id="aVerifier_8h_html"><div class="ttname"><a href="Verifier_8h.html">Verifier.h</a></div></div>
<div class="ttc" id="aWebAssemblyMCInstLower_8cpp_html_af678953060add50e8c34b34d5f4bdd65"><div class="ttname"><a href="WebAssemblyMCInstLower_8cpp.html#af678953060add50e8c34b34d5f4bdd65">getType</a></div><div class="ttdeci">static wasm::ValType getType(const TargetRegisterClass *RC)</div><div class="ttdef"><b>Definition</b> <a href="WebAssemblyMCInstLower_8cpp_source.html#l00180">WebAssemblyMCInstLower.cpp:180</a></div></div>
<div class="ttc" id="aXCoreFrameLowering_8cpp_html_a64f8c7400de58c117c5af250f000675f"><div class="ttname"><a href="XCoreFrameLowering_8cpp.html#a64f8c7400de58c117c5af250f000675f">FramePtr</a></div><div class="ttdeci">static const unsigned FramePtr</div><div class="ttdef"><b>Definition</b> <a href="XCoreFrameLowering_8cpp_source.html#l00034">XCoreFrameLowering.cpp:34</a></div></div>
<div class="ttc" id="aclassFunctionType_html"><div class="ttname"><a href="classFunctionType.html">FunctionType</a></div><div class="ttdef"><b>Definition</b> <a href="ItaniumDemangle_8h_source.html#l00639">ItaniumDemangle.h:639</a></div></div>
<div class="ttc" id="aclassNode_html"><div class="ttname"><a href="classNode.html">Node</a></div><div class="ttdef"><b>Definition</b> <a href="ItaniumDemangle_8h_source.html#l00113">ItaniumDemangle.h:113</a></div></div>
<div class="ttc" id="aclassPointerType_html"><div class="ttname"><a href="classPointerType.html">PointerType</a></div><div class="ttdef"><b>Definition</b> <a href="ItaniumDemangle_8h_source.html#l00473">ItaniumDemangle.h:473</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html">llvm::AnalysisManager</a></div><div class="ttdoc">A container for analyses that lazily runs them and caches their results.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00613">PassManager.h:613</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisManager_html_aaab1fad63e4f3b8679469720a873fedd"><div class="ttname"><a href="classllvm_1_1AnalysisManager.html#aaab1fad63e4f3b8679469720a873fedd">llvm::AnalysisManager::getResult</a></div><div class="ttdeci">PassT::Result &amp; getResult(IRUnitT &amp;IR, ExtraArgTs... ExtraArgs)</div><div class="ttdoc">Get the result of an analysis pass for a given IR unit.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00769">PassManager.h:769</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition</b> <a href="PassAnalysisSupport_8h_source.html#l00046">PassAnalysisSupport.h:46</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroIdRetconInst_html_a3a0e2ffc025fe9de9569095d9ac140b8"><div class="ttname"><a href="classllvm_1_1AnyCoroIdRetconInst.html#a3a0e2ffc025fe9de9569095d9ac140b8">llvm::AnyCoroIdRetconInst::getStorageAlignment</a></div><div class="ttdeci">Align getStorageAlignment() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00214">CoroInstr.h:214</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroIdRetconInst_html_a591b908fe4707059172b0ee3cd2ed4a2"><div class="ttname"><a href="classllvm_1_1AnyCoroIdRetconInst.html#a591b908fe4707059172b0ee3cd2ed4a2">llvm::AnyCoroIdRetconInst::getStorageSize</a></div><div class="ttdeci">uint64_t getStorageSize() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00210">CoroInstr.h:210</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnyCoroSuspendInst_html"><div class="ttname"><a href="classllvm_1_1AnyCoroSuspendInst.html">llvm::AnyCoroSuspendInst</a></div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00362">CoroInstr.h:362</a></div></div>
<div class="ttc" id="aclassllvm_1_1Argument_html"><div class="ttname"><a href="classllvm_1_1Argument.html">llvm::Argument</a></div><div class="ttdoc">This class represents an incoming formal argument to a Function.</div><div class="ttdef"><b>Definition</b> <a href="Argument_8h_source.html#l00029">Argument.h:29</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttrBuilder_html"><div class="ttname"><a href="classllvm_1_1AttrBuilder.html">llvm::AttrBuilder</a></div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00723">Attributes.h:723</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html"><div class="ttname"><a href="classllvm_1_1AttributeList.html">llvm::AttributeList</a></div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00351">Attributes.h:351</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_af5dcb6d3da4b30a7d21c9fb39bbf1a68a167699508089d6cf7e6afe448d82e6df"><div class="ttname"><a href="classllvm_1_1AttributeList.html#af5dcb6d3da4b30a7d21c9fb39bbf1a68a167699508089d6cf7e6afe448d82e6df">llvm::AttributeList::ReturnIndex</a></div><div class="ttdeci">@ ReturnIndex</div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00354">Attributes.h:354</a></div></div>
<div class="ttc" id="aclassllvm_1_1AttributeList_html_af5dcb6d3da4b30a7d21c9fb39bbf1a68a895001b186ed51e1cb7a256dbd3545f8"><div class="ttname"><a href="classllvm_1_1AttributeList.html#af5dcb6d3da4b30a7d21c9fb39bbf1a68a895001b186ed51e1cb7a256dbd3545f8">llvm::AttributeList::FunctionIndex</a></div><div class="ttdeci">@ FunctionIndex</div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00355">Attributes.h:355</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html"><div class="ttname"><a href="classllvm_1_1Attribute.html">llvm::Attribute</a></div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00051">Attributes.h:51</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_a968930aea9d9efa8d46dd890fce75643"><div class="ttname"><a href="classllvm_1_1Attribute.html#a968930aea9d9efa8d46dd890fce75643">llvm::Attribute::getValueAsString</a></div><div class="ttdeci">StringRef getValueAsString() const</div><div class="ttdoc">Return the attribute's value as a string.</div><div class="ttdef"><b>Definition</b> <a href="Attributes_8cpp_source.html#l00267">Attributes.cpp:267</a></div></div>
<div class="ttc" id="aclassllvm_1_1Attribute_html_aab7ee4b8fd1d3e7e4cea87868855e60e"><div class="ttname"><a href="classllvm_1_1Attribute.html#aab7ee4b8fd1d3e7e4cea87868855e60e">llvm::Attribute::AttrKind</a></div><div class="ttdeci">AttrKind</div><div class="ttdoc">This enumeration lists the attributes that can be associated with parameters, function results,...</div><div class="ttdef"><b>Definition</b> <a href="Attributes_8h_source.html#l00070">Attributes.h:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8h_source.html#l00058">BasicBlock.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a4848d1a141ddc7cf0068460fba53ba37"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a4848d1a141ddc7cf0068460fba53ba37">llvm::BasicBlock::front</a></div><div class="ttdeci">const Instruction &amp; front() const</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8h_source.html#l00301">BasicBlock.h:301</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a4a5b798214be930cf8e133c032ba0129"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a4a5b798214be930cf8e133c032ba0129">llvm::BasicBlock::Create</a></div><div class="ttdeci">static BasicBlock * Create(LLVMContext &amp;Context, const Twine &amp;Name=&quot;&quot;, Function *Parent=nullptr, BasicBlock *InsertBefore=nullptr)</div><div class="ttdoc">Creates a new BasicBlock.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8h_source.html#l00100">BasicBlock.h:100</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a59fb91d1691350f7d1b8e8a114e3f2a4"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a59fb91d1691350f7d1b8e8a114e3f2a4">llvm::BasicBlock::getSinglePredecessor</a></div><div class="ttdeci">const BasicBlock * getSinglePredecessor() const</div><div class="ttdoc">Return the predecessor of this block if it has a single predecessor block.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8cpp_source.html#l00258">BasicBlock.cpp:258</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_af892b6cfca15dd251950e0954b828dc2"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#af892b6cfca15dd251950e0954b828dc2">llvm::BasicBlock::getFirstNonPHIOrDbgOrLifetime</a></div><div class="ttdeci">const Instruction * getFirstNonPHIOrDbgOrLifetime() const</div><div class="ttdoc">Returns a pointer to the first instruction in this block that is not a PHINode, a debug intrinsic,...</div><div class="ttdef"><b>Definition</b> <a href="BasicBlock_8cpp_source.html#l00228">BasicBlock.cpp:228</a></div></div>
<div class="ttc" id="aclassllvm_1_1BranchInst_html_a8072a8e1bd8e8f03b34f9b50830c0e31"><div class="ttname"><a href="classllvm_1_1BranchInst.html#a8072a8e1bd8e8f03b34f9b50830c0e31">llvm::BranchInst::Create</a></div><div class="ttdeci">static BranchInst * Create(BasicBlock *IfTrue, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l03015">Instructions.h:3015</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html"><div class="ttname"><a href="classllvm_1_1CallBase.html">llvm::CallBase</a></div><div class="ttdoc">Base class for all callable instructions (InvokeInst and CallInst) Holds everything related to callin...</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01100">InstrTypes.h:1100</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a018f0394a375233d538109968b76a05a"><div class="ttname"><a href="classllvm_1_1CallBase.html#a018f0394a375233d538109968b76a05a">llvm::CallBase::isInlineAsm</a></div><div class="ttdeci">bool isInlineAsm() const</div><div class="ttdoc">Check if this call is an inline asm statement.</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01380">InstrTypes.h:1380</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a3ff92cec76009e859cb0c419d6e8ba5f"><div class="ttname"><a href="classllvm_1_1CallBase.html#a3ff92cec76009e859cb0c419d6e8ba5f">llvm::CallBase::getCallingConv</a></div><div class="ttdeci">CallingConv::ID getCallingConv() const</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01371">InstrTypes.h:1371</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_a8d13199cbf4d080d3b5dcf330dad5d2c"><div class="ttname"><a href="classllvm_1_1CallBase.html#a8d13199cbf4d080d3b5dcf330dad5d2c">llvm::CallBase::getCalledOperand</a></div><div class="ttdeci">Value * getCalledOperand() const</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01307">InstrTypes.h:1307</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ac3c35bd078a268a207f607d0f57dadba"><div class="ttname"><a href="classllvm_1_1CallBase.html#ac3c35bd078a268a207f607d0f57dadba">llvm::CallBase::getFunctionType</a></div><div class="ttdeci">FunctionType * getFunctionType() const</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01162">InstrTypes.h:1162</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ae0c55761fce39dd71617690b04385193"><div class="ttname"><a href="classllvm_1_1CallBase.html#ae0c55761fce39dd71617690b04385193">llvm::CallBase::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the parameter attributes for this call.</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l01390">InstrTypes.h:1390</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphNode_html"><div class="ttname"><a href="classllvm_1_1CallGraphNode.html">llvm::CallGraphNode</a></div><div class="ttdoc">A node in the call graph for a module.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00174">CallGraph.h:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCCPass_html"><div class="ttname"><a href="classllvm_1_1CallGraphSCCPass.html">llvm::CallGraphSCCPass</a></div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00034">CallGraphSCCPass.h:34</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCCPass_html_a6cc67c5a27b53bc940d292c0aeb6aba3"><div class="ttname"><a href="classllvm_1_1CallGraphSCCPass.html#a6cc67c5a27b53bc940d292c0aeb6aba3">llvm::CallGraphSCCPass::getAnalysisUsage</a></div><div class="ttdeci">void getAnalysisUsage(AnalysisUsage &amp;Info) const override</div><div class="ttdoc">getAnalysisUsage - For this class, we declare that we require and preserve the call graph.</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8cpp_source.html#l00642">CallGraphSCCPass.cpp:642</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCCPass_html_ad789278ad915ddf3e6d75eb29066f0b3"><div class="ttname"><a href="classllvm_1_1CallGraphSCCPass.html#ad789278ad915ddf3e6d75eb29066f0b3">llvm::CallGraphSCCPass::doInitialization</a></div><div class="ttdeci">virtual bool doInitialization(CallGraph &amp;CG)</div><div class="ttdoc">doInitialization - This method is called before the SCC's of the program has been processed,...</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00048">CallGraphSCCPass.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCC_html"><div class="ttname"><a href="classllvm_1_1CallGraphSCC.html">llvm::CallGraphSCC</a></div><div class="ttdoc">CallGraphSCC - This is a single SCC that a CallGraphSCCPass is run on.</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00087">CallGraphSCCPass.h:87</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCC_html_a3ac41a0c13e49229773f3f0084e8de9d"><div class="ttname"><a href="classllvm_1_1CallGraphSCC.html#a3ac41a0c13e49229773f3f0084e8de9d">llvm::CallGraphSCC::getCallGraph</a></div><div class="ttdeci">const CallGraph &amp; getCallGraph()</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00115">CallGraphSCCPass.h:115</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCC_html_a87e1b8515d22eb833375761e19a2d0fe"><div class="ttname"><a href="classllvm_1_1CallGraphSCC.html#a87e1b8515d22eb833375761e19a2d0fe">llvm::CallGraphSCC::initialize</a></div><div class="ttdeci">void initialize(ArrayRef&lt; CallGraphNode * &gt; NewNodes)</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00095">CallGraphSCCPass.h:95</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCC_html_abc1462ee74423b01bf6afa30d85cca9e"><div class="ttname"><a href="classllvm_1_1CallGraphSCC.html#abc1462ee74423b01bf6afa30d85cca9e">llvm::CallGraphSCC::begin</a></div><div class="ttdeci">iterator begin() const</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00112">CallGraphSCCPass.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphSCC_html_aebb35c664157dd1a6c8b58e715498015"><div class="ttname"><a href="classllvm_1_1CallGraphSCC.html#aebb35c664157dd1a6c8b58e715498015">llvm::CallGraphSCC::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition</b> <a href="CallGraphSCCPass_8h_source.html#l00113">CallGraphSCCPass.h:113</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraphWrapperPass_html"><div class="ttname"><a href="classllvm_1_1CallGraphWrapperPass.html">llvm::CallGraphWrapperPass</a></div><div class="ttdoc">The ModulePass which wraps up a CallGraph and the logic to build it.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00344">CallGraph.h:344</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraph_html"><div class="ttname"><a href="classllvm_1_1CallGraph.html">llvm::CallGraph</a></div><div class="ttdoc">The basic data container for the call graph of a Module of IR.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00073">CallGraph.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallGraph_html_ac6148a4c6df56af41c63c0c3a798c447"><div class="ttname"><a href="classllvm_1_1CallGraph.html#ac6148a4c6df56af41c63c0c3a798c447">llvm::CallGraph::getModule</a></div><div class="ttdeci">Module &amp; getModule() const</div><div class="ttdoc">Returns the module the call graph corresponds to.</div><div class="ttdef"><b>Definition</b> <a href="CallGraph_8h_source.html#l00109">CallGraph.h:109</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html"><div class="ttname"><a href="classllvm_1_1CallInst.html">llvm::CallInst</a></div><div class="ttdoc">This class represents a function call, abstracting a target machine's calling convention.</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l01425">Instructions.h:1425</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e"><div class="ttname"><a href="classllvm_1_1CallInst.html#ad682514c13f12f1a8d759d422fce6aefa2c3fc2c37f5db1dd777fad4e0d33ec7e">llvm::CallInst::TCK_MustTail</a></div><div class="ttdeci">@ TCK_MustTail</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l01605">Instructions.h:1605</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallInst_html_aeeed015ff391a8b170e446a05618f59d"><div class="ttname"><a href="classllvm_1_1CallInst.html#aeeed015ff391a8b170e446a05618f59d">llvm::CallInst::Create</a></div><div class="ttdeci">static CallInst * Create(FunctionType *Ty, Value *F, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l01468">Instructions.h:1468</a></div></div>
<div class="ttc" id="aclassllvm_1_1CmpInst_html_a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218"><div class="ttname"><a href="classllvm_1_1CmpInst.html#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">llvm::CmpInst::ICMP_EQ</a></div><div class="ttdeci">@ ICMP_EQ</div><div class="ttdoc">equal</div><div class="ttdef"><b>Definition</b> <a href="InstrTypes_8h_source.html#l00746">InstrTypes.h:746</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantArray_html_a0900dacdc7ad8e3ea0cc92993c7fd422"><div class="ttname"><a href="classllvm_1_1ConstantArray.html#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a></div><div class="ttdeci">static Constant * get(ArrayType *T, ArrayRef&lt; Constant * &gt; V)</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l01158">Constants.cpp:1158</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantExpr_html_a1f469b1f703519ae25ce564c8704310f"><div class="ttname"><a href="classllvm_1_1ConstantExpr.html#a1f469b1f703519ae25ce564c8704310f">llvm::ConstantExpr::getPointerCast</a></div><div class="ttdeci">static Constant * getPointerCast(Constant *C, Type *Ty)</div><div class="ttdoc">Create a BitCast, AddrSpaceCast, or a PtrToInt cast constant expression.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l01837">Constants.cpp:1837</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8h_source.html#l00077">Constants.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a82dbbd8e3688b0bc1eedb338864d0d0c"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a82dbbd8e3688b0bc1eedb338864d0d0c">llvm::ConstantInt::getTrue</a></div><div class="ttdeci">static ConstantInt * getTrue(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l00742">Constants.cpp:742</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_a9105541412dab869e18b3cceebfff07d"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#a9105541412dab869e18b3cceebfff07d">llvm::ConstantInt::get</a></div><div class="ttdeci">static Constant * get(Type *Ty, uint64_t V, bool isSigned=false)</div><div class="ttdoc">If Ty is a vector type, return a Constant with a splat of the given value.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l00786">Constants.cpp:786</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html_aa7cce62ac5cc6df09cce0535874336b7"><div class="ttname"><a href="classllvm_1_1ConstantInt.html#aa7cce62ac5cc6df09cce0535874336b7">llvm::ConstantInt::getFalse</a></div><div class="ttdeci">static ConstantInt * getFalse(LLVMContext &amp;Context)</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l00749">Constants.cpp:749</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantPointerNull_html_a96f5c85e4022e369266541b2db3fda69"><div class="ttname"><a href="classllvm_1_1ConstantPointerNull.html#a96f5c85e4022e369266541b2db3fda69">llvm::ConstantPointerNull::get</a></div><div class="ttdeci">static ConstantPointerNull * get(PointerType *T)</div><div class="ttdoc">Static factory methods - Return objects of the specified value.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l01651">Constants.cpp:1651</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantTokenNone_html_a8e29fb8e39fb67b3bb746dbba47fcb29"><div class="ttname"><a href="classllvm_1_1ConstantTokenNone.html#a8e29fb8e39fb67b3bb746dbba47fcb29">llvm::ConstantTokenNone::get</a></div><div class="ttdeci">static ConstantTokenNone * get(LLVMContext &amp;Context)</div><div class="ttdoc">Return the ConstantTokenNone.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l01324">Constants.cpp:1324</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroAllocInst_html"><div class="ttname"><a href="classllvm_1_1CoroAllocInst.html">llvm::CoroAllocInst</a></div><div class="ttdoc">This represents the llvm.coro.alloc instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00070">CoroInstr.h:70</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroBeginInst_html"><div class="ttname"><a href="classllvm_1_1CoroBeginInst.html">llvm::CoroBeginInst</a></div><div class="ttdoc">This class represents the llvm.coro.begin instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00305">CoroInstr.h:305</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroBeginInst_html_a30b3ddd0433d254830f61bf122e5eefc"><div class="ttname"><a href="classllvm_1_1CoroBeginInst.html#a30b3ddd0433d254830f61bf122e5eefc">llvm::CoroBeginInst::getId</a></div><div class="ttdeci">AnyCoroIdInst * getId() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00309">CoroInstr.h:309</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroEndInst_html"><div class="ttname"><a href="classllvm_1_1CoroEndInst.html">llvm::CoroEndInst</a></div><div class="ttdoc">This represents the llvm.coro.end instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00446">CoroInstr.h:446</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroIdInst_html"><div class="ttname"><a href="classllvm_1_1CoroIdInst.html">llvm::CoroIdInst</a></div><div class="ttdoc">This represents the llvm.coro.id instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00113">CoroInstr.h:113</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroIdInst_html_a11b71b3b2f2b4d214a7eac47e628b3d2"><div class="ttname"><a href="classllvm_1_1CoroIdInst.html#a11b71b3b2f2b4d214a7eac47e628b3d2">llvm::CoroIdInst::setInfo</a></div><div class="ttdeci">void setInfo(Constant *C)</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00180">CoroInstr.h:180</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSizeInst_html"><div class="ttname"><a href="classllvm_1_1CoroSizeInst.html">llvm::CoroSizeInst</a></div><div class="ttdoc">This represents the llvm.coro.size instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00434">CoroInstr.h:434</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSubFnInst_html_abb112419696544e53611285949f18783a3863ef6dc67cdba9c44c42a15c51e786"><div class="ttname"><a href="classllvm_1_1CoroSubFnInst.html#abb112419696544e53611285949f18783a3863ef6dc67cdba9c44c42a15c51e786">llvm::CoroSubFnInst::RestartTrigger</a></div><div class="ttdeci">@ RestartTrigger</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00040">CoroInstr.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendInst_html"><div class="ttname"><a href="classllvm_1_1CoroSuspendInst.html">llvm::CoroSuspendInst</a></div><div class="ttdoc">This represents the llvm.coro.suspend instruction.</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00377">CoroInstr.h:377</a></div></div>
<div class="ttc" id="aclassllvm_1_1CoroSuspendInst_html_aa359a0b614626b5bfafbc095eef26e04"><div class="ttname"><a href="classllvm_1_1CoroSuspendInst.html#aa359a0b614626b5bfafbc095eef26e04">llvm::CoroSuspendInst::getCoroSave</a></div><div class="ttdeci">CoroSaveInst * getCoroSave() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInstr_8h_source.html#l00381">CoroInstr.h:381</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition</b> <a href="DataLayout_8h_source.html#l00111">DataLayout.h:111</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionAnalysisManagerCGSCCProxy_html"><div class="ttname"><a href="classllvm_1_1FunctionAnalysisManagerCGSCCProxy.html">llvm::FunctionAnalysisManagerCGSCCProxy</a></div><div class="ttdoc">A proxy from a FunctionAnalysisManager to an SCC.</div><div class="ttdef"><b>Definition</b> <a href="CGSCCPassManager_8h_source.html#l00378">CGSCCPassManager.h:379</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionType_html_ad65790aa94dd4678a1d339d8304e1965"><div class="ttname"><a href="classllvm_1_1FunctionType.html#ad65790aa94dd4678a1d339d8304e1965">llvm::FunctionType::getReturnType</a></div><div class="ttdeci">Type * getReturnType() const</div><div class="ttdef"><b>Definition</b> <a href="DerivedTypes_8h_source.html#l00129">DerivedTypes.h:129</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00061">Function.h:61</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a05d7aedbbdc0fd24e8bc27edfe9c603f"><div class="ttname"><a href="classllvm_1_1Function.html#a05d7aedbbdc0fd24e8bc27edfe9c603f">llvm::Function::Create</a></div><div class="ttdeci">static Function * Create(FunctionType *Ty, LinkageTypes Linkage, unsigned AddrSpace, const Twine &amp;N=&quot;&quot;, Module *M=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00137">Function.h:137</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a169f0c26ef46161741fdd120a806f853"><div class="ttname"><a href="classllvm_1_1Function.html#a169f0c26ef46161741fdd120a806f853">llvm::Function::getEntryBlock</a></div><div class="ttdeci">const BasicBlock &amp; getEntryBlock() const</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00689">Function.h:689</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a7477aafbbe989ad35b96fac186d8e9fd"><div class="ttname"><a href="classllvm_1_1Function.html#a7477aafbbe989ad35b96fac186d8e9fd">llvm::Function::getAttributes</a></div><div class="ttdeci">AttributeList getAttributes() const</div><div class="ttdoc">Return the attribute list for this Function.</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00230">Function.h:230</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a8300ac1ef141b8a7c63c13fa9369d976"><div class="ttname"><a href="classllvm_1_1Function.html#a8300ac1ef141b8a7c63c13fa9369d976">llvm::Function::arg_end</a></div><div class="ttdeci">arg_iterator arg_end()</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00729">Function.h:729</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a8743c58384e11cb6228f6f871304ad35"><div class="ttname"><a href="classllvm_1_1Function.html#a8743c58384e11cb6228f6f871304ad35">llvm::Function::getFunction</a></div><div class="ttdeci">const Function &amp; getFunction() const</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00135">Function.h:135</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a8bf193a781a92cae52d7f9216d0824f8"><div class="ttname"><a href="classllvm_1_1Function.html#a8bf193a781a92cae52d7f9216d0824f8">llvm::Function::arg_begin</a></div><div class="ttdeci">arg_iterator arg_begin()</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00720">Function.h:720</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9e4c6c67f4b2528b5648299db4a86926"><div class="ttname"><a href="classllvm_1_1Function.html#a9e4c6c67f4b2528b5648299db4a86926">llvm::Function::setAttributes</a></div><div class="ttdeci">void setAttributes(AttributeList Attrs)</div><div class="ttdoc">Set the attribute list for this Function.</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00233">Function.h:233</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_a9fffac2512fe651f0d5e37e27f5bd51c"><div class="ttname"><a href="classllvm_1_1Function.html#a9fffac2512fe651f0d5e37e27f5bd51c">llvm::Function::getContext</a></div><div class="ttdeci">LLVMContext &amp; getContext() const</div><div class="ttdoc">getContext - Return a reference to the LLVMContext associated with this function.</div><div class="ttdef"><b>Definition</b> <a href="Function_8cpp_source.html#l00252">Function.cpp:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_aa5087b607af833220d9ebab0c88c83c1"><div class="ttname"><a href="classllvm_1_1Function.html#aa5087b607af833220d9ebab0c88c83c1">llvm::Function::addParamAttr</a></div><div class="ttdeci">void addParamAttr(unsigned ArgNo, Attribute::AttrKind Kind)</div><div class="ttdoc">adds the attribute to the list of attributes for the given arg.</div><div class="ttdef"><b>Definition</b> <a href="Function_8cpp_source.html#l00458">Function.cpp:458</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html_ae6db8746934e6feae3649a8709fce3cc"><div class="ttname"><a href="classllvm_1_1Function.html#ae6db8746934e6feae3649a8709fce3cc">llvm::Function::setCallingConv</a></div><div class="ttdeci">void setCallingConv(CallingConv::ID CC)</div><div class="ttdef"><b>Definition</b> <a href="Function_8h_source.html#l00223">Function.h:223</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a28b9561d9ef3d237ef894023187fa26c"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a28b9561d9ef3d237ef894023187fa26c">llvm::GlobalValue::getVisibility</a></div><div class="ttdeci">VisibilityTypes getVisibility() const</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00229">GlobalValue.h:229</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a3547d58a060ee2e4a29cbea85bef91af"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a3547d58a060ee2e4a29cbea85bef91af">llvm::GlobalValue::getLinkage</a></div><div class="ttdeci">LinkageTypes getLinkage() const</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00461">GlobalValue.h:461</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a38c97622dccff7ae31fe0be3b21c9b3d"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a38c97622dccff7ae31fe0be3b21c9b3d">llvm::GlobalValue::setUnnamedAddr</a></div><div class="ttdeci">void setUnnamedAddr(UnnamedAddr Val)</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00212">GlobalValue.h:212</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a40c699aba3d6b469357ef0b4e1aa2580"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a40c699aba3d6b469357ef0b4e1aa2580">llvm::GlobalValue::setDLLStorageClass</a></div><div class="ttdeci">void setDLLStorageClass(DLLStorageClassTypes C)</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00265">GlobalValue.h:265</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a687973de03d041e04b50a76d19d4fd36"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a687973de03d041e04b50a76d19d4fd36">llvm::GlobalValue::setLinkage</a></div><div class="ttdeci">void setLinkage(LinkageTypes LT)</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00454">GlobalValue.h:454</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a739b30c811f1eece61b05320ddf44e5b"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a739b30c811f1eece61b05320ddf44e5b">llvm::GlobalValue::getParent</a></div><div class="ttdeci">Module * getParent()</div><div class="ttdoc">Get the module that this global value is contained inside of...</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00572">GlobalValue.h:572</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_a913a5d4b2cddde762446bd494e81a3f2"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#a913a5d4b2cddde762446bd494e81a3f2">llvm::GlobalValue::getType</a></div><div class="ttdeci">PointerType * getType() const</div><div class="ttdoc">Global values are always pointers.</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00271">GlobalValue.h:271</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aa242d8ab89216c14beab812e07009b2a"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aa242d8ab89216c14beab812e07009b2a">llvm::GlobalValue::setVisibility</a></div><div class="ttdeci">void setVisibility(VisibilityTypes V)</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00235">GlobalValue.h:235</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_ac2417a3c6edd0db7a9ad84b82c4054b7"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#ac2417a3c6edd0db7a9ad84b82c4054b7">llvm::GlobalValue::getUnnamedAddr</a></div><div class="ttdeci">UnnamedAddr getUnnamedAddr() const</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00209">GlobalValue.h:209</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#aedfa75f0c85c4aa85b257f066fbea57ca6c93794d7b99cd433e96c53eadb15a6e">llvm::GlobalValue::ExternalLinkage</a></div><div class="ttdeci">@ ExternalLinkage</div><div class="ttdoc">Externally visible function.</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00048">GlobalValue.h:48</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalValue_html_af09a662b4e302d0683d0fe9dc2a9335f"><div class="ttname"><a href="classllvm_1_1GlobalValue.html#af09a662b4e302d0683d0fe9dc2a9335f">llvm::GlobalValue::getDLLStorageClass</a></div><div class="ttdeci">DLLStorageClassTypes getDLLStorageClass() const</div><div class="ttdef"><b>Definition</b> <a href="GlobalValue_8h_source.html#l00256">GlobalValue.h:256</a></div></div>
<div class="ttc" id="aclassllvm_1_1GlobalVariable_html"><div class="ttname"><a href="classllvm_1_1GlobalVariable.html">llvm::GlobalVariable</a></div><div class="ttdef"><b>Definition</b> <a href="GlobalVariable_8h_source.html#l00040">GlobalVariable.h:40</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8h_source.html#l00045">Instruction.h:46</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a5e6364c710de3afb5449588baab260fd"><div class="ttname"><a href="classllvm_1_1Instruction.html#a5e6364c710de3afb5449588baab260fd">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8h_source.html#l00094">Instruction.h:94</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition</b> <a href="IR_2Instruction_8cpp_source.html#l00080">Instruction.cpp:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition</b> <a href="LLVMContext_8h_source.html#l00068">LLVMContext.h:68</a></div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html_aac05e688583e3d2bb9b04f767b22ac32a8997c6b0930e2c05209e95e7172c6cf3"><div class="ttname"><a href="classllvm_1_1LLVMContext.html#aac05e688583e3d2bb9b04f767b22ac32a8997c6b0930e2c05209e95e7172c6cf3">llvm::LLVMContext::OB_funclet</a></div><div class="ttdeci">@ OB_funclet</div><div class="ttdef"><b>Definition</b> <a href="LLVMContext_8h_source.html#l00091">LLVMContext.h:91</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1Node_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1Node.html">llvm::LazyCallGraph::Node</a></div><div class="ttdoc">A node in the call graph.</div><div class="ttdef"><b>Definition</b> <a href="LazyCallGraph_8h_source.html#l00327">LazyCallGraph.h:327</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_1_1SCC_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph_1_1SCC.html">llvm::LazyCallGraph::SCC</a></div><div class="ttdoc">An SCC of the call graph.</div><div class="ttdef"><b>Definition</b> <a href="LazyCallGraph_8h_source.html#l00431">LazyCallGraph.h:431</a></div></div>
<div class="ttc" id="aclassllvm_1_1LazyCallGraph_html"><div class="ttname"><a href="classllvm_1_1LazyCallGraph.html">llvm::LazyCallGraph</a></div><div class="ttdoc">A lazily constructed view of the call graph of a module.</div><div class="ttdef"><b>Definition</b> <a href="LazyCallGraph_8h_source.html#l00112">LazyCallGraph.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineBasicBlock_html_acf6442108e21e7e5379feb8962de65b7"><div class="ttname"><a href="classllvm_1_1MachineBasicBlock.html#acf6442108e21e7e5379feb8962de65b7">llvm::MachineBasicBlock::getParent</a></div><div class="ttdeci">const MachineFunction * getParent() const</div><div class="ttdoc">Return the MachineFunction containing this basic block.</div><div class="ttdef"><b>Definition</b> <a href="MachineBasicBlock_8h_source.html#l00217">MachineBasicBlock.h:217</a></div></div>
<div class="ttc" id="aclassllvm_1_1MachineFunction_html_a82dd10b626a629b9bb7d32d53a8e0884"><div class="ttname"><a href="classllvm_1_1MachineFunction.html#a82dd10b626a629b9bb7d32d53a8e0884">llvm::MachineFunction::getDataLayout</a></div><div class="ttdeci">const DataLayout &amp; getDataLayout() const</div><div class="ttdoc">Return the DataLayout attached to the Module associated to this MF.</div><div class="ttdef"><b>Definition</b> <a href="MachineFunction_8cpp_source.html#l00260">MachineFunction.cpp:260</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition</b> <a href="Module_8h_source.html#l00067">Module.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a209a615a3a32241323420cca24b5520a"><div class="ttname"><a href="classllvm_1_1Module.html#a209a615a3a32241323420cca24b5520a">llvm::Module::getFunction</a></div><div class="ttdeci">Function * getFunction(StringRef Name) const</div><div class="ttdoc">Look up the specified function in the module symbol table.</div><div class="ttdef"><b>Definition</b> <a href="Module_8cpp_source.html#l00174">Module.cpp:174</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_a7893161303eb07ae7864db6b3d004d9e"><div class="ttname"><a href="classllvm_1_1Module.html#a7893161303eb07ae7864db6b3d004d9e">llvm::Module::iterator</a></div><div class="ttdeci">FunctionListType::iterator iterator</div><div class="ttdoc">The Function iterators.</div><div class="ttdef"><b>Definition</b> <a href="Module_8h_source.html#l00092">Module.h:92</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html_aa608a2d900dd6c15c18f4236b6548496"><div class="ttname"><a href="classllvm_1_1Module.html#aa608a2d900dd6c15c18f4236b6548496">llvm::Module::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition</b> <a href="Module_8h_source.html#l00612">Module.h:612</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l02535">Instructions.h:2535</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a923cca615da7f7e3387cf7a87fc53cad"><div class="ttname"><a href="classllvm_1_1PHINode.html#a923cca615da7f7e3387cf7a87fc53cad">llvm::PHINode::Create</a></div><div class="ttdeci">static PHINode * Create(Type *Ty, unsigned NumReservedValues, const Twine &amp;NameStr=&quot;&quot;, Instruction *InsertBefore=nullptr)</div><div class="ttdoc">Constructors - NumReservedValues is a hint for the number of incoming edges that this phi node will h...</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l02575">Instructions.h:2575</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition</b> <a href="PassRegistry_8cpp_source.html#l00031">PassRegistry.cpp:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1Pass_html"><div class="ttname"><a href="classllvm_1_1Pass.html">llvm::Pass</a></div><div class="ttdoc">Pass interface - Implemented by all 'passes'.</div><div class="ttdef"><b>Definition</b> <a href="Pass_8h_source.html#l00077">Pass.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html">llvm::PreservedAnalyses</a></div><div class="ttdoc">A set of analyses that are preserved following a run of a transformation pass.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00154">PassManager.h:154</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a03797a73044a81cbc6a3409d6c72ee8f"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a03797a73044a81cbc6a3409d6c72ee8f">llvm::PreservedAnalyses::none</a></div><div class="ttdeci">static PreservedAnalyses none()</div><div class="ttdoc">Convenience factory function for the empty preserved set.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00157">PassManager.h:157</a></div></div>
<div class="ttc" id="aclassllvm_1_1PreservedAnalyses_html_a1258a1ff55557c27684010ebd7283712"><div class="ttname"><a href="classllvm_1_1PreservedAnalyses.html#a1258a1ff55557c27684010ebd7283712">llvm::PreservedAnalyses::all</a></div><div class="ttdeci">static PreservedAnalyses all()</div><div class="ttdoc">Construct a special preserved set that preserves all passes.</div><div class="ttdef"><b>Definition</b> <a href="PassManager_8h_source.html#l00160">PassManager.h:160</a></div></div>
<div class="ttc" id="aclassllvm_1_1PrettyStackTraceEntry_html"><div class="ttname"><a href="classllvm_1_1PrettyStackTraceEntry.html">llvm::PrettyStackTraceEntry</a></div><div class="ttdoc">PrettyStackTraceEntry - This class is used to represent a frame of the &quot;pretty&quot; stack trace that is d...</div><div class="ttdef"><b>Definition</b> <a href="PrettyStackTrace_8h_source.html#l00052">PrettyStackTrace.h:52</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html"><div class="ttname"><a href="classllvm_1_1ReturnInst.html">llvm::ReturnInst</a></div><div class="ttdoc">Return a value (possibly void), from a function.</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l02877">Instructions.h:2877</a></div></div>
<div class="ttc" id="aclassllvm_1_1ReturnInst_html_ae4f6f04648c60d8e135a2a740a2eb0e1"><div class="ttname"><a href="classllvm_1_1ReturnInst.html#ae4f6f04648c60d8e135a2a740a2eb0e1">llvm::ReturnInst::Create</a></div><div class="ttdeci">static ReturnInst * Create(LLVMContext &amp;C, Value *retVal=nullptr, Instruction *InsertBefore=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="Instructions_8h_source.html#l02904">Instructions.h:2904</a></div></div>
<div class="ttc" id="aclassllvm_1_1StringRef_html"><div class="ttname"><a href="classllvm_1_1StringRef.html">llvm::StringRef</a></div><div class="ttdoc">StringRef - Represent a constant reference to a string, i.e.</div><div class="ttdef"><b>Definition</b> <a href="StringRef_8h_source.html#l00057">StringRef.h:57</a></div></div>
<div class="ttc" id="aclassllvm_1_1Twine_html"><div class="ttname"><a href="classllvm_1_1Twine.html">llvm::Twine</a></div><div class="ttdoc">Twine - A lightweight data structure for efficiently representing the concatenation of temporary valu...</div><div class="ttdef"><b>Definition</b> <a href="Twine_8h_source.html#l00080">Twine.h:80</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition</b> <a href="Type_8h_source.html#l00046">Type.h:46</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_adc01a7457de85fc52a3bb860d7e1c6a4"><div class="ttname"><a href="classllvm_1_1Type.html#adc01a7457de85fc52a3bb860d7e1c6a4">llvm::Type::getPointerTo</a></div><div class="ttdeci">PointerType * getPointerTo(unsigned AddrSpace=0) const</div><div class="ttdoc">Return a pointer to the current type.</div><div class="ttdef"><b>Definition</b> <a href="Type_8cpp_source.html#l00681">Type.cpp:681</a></div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html"><div class="ttname"><a href="classllvm_1_1UndefValue.html">llvm::UndefValue</a></div><div class="ttdoc">'undef' values are things that do not have specified contents.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8h_source.html#l01309">Constants.h:1309</a></div></div>
<div class="ttc" id="aclassllvm_1_1UndefValue_html_a4ae5ff22b700a42bcc5d889233721335"><div class="ttname"><a href="classllvm_1_1UndefValue.html#a4ae5ff22b700a42bcc5d889233721335">llvm::UndefValue::get</a></div><div class="ttdeci">static UndefValue * get(Type *T)</div><div class="ttdoc">Static factory methods - Return an 'undef' object of the specified type.</div><div class="ttdef"><b>Definition</b> <a href="Constants_8cpp_source.html#l01665">Constants.cpp:1665</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition</b> <a href="Use_8h_source.html#l00044">Use.h:44</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a53a48d67682705c5f7f06ffc850fd622"><div class="ttname"><a href="classllvm_1_1Use.html#a53a48d67682705c5f7f06ffc850fd622">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition</b> <a href="Use_8h_source.html#l00073">Use.h:73</a></div></div>
<div class="ttc" id="aclassllvm_1_1ValueMap_html"><div class="ttname"><a href="classllvm_1_1ValueMap.html">llvm::ValueMap&lt; const Value *, WeakTrackingVH &gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition</b> <a href="Value_8h_source.html#l00074">Value.h:74</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a0344a49526443edf90cc0aef3abd3337"><div class="ttname"><a href="classllvm_1_1Value.html#a0344a49526443edf90cc0aef3abd3337">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition</b> <a href="Value_8h_source.html#l00244">Value.h:244</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a35ee267850af7c235474a8c46c7ac5af"><div class="ttname"><a href="classllvm_1_1Value.html#a35ee267850af7c235474a8c46c7ac5af">llvm::Value::setName</a></div><div class="ttdeci">void setName(const Twine &amp;Name)</div><div class="ttdoc">Change the name of the value.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00342">Value.cpp:342</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a3ab5fc45117b450e8bb04e564cb6e5f2"><div class="ttname"><a href="classllvm_1_1Value.html#a3ab5fc45117b450e8bb04e564cb6e5f2">llvm::Value::replaceAllUsesWith</a></div><div class="ttdeci">void replaceAllUsesWith(Value *V)</div><div class="ttdoc">Change all uses of this to point to a new Value.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00486">Value.cpp:486</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a966eb231e7d4e572874d2cb49b18faea"><div class="ttname"><a href="classllvm_1_1Value.html#a966eb231e7d4e572874d2cb49b18faea">llvm::Value::stripPointerCasts</a></div><div class="ttdeci">const Value * stripPointerCasts() const</div><div class="ttdoc">Strip off pointer casts, all-zero GEPs and address space casts.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00593">Value.cpp:593</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_adb5c319f5905c1d3ca9eb5df546388c5"><div class="ttname"><a href="classllvm_1_1Value.html#adb5c319f5905c1d3ca9eb5df546388c5">llvm::Value::getName</a></div><div class="ttdeci">StringRef getName() const</div><div class="ttdoc">Return a constant reference to the value's name.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00270">Value.cpp:270</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_ae855357b6c5e6e7ed1869272708a3a84"><div class="ttname"><a href="classllvm_1_1Value.html#ae855357b6c5e6e7ed1869272708a3a84">llvm::Value::takeName</a></div><div class="ttdeci">void takeName(Value *V)</div><div class="ttdoc">Transfer the name from V to this value.</div><div class="ttdef"><b>Definition</b> <a href="Value_8cpp_source.html#l00348">Value.cpp:348</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html">llvm::ilist_node_impl</a></div><div class="ttdoc">Implementation for an ilist node.</div><div class="ttdef"><b>Definition</b> <a href="ilist__node_8h_source.html#l00039">ilist_node.h:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a1dfdcf6998ec28bfd2f8d2cdebc984a9"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a1dfdcf6998ec28bfd2f8d2cdebc984a9">llvm::ilist_node_with_parent::getPrevNode</a></div><div class="ttdeci">NodeTy * getPrevNode()</div><div class="ttdef"><b>Definition</b> <a href="ilist__node_8h_source.html#l00274">ilist_node.h:274</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__with__parent_html_a62ee7ece4986606d41363bc1f70d5ab2"><div class="ttname"><a href="classllvm_1_1ilist__node__with__parent.html#a62ee7ece4986606d41363bc1f70d5ab2">llvm::ilist_node_with_parent::getNextNode</a></div><div class="ttdeci">NodeTy * getNextNode()</div><div class="ttdoc">Get the next node, or nullptr for the list tail.</div><div class="ttdef"><b>Definition</b> <a href="ilist__node_8h_source.html#l00288">ilist_node.h:288</a></div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html">llvm::legacy::FunctionPassManager</a></div><div class="ttdoc">FunctionPassManager manages FunctionPasses.</div><div class="ttdef"><b>Definition</b> <a href="LegacyPassManager_8h_source.html#l00067">LegacyPassManager.h:67</a></div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html_a02e592cc8ca8a049fbe052f809514c73"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html#a02e592cc8ca8a049fbe052f809514c73">llvm::legacy::FunctionPassManager::run</a></div><div class="ttdeci">bool run(Function &amp;F)</div><div class="ttdoc">run - Execute all of the passes scheduled for execution.</div><div class="ttdef"><b>Definition</b> <a href="LegacyPassManager_8cpp_source.html#l01431">LegacyPassManager.cpp:1431</a></div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html_a1bec72c759c38b748ff60434eb4d0c80"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html#a1bec72c759c38b748ff60434eb4d0c80">llvm::legacy::FunctionPassManager::add</a></div><div class="ttdeci">void add(Pass *P) override</div><div class="ttdoc">Add a pass to the queue of passes to run.</div><div class="ttdef"><b>Definition</b> <a href="LegacyPassManager_8cpp_source.html#l01423">LegacyPassManager.cpp:1423</a></div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html_a7cb64dd75fa1775aeb32cde0bc17b72a"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html#a7cb64dd75fa1775aeb32cde0bc17b72a">llvm::legacy::FunctionPassManager::doInitialization</a></div><div class="ttdeci">bool doInitialization()</div><div class="ttdoc">doInitialization - Run all of the initializers for the function passes.</div><div class="ttdef"><b>Definition</b> <a href="LegacyPassManager_8cpp_source.html#l01441">LegacyPassManager.cpp:1441</a></div></div>
<div class="ttc" id="aclassllvm_1_1legacy_1_1FunctionPassManager_html_aabcf819b6866d85a9fc8f882ff0e9ead"><div class="ttname"><a href="classllvm_1_1legacy_1_1FunctionPassManager.html#aabcf819b6866d85a9fc8f882ff0e9ead">llvm::legacy::FunctionPassManager::doFinalization</a></div><div class="ttdeci">bool doFinalization()</div><div class="ttdoc">doFinalization - Run all of the finalizers for the function passes.</div><div class="ttdef"><b>Definition</b> <a href="LegacyPassManager_8cpp_source.html#l01447">LegacyPassManager.cpp:1447</a></div></div>
<div class="ttc" id="aclassllvm_1_1raw__ostream_html"><div class="ttname"><a href="classllvm_1_1raw__ostream.html">llvm::raw_ostream</a></div><div class="ttdoc">This class implements an extremely fast bulk output stream that can only output to a stream.</div><div class="ttdef"><b>Definition</b> <a href="raw__ostream_8h_source.html#l00046">raw_ostream.h:46</a></div></div>
<div class="ttc" id="allvm_2Support_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition</b> <a href="llvm_2Support_2ErrorHandling_8h_source.html#l00136">ErrorHandling.h:136</a></div></div>
<div class="ttc" id="allvm_2Transforms_2Scalar_8h_html"><div class="ttname"><a href="llvm_2Transforms_2Scalar_8h.html">Scalar.h</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition</b> <a href="StackSlotColoring_8cpp_source.html#l00142">StackSlotColoring.cpp:142</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition</b> <a href="AMDGPUMetadata_8h_source.html#l00378">AMDGPUMetadata.h:378</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">llvm::MCID::Branch</a></div><div class="ttdeci">@ Branch</div><div class="ttdef"><b>Definition</b> <a href="MCInstrDesc_8h_source.html#l00148">MCInstrDesc.h:148</a></div></div>
<div class="ttc" id="anamespacellvm_1_1MCID_html_ab357441fcd1ea1f9b0d27c12700f6023a5416d9f1bd5f533efddadf17d713e469"><div class="ttname"><a href="namespacellvm_1_1MCID.html#ab357441fcd1ea1f9b0d27c12700f6023a5416d9f1bd5f533efddadf17d713e469">llvm::MCID::Return</a></div><div class="ttdeci">@ Return</div><div class="ttdef"><b>Definition</b> <a href="MCInstrDesc_8h_source.html#l00143">MCInstrDesc.h:143</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_ac8789a4d36d2b7d2c4baf84cf9021279a5069619ca8fdce305534f3fe85091a0f"><div class="ttname"><a href="namespacellvm_1_1SPII.html#ac8789a4d36d2b7d2c4baf84cf9021279a5069619ca8fdce305534f3fe85091a0f">llvm::SPII::Load</a></div><div class="ttdeci">@ Load</div><div class="ttdef"><b>Definition</b> <a href="SparcInstrInfo_8h_source.html#l00032">SparcInstrInfo.h:32</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b"><div class="ttname"><a href="namespacellvm_1_1coro.html#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">llvm::coro::ABI::Switch</a></div><div class="ttdeci">@ Switch</div><div class="ttdoc">The &quot;resume-switch&quot; lowering, where there are separate resume and destroy functions that are shared b...</div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_a6e95f844cc43fa4786df11ea5a1a3f10"><div class="ttname"><a href="namespacellvm_1_1coro.html#a6e95f844cc43fa4786df11ea5a1a3f10">llvm::coro::declaresIntrinsics</a></div><div class="ttdeci">bool declaresIntrinsics(const Module &amp;M, const std::initializer_list&lt; StringRef &gt;)</div><div class="ttdef"><b>Definition</b> <a href="Coroutines_8cpp_source.html#l00153">Coroutines.cpp:153</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_aa5afa83874bf2b24b54fc07894df1add"><div class="ttname"><a href="namespacellvm_1_1coro.html#aa5afa83874bf2b24b54fc07894df1add">llvm::coro::updateCallGraph</a></div><div class="ttdeci">void updateCallGraph(Function &amp;Caller, ArrayRef&lt; Function * &gt; Funcs, CallGraph &amp;CG, CallGraphSCC &amp;SCC)</div><div class="ttdef"><b>Definition</b> <a href="Coroutines_8cpp_source.html#l00207">Coroutines.cpp:207</a></div></div>
<div class="ttc" id="anamespacellvm_1_1coro_html_abf799de7147065c0e7f525e1b6009dde"><div class="ttname"><a href="namespacellvm_1_1coro.html#abf799de7147065c0e7f525e1b6009dde">llvm::coro::replaceCoroFree</a></div><div class="ttdeci">void replaceCoroFree(CoroIdInst *CoroId, bool Elide)</div><div class="ttdef"><b>Definition</b> <a href="Coroutines_8cpp_source.html#l00166">Coroutines.cpp:166</a></div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">This class represents lattice values for constants.</div><div class="ttdef"><b>Definition</b> <a href="AllocatorList_8h_source.html#l00023">AllocatorList.h:23</a></div></div>
<div class="ttc" id="anamespacellvm_html_a10388349dcc2684049303ffe10e271af"><div class="ttname"><a href="namespacellvm.html#a10388349dcc2684049303ffe10e271af">llvm::createCoroSplitLegacyPass</a></div><div class="ttdeci">Pass * createCoroSplitLegacyPass()</div><div class="ttdoc">Split up coroutines into multiple functions driving their state machines.</div><div class="ttdef"><b>Definition</b> <a href="#l01810">CoroSplit.cpp:1810</a></div></div>
<div class="ttc" id="anamespacellvm_html_a26389c546573f058ad8ecbdc5c1933cf"><div class="ttname"><a href="namespacellvm.html#a26389c546573f058ad8ecbdc5c1933cf">llvm::verifyFunction</a></div><div class="ttdeci">bool verifyFunction(const Function &amp;F, raw_ostream *OS=nullptr)</div><div class="ttdoc">Check a function for errors, useful for use when debugging a pass.</div><div class="ttdef"><b>Definition</b> <a href="Verifier_8cpp_source.html#l05433">Verifier.cpp:5433</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2ccc7974c411d5dc087a920b621d73b6"><div class="ttname"><a href="namespacellvm.html#a2ccc7974c411d5dc087a920b621d73b6">llvm::createSCCPPass</a></div><div class="ttdeci">FunctionPass * createSCCPPass()</div><div class="ttdef"><b>Definition</b> <a href="Scalar_2SCCP_8cpp_source.html#l01789">SCCP.cpp:1789</a></div></div>
<div class="ttc" id="anamespacellvm_html_a2e739fb4907159062aacbbafea669592"><div class="ttname"><a href="namespacellvm.html#a2e739fb4907159062aacbbafea669592">llvm::updateCGAndAnalysisManagerForCGSCCPass</a></div><div class="ttdeci">LazyCallGraph::SCC &amp; updateCGAndAnalysisManagerForCGSCCPass(LazyCallGraph &amp;G, LazyCallGraph::SCC &amp;C, LazyCallGraph::Node &amp;N, CGSCCAnalysisManager &amp;AM, CGSCCUpdateResult &amp;UR, FunctionAnalysisManager &amp;FAM)</div><div class="ttdoc">Helper to update the call graph after running a CGSCC pass.</div><div class="ttdef"><b>Definition</b> <a href="CGSCCPassManager_8cpp_source.html#l00758">CGSCCPassManager.cpp:758</a></div></div>
<div class="ttc" id="anamespacellvm_html_a3403fbb934119728341c679714eafa1b"><div class="ttname"><a href="namespacellvm.html#a3403fbb934119728341c679714eafa1b">llvm::createCFGSimplificationPass</a></div><div class="ttdeci">FunctionPass * createCFGSimplificationPass(unsigned Threshold=1, bool ForwardSwitchCond=false, bool ConvertSwitch=false, bool KeepLoops=true, bool SinkCommon=false, std::function&lt; bool(const Function &amp;)&gt; Ftor=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="SimplifyCFGPass_8cpp_source.html#l00313">SimplifyCFGPass.cpp:313</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7c46c742c31be54870e2038048e6b391"><div class="ttname"><a href="namespacellvm.html#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a></div><div class="ttdeci">raw_ostream &amp; dbgs()</div><div class="ttdoc">dbgs() - This returns a reference to a raw_ostream for debugging messages.</div><div class="ttdef"><b>Definition</b> <a href="Debug_8cpp_source.html#l00132">Debug.cpp:132</a></div></div>
<div class="ttc" id="anamespacellvm_html_a7f2a3d4dcfee70225988aec53ff1e173"><div class="ttname"><a href="namespacellvm.html#a7f2a3d4dcfee70225988aec53ff1e173">llvm::report_fatal_error</a></div><div class="ttdeci">LLVM_ATTRIBUTE_NORETURN void report_fatal_error(Error Err, bool gen_crash_diag=true)</div><div class="ttdoc">Report a serious error, calling any installed error handler.</div><div class="ttdef"><b>Definition</b> <a href="Testing_2Support_2Error_8cpp_source.html#l00140">Error.cpp:140</a></div></div>
<div class="ttc" id="anamespacellvm_html_a8159450ad7c9465105524275ca0d09e6"><div class="ttname"><a href="namespacellvm.html#a8159450ad7c9465105524275ca0d09e6">llvm::initializeCoroSplitLegacyPass</a></div><div class="ttdeci">void initializeCoroSplitLegacyPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="anamespacellvm_html_a91d9d210ba428cc67e3c2e892f24529e"><div class="ttname"><a href="namespacellvm.html#a91d9d210ba428cc67e3c2e892f24529e">llvm::predecessors</a></div><div class="ttdeci">pred_range predecessors(BasicBlock *BB)</div><div class="ttdef"><b>Definition</b> <a href="IR_2CFG_8h_source.html#l00125">CFG.h:125</a></div></div>
<div class="ttc" id="anamespacellvm_html_a9a7b5c68c90f85baaedaa854cc5002cc"><div class="ttname"><a href="namespacellvm.html#a9a7b5c68c90f85baaedaa854cc5002cc">llvm::errs</a></div><div class="ttdeci">raw_fd_ostream &amp; errs()</div><div class="ttdoc">This returns a reference to a raw_ostream for standard error.</div><div class="ttdef"><b>Definition</b> <a href="raw__ostream_8cpp_source.html#l00878">raw_ostream.cpp:878</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa6aa39b86007ee97f50248d2fb1b7220"><div class="ttname"><a href="namespacellvm.html#aa6aa39b86007ee97f50248d2fb1b7220">llvm::ReplaceInstWithInst</a></div><div class="ttdeci">void ReplaceInstWithInst(BasicBlock::InstListType &amp;BIL, BasicBlock::iterator &amp;BI, Instruction *I)</div><div class="ttdoc">Replace the instruction specified by BI with the instruction specified by I.</div><div class="ttdef"><b>Definition</b> <a href="BasicBlockUtils_8cpp_source.html#l00475">BasicBlockUtils.cpp:475</a></div></div>
<div class="ttc" id="anamespacellvm_html_ae28159c054fa79ac71652e2bb0972082"><div class="ttname"><a href="namespacellvm.html#ae28159c054fa79ac71652e2bb0972082">llvm::createEarlyCSEPass</a></div><div class="ttdeci">FunctionPass * createEarlyCSEPass(bool UseMemorySSA=false)</div><div class="ttdef"><b>Definition</b> <a href="EarlyCSE_8cpp_source.html#l01476">EarlyCSE.cpp:1476</a></div></div>
<div class="ttc" id="anamespacellvm_html_aec88b7682025edff7984c3b6c8da8ac9"><div class="ttname"><a href="namespacellvm.html#aec88b7682025edff7984c3b6c8da8ac9">llvm::removeUnreachableBlocks</a></div><div class="ttdeci">bool removeUnreachableBlocks(Function &amp;F, DomTreeUpdater *DTU=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Remove all blocks that can not be reached from the function's entry.</div><div class="ttdef"><b>Definition</b> <a href="Local_8cpp_source.html#l02263">Local.cpp:2263</a></div></div>
<div class="ttc" id="anamespacellvm_html_af773509e734af567c96f833f39247401"><div class="ttname"><a href="namespacellvm.html#af773509e734af567c96f833f39247401">llvm::CloneFunctionInto</a></div><div class="ttdeci">void CloneFunctionInto(Function *NewFunc, const Function *OldFunc, ValueToValueMapTy &amp;VMap, bool ModuleLevelChanges, SmallVectorImpl&lt; ReturnInst * &gt; &amp;Returns, const char *NameSuffix=&quot;&quot;, ClonedCodeInfo *CodeInfo=nullptr, ValueMapTypeRemapper *TypeMapper=nullptr, ValueMaterializer *Materializer=nullptr)</div><div class="ttdoc">Clone OldFunc into NewFunc, transforming the old arguments into references to VMap values.</div><div class="ttdef"><b>Definition</b> <a href="CloneFunction_8cpp_source.html#l00081">CloneFunction.cpp:81</a></div></div>
<div class="ttc" id="anamespacellvm_html_afe3f17791a010d9d25790fc87ee3cca9"><div class="ttname"><a href="namespacellvm.html#afe3f17791a010d9d25790fc87ee3cca9">llvm::changeToUnreachable</a></div><div class="ttdeci">unsigned changeToUnreachable(Instruction *I, bool UseLLVMTrap, bool PreserveLCSSA=false, DomTreeUpdater *DTU=nullptr, MemorySSAUpdater *MSSAU=nullptr)</div><div class="ttdoc">Insert an unreachable instruction before the specified instruction, making it and the rest of the cod...</div><div class="ttdef"><b>Definition</b> <a href="Local_8cpp_source.html#l01935">Local.cpp:1935</a></div></div>
<div class="ttc" id="anamespacestd_html_ab8424022895aee3e366fb9a32f2883cb"><div class="ttname"><a href="namespacestd.html#ab8424022895aee3e366fb9a32f2883cb">std::swap</a></div><div class="ttdeci">void swap(llvm::BitVector &amp;LHS, llvm::BitVector &amp;RHS)</div><div class="ttdoc">Implement std::swap in terms of BitVector swap.</div><div class="ttdef"><b>Definition</b> <a href="BitVector_8h_source.html#l00962">BitVector.h:962</a></div></div>
<div class="ttc" id="araw__ostream_8h_html"><div class="ttname"><a href="raw__ostream_8h.html">raw_ostream.h</a></div></div>
<div class="ttc" id="aregcomp_8c_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="regcomp_8c.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div></div>
<div class="ttc" id="astructllvm_1_1Align_html"><div class="ttname"><a href="structllvm_1_1Align.html">llvm::Align</a></div><div class="ttdoc">This struct is a compact representation of a valid (non-zero power of two) alignment.</div><div class="ttdef"><b>Definition</b> <a href="Alignment_8h_source.html#l00039">Alignment.h:39</a></div></div>
<div class="ttc" id="astructllvm_1_1CGSCCUpdateResult_html"><div class="ttname"><a href="structllvm_1_1CGSCCUpdateResult.html">llvm::CGSCCUpdateResult</a></div><div class="ttdoc">Support structure for SCC passes to communicate updates the call graph back to the CGSCC pass manager...</div><div class="ttdef"><b>Definition</b> <a href="CGSCCPassManager_8h_source.html#l00231">CGSCCPassManager.h:231</a></div></div>
<div class="ttc" id="astructllvm_1_1CGSCCUpdateResult_html_a277c9d45b3b20308e166249fd56598ed"><div class="ttname"><a href="structllvm_1_1CGSCCUpdateResult.html#a277c9d45b3b20308e166249fd56598ed">llvm::CGSCCUpdateResult::CWorklist</a></div><div class="ttdeci">SmallPriorityWorklist&lt; LazyCallGraph::SCC *, 1 &gt; &amp; CWorklist</div><div class="ttdoc">Worklist of the SCCs queued for processing.</div><div class="ttdef"><b>Definition</b> <a href="CGSCCPassManager_8h_source.html#l00256">CGSCCPassManager.h:256</a></div></div>
<div class="ttc" id="astructllvm_1_1CoroSplitPass_html_a47f6589634ad33a13369ace133b9f4b2"><div class="ttname"><a href="structllvm_1_1CoroSplitPass.html#a47f6589634ad33a13369ace133b9f4b2">llvm::CoroSplitPass::run</a></div><div class="ttdeci">PreservedAnalyses run(LazyCallGraph::SCC &amp;C, CGSCCAnalysisManager &amp;AM, LazyCallGraph &amp;CG, CGSCCUpdateResult &amp;UR)</div><div class="ttdef"><b>Definition</b> <a href="#l01645">CoroSplit.cpp:1645</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1LowererBase_html"><div class="ttname"><a href="structllvm_1_1coro_1_1LowererBase.html">llvm::coro::LowererBase</a></div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00055">CoroInternal.h:55</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_a4df922b446b5bfca3248510df728539b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a4df922b446b5bfca3248510df728539b">llvm::coro::Shape::RetconLoweringStorage::IsFrameInlineInStorage</a></div><div class="ttdeci">bool IsFrameInlineInStorage</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00132">CoroInternal.h:132</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_a872685aee4d3b7567d0538ccaa326228"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#a872685aee4d3b7567d0538ccaa326228">llvm::coro::Shape::RetconLoweringStorage::ReturnBlock</a></div><div class="ttdeci">BasicBlock * ReturnBlock</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00131">CoroInternal.h:131</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage_html_ad216a4effb4c2371f7d42c8a6364b4d8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1RetconLoweringStorage.html#ad216a4effb4c2371f7d42c8a6364b4d8">llvm::coro::Shape::RetconLoweringStorage::ResumePrototype</a></div><div class="ttdeci">Function * ResumePrototype</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00128">CoroInternal.h:128</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex_html_a6cd64bb9c0142cd60449abccc7627861a012dd1dc85c718e8159980fa4273d9e6"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a012dd1dc85c718e8159980fa4273d9e6">llvm::coro::Shape::SwitchFieldIndex::Resume</a></div><div class="ttdeci">@ Resume</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00098">CoroInternal.h:98</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex_html_a6cd64bb9c0142cd60449abccc7627861a0416e9f2fbff942bd66bfa6d7e759d47"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchFieldIndex.html#a6cd64bb9c0142cd60449abccc7627861a0416e9f2fbff942bd66bfa6d7e759d47">llvm::coro::Shape::SwitchFieldIndex::Destroy</a></div><div class="ttdeci">@ Destroy</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00107">CoroInternal.h:99</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_a443e8b3df70f81937afd7c6bf52f9f84"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#a443e8b3df70f81937afd7c6bf52f9f84">llvm::coro::Shape::SwitchLoweringStorage::HasFinalSuspend</a></div><div class="ttdeci">bool HasFinalSuspend</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00124">CoroInternal.h:124</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_ab9ff52a8227ec3fe5547af29ed59622f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ab9ff52a8227ec3fe5547af29ed59622f">llvm::coro::Shape::SwitchLoweringStorage::ResumeSwitch</a></div><div class="ttdeci">SwitchInst * ResumeSwitch</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00119">CoroInternal.h:119</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage_html_ae5f82081e3f2b39a7e795491bb5d7a6e"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape_1_1SwitchLoweringStorage.html#ae5f82081e3f2b39a7e795491bb5d7a6e">llvm::coro::Shape::SwitchLoweringStorage::ResumeEntryBlock</a></div><div class="ttdeci">BasicBlock * ResumeEntryBlock</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00121">CoroInternal.h:121</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html">llvm::coro::Shape</a></div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00088">CoroInternal.h:88</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a0a1a8e48ba1e5d845e979d5da8de597d"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a0a1a8e48ba1e5d845e979d5da8de597d">llvm::coro::Shape::FrameAlign</a></div><div class="ttdeci">Align FrameAlign</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00113">CoroInternal.h:113</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a1a578073d9d2487a3806e8a51abb1b6e"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a1a578073d9d2487a3806e8a51abb1b6e">llvm::coro::Shape::getResumeFunctionType</a></div><div class="ttdeci">FunctionType * getResumeFunctionType() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00171">CoroInternal.h:171</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a22c53726eaeafbc188994ecbc7e27674"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a22c53726eaeafbc188994ecbc7e27674">llvm::coro::Shape::getIndexType</a></div><div class="ttdeci">IntegerType * getIndexType() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00156">CoroInternal.h:156</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a24c5fed9b14aed8a3b4f3828472fbab5"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a24c5fed9b14aed8a3b4f3828472fbab5">llvm::coro::Shape::FrameTy</a></div><div class="ttdeci">StructType * FrameTy</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00112">CoroInternal.h:112</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a2acb69a078f9bb3184aa59c6d4966861"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a2acb69a078f9bb3184aa59c6d4966861">llvm::coro::Shape::getRetconCoroId</a></div><div class="ttdeci">AnyCoroIdRetconInst * getRetconCoroId() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00145">CoroInternal.h:145</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a2e44b079291a98a6f381ddc2f4e613d0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a2e44b079291a98a6f381ddc2f4e613d0">llvm::coro::Shape::getSwitchResumePointerType</a></div><div class="ttdeci">PointerType * getSwitchResumePointerType() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00165">CoroInternal.h:165</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a3660324b8035c8b52afd23e54623ddf8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a3660324b8035c8b52afd23e54623ddf8">llvm::coro::Shape::getSwitchCoroId</a></div><div class="ttdeci">CoroIdInst * getSwitchCoroId() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00140">CoroInternal.h:140</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a48b7ab2f26b9e2bc67de02229a1cdd1f"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a48b7ab2f26b9e2bc67de02229a1cdd1f">llvm::coro::Shape::CoroSizes</a></div><div class="ttdeci">SmallVector&lt; CoroSizeInst *, 2 &gt; CoroSizes</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00091">CoroInternal.h:91</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a4e2e134e22f7bd3f6270ef63546e9994"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a4e2e134e22f7bd3f6270ef63546e9994">llvm::coro::Shape::getResumeFunctionCC</a></div><div class="ttdeci">CallingConv::ID getResumeFunctionCC() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00206">CoroInternal.h:206</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a4e554c60419835fc3c74b91b28ca31c8"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a4e554c60419835fc3c74b91b28ca31c8">llvm::coro::Shape::ABI</a></div><div class="ttdeci">coro::ABI ABI</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00110">CoroInternal.h:110</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a5fd0aa934908c837c6d78097a2fd667b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a5fd0aa934908c837c6d78097a2fd667b">llvm::coro::Shape::CoroSuspends</a></div><div class="ttdeci">SmallVector&lt; AnyCoroSuspendInst *, 4 &gt; CoroSuspends</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00092">CoroInternal.h:92</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a742806b2e667a87817ae171e1ec59826"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a742806b2e667a87817ae171e1ec59826">llvm::coro::Shape::FrameSize</a></div><div class="ttdeci">uint64_t FrameSize</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00114">CoroInternal.h:114</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a78fa8f84df72aa178f82c9421b0cf387"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a78fa8f84df72aa178f82c9421b0cf387">llvm::coro::Shape::emitAlloc</a></div><div class="ttdeci">Value * emitAlloc(IRBuilder&lt;&gt; &amp;Builder, Value *Size, CallGraph *CG) const</div><div class="ttdoc">Allocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition</b> <a href="Coroutines_8cpp_source.html#l00498">Coroutines.cpp:498</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a7be03390074e7829c25074165141a797"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a7be03390074e7829c25074165141a797">llvm::coro::Shape::CoroEnds</a></div><div class="ttdeci">SmallVector&lt; CoroEndInst *, 4 &gt; CoroEnds</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00090">CoroInternal.h:90</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a897ca0443b61ca11b2da59e381e8a84a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a897ca0443b61ca11b2da59e381e8a84a">llvm::coro::Shape::SwiftErrorOps</a></div><div class="ttdeci">SmallVector&lt; CallInst *, 2 &gt; SwiftErrorOps</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00093">CoroInternal.h:93</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_a9e8a88398e176735a277b77269570c50"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#a9e8a88398e176735a277b77269570c50">llvm::coro::Shape::getIndex</a></div><div class="ttdeci">ConstantInt * getIndex(uint64_t Value) const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00161">CoroInternal.h:161</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abe8f7906a8618f90e2a75109a778054a"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abe8f7906a8618f90e2a75109a778054a">llvm::coro::Shape::SwitchLowering</a></div><div class="ttdeci">SwitchLoweringStorage SwitchLowering</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00136">CoroInternal.h:136</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_abfb56acef5d60fefb2edc417f0bfbda0"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#abfb56acef5d60fefb2edc417f0bfbda0">llvm::coro::Shape::CoroBegin</a></div><div class="ttdeci">CoroBeginInst * CoroBegin</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00089">CoroInternal.h:89</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ac91071b50ec814bdcb75af662c3b8b28"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ac91071b50ec814bdcb75af662c3b8b28">llvm::coro::Shape::getRetconResultTypes</a></div><div class="ttdeci">ArrayRef&lt; Type * &gt; getRetconResultTypes() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00184">CoroInternal.h:184</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_acad2aaa7f484c978bb790533eec90ac4"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#acad2aaa7f484c978bb790533eec90ac4">llvm::coro::Shape::emitDealloc</a></div><div class="ttdeci">void emitDealloc(IRBuilder&lt;&gt; &amp;Builder, Value *Ptr, CallGraph *CG) const</div><div class="ttdoc">Deallocate memory according to the rules of the active lowering.</div><div class="ttdef"><b>Definition</b> <a href="Coroutines_8cpp_source.html#l00519">Coroutines.cpp:519</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ace1508259ecd37ceaafb9162d3768fff"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ace1508259ecd37ceaafb9162d3768fff">llvm::coro::Shape::RetconLowering</a></div><div class="ttdeci">RetconLoweringStorage RetconLowering</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00137">CoroInternal.h:137</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_ae3a9a76ce45cff6c0385091993bccdcc"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#ae3a9a76ce45cff6c0385091993bccdcc">llvm::coro::Shape::AllocaSpillBlock</a></div><div class="ttdeci">BasicBlock * AllocaSpillBlock</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00116">CoroInternal.h:116</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_aedc5db661c24859142b1b7a67dc05ba7"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#aedc5db661c24859142b1b7a67dc05ba7">llvm::coro::Shape::getSwitchIndexField</a></div><div class="ttdeci">unsigned getSwitchIndexField() const</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00151">CoroInternal.h:151</a></div></div>
<div class="ttc" id="astructllvm_1_1coro_1_1Shape_html_af950c77cf595868197f7821aca30f89b"><div class="ttname"><a href="structllvm_1_1coro_1_1Shape.html#af950c77cf595868197f7821aca30f89b">llvm::coro::Shape::FramePtr</a></div><div class="ttdeci">Instruction * FramePtr</div><div class="ttdef"><b>Definition</b> <a href="CoroInternal_8h_source.html#l00115">CoroInternal.h:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 20 2024 14:01:55 for LLVM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
