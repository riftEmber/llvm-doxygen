<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/CodeGen/GCRootLowering.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LLVM<span id="projectnumber">&#160;19.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_1e8ad0574bd6e387992681ee57691a07.html">CodeGen</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">GCRootLowering.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="GCMetadata_8h_source.html">llvm/CodeGen/GCMetadata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MachineFrameInfo_8h_source.html">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MachineFunctionPass_8h_source.html">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MachineInstrBuilder_8h_source.html">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="CodeGen_2Passes_8h_source.html">llvm/CodeGen/Passes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TargetFrameLowering_8h_source.html">llvm/CodeGen/TargetFrameLowering.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TargetInstrInfo_8h_source.html">llvm/CodeGen/TargetInstrInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TargetRegisterInfo_8h_source.html">llvm/CodeGen/TargetRegisterInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="TargetSubtargetInfo_8h_source.html">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Dominators_8h_source.html">llvm/IR/Dominators.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IntrinsicInst_8h_source.html">llvm/IR/IntrinsicInst.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Module_8h_source.html">llvm/IR/Module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="InitializePasses_8h_source.html">llvm/InitializePasses.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MCContext_8h_source.html">llvm/MC/MCContext.h</a>&quot;</code><br />
</div>
<p><a href="GCRootLowering_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a755b4fb8450994d9125dbcd317bc4fc0" id="r_a755b4fb8450994d9125dbcd317bc4fc0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a755b4fb8450994d9125dbcd317bc4fc0">DoLowering</a> (<a class="el" href="classllvm_1_1Function.html">Function</a> &amp;<a class="el" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="el" href="classllvm_1_1GCStrategy.html">GCStrategy</a> &amp;S)</td></tr>
<tr class="memdesc:a755b4fb8450994d9125dbcd317bc4fc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lower barriers out of existence (if the associated GCStrategy hasn't already done so...), and insert initializing stores to roots as a defensive measure.  <br /></td></tr>
<tr class="separator:a755b4fb8450994d9125dbcd317bc4fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6a8fc5324b2cf8a0a85f04893fada09" id="r_af6a8fc5324b2cf8a0a85f04893fada09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6a8fc5324b2cf8a0a85f04893fada09">INITIALIZE_PASS_BEGIN</a> (LowerIntrinsics, &quot;gc-lowering&quot;, &quot;GC Lowering&quot;, false, false) <a class="el" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *llvm</td></tr>
<tr class="separator:af6a8fc5324b2cf8a0a85f04893fada09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ca4a195657130ed6e1819daa858a9f4" id="r_a6ca4a195657130ed6e1819daa858a9f4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ca4a195657130ed6e1819daa858a9f4">CouldBecomeSafePoint</a> (<a class="el" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="el" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</td></tr>
<tr class="memdesc:a6ca4a195657130ed6e1819daa858a9f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">CouldBecomeSafePoint - Predicate to conservatively determine whether the instruction could introduce a safe point.  <br /></td></tr>
<tr class="separator:a6ca4a195657130ed6e1819daa858a9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30fa2dcf27667bbd19dd20ccdac2ce96" id="r_a30fa2dcf27667bbd19dd20ccdac2ce96"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30fa2dcf27667bbd19dd20ccdac2ce96">InsertRootInitializers</a> (<a class="el" href="classllvm_1_1Function.html">Function</a> &amp;<a class="el" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classllvm_1_1AllocaInst.html">AllocaInst</a> * &gt; Roots)</td></tr>
<tr class="separator:a30fa2dcf27667bbd19dd20ccdac2ce96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d1d920446ddefc1569ffbe2485a31e" id="r_a46d1d920446ddefc1569ffbe2485a31e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46d1d920446ddefc1569ffbe2485a31e">INITIALIZE_PASS</a> (GCMachineCodeAnalysis, &quot;gc-analysis&quot;, &quot;Analyze <a class="el" href="COFFYAML_8cpp.html#a9dbc9c66cf3908e866b252feca6395a4">Machine</a> Code For Garbage Collection&quot;, false, false) GCMachineCodeAnalysis</td></tr>
<tr class="separator:a46d1d920446ddefc1569ffbe2485a31e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6ca4a195657130ed6e1819daa858a9f4" name="a6ca4a195657130ed6e1819daa858a9f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ca4a195657130ed6e1819daa858a9f4">&#9670;&#160;</a></span>CouldBecomeSafePoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classbool.html">bool</a> CouldBecomeSafePoint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1Instruction.html">Instruction</a> *</td>          <td class="paramname"><span class="paramname"><em>I</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CouldBecomeSafePoint - Predicate to conservatively determine whether the instruction could introduce a safe point. </p>

<p class="definition">Definition at line <a class="el" href="GCRootLowering_8cpp_source.html#l00137">137</a> of file <a class="el" href="GCRootLowering_8cpp_source.html">GCRootLowering.cpp</a>.</p>

<p class="reference">References <a class="el" href="Casting_8h_source.html#l00649">llvm::dyn_cast()</a>, <a class="el" href="MD5_8cpp_source.html#l00055">F</a>, <a class="el" href="MD5_8cpp_source.html#l00058">I</a>, and <a class="el" href="Casting_8h_source.html#l00548">llvm::isa()</a>.</p>

<p class="reference">Referenced by <a class="el" href="GCRootLowering_8cpp_source.html#l00163">InsertRootInitializers()</a>.</p>

</div>
</div>
<a id="a755b4fb8450994d9125dbcd317bc4fc0" name="a755b4fb8450994d9125dbcd317bc4fc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a755b4fb8450994d9125dbcd317bc4fc0">&#9670;&#160;</a></span>DoLowering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> DoLowering </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1Function.html">Function</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>F</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1GCStrategy.html">GCStrategy</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>S</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lower barriers out of existence (if the associated GCStrategy hasn't already done so...), and insert initializing stores to roots as a defensive measure. </p>
<p>Given we're going to report all roots live at all safepoints, we need to be able to ensure each root has been initialized by the point the first safepoint is reached. This really should have been done by the frontend, but the old API made this non-obvious, so we do a potentially redundant store just in case. </p>

<p class="definition">Definition at line <a class="el" href="GCRootLowering_8cpp_source.html#l00204">204</a> of file <a class="el" href="GCRootLowering_8cpp_source.html">GCRootLowering.cpp</a>.</p>

<p class="reference">References <a class="el" href="Casting_8h_source.html#l00565">llvm::cast()</a>, <a class="el" href="Casting_8h_source.html#l00649">llvm::dyn_cast()</a>, <a class="el" href="IR_2Instruction_8cpp_source.html#l00092">llvm::Instruction::eraseFromParent()</a>, <a class="el" href="MD5_8cpp_source.html#l00055">F</a>, <a class="el" href="InstrTypes_8h_source.html#l01410">llvm::CallBase::getArgOperand()</a>, <a class="el" href="InstrTypes_8h_source.html#l01465">llvm::CallBase::getCalledFunction()</a>, <a class="el" href="ilist__node_8h_source.html#l00132">llvm::ilist_node_impl&lt; OptionsT &gt;::getIterator()</a>, <a class="el" href="Value_8h_source.html#l00255">llvm::Value::getType()</a>, <a class="el" href="MD5_8cpp_source.html#l00058">I</a>, <a class="el" href="GCRootLowering_8cpp_source.html#l00163">InsertRootInitializers()</a>, <a class="el" href="STLExtras_8h_source.html#l00656">llvm::make_early_inc_range()</a>, <a class="el" href="SmallVector_8h_source.html#l00427">llvm::SmallVectorTemplateBase&lt; T, bool &gt;::push_back()</a>, <a class="el" href="Value_8cpp_source.html#l00534">llvm::Value::replaceAllUsesWith()</a>, <a class="el" href="SmallVector_8h_source.html#l00092">llvm::SmallVectorBase&lt; Size_T &gt;::size()</a>, <a class="el" href="Value_8cpp_source.html#l00694">llvm::Value::stripPointerCasts()</a>, and <a class="el" href="Value_8cpp_source.html#l00383">llvm::Value::takeName()</a>.</p>

<p class="reference">Referenced by <a class="el" href="GCRootLowering_8cpp_source.html#l00082">llvm::GCLoweringPass::run()</a>.</p>

</div>
</div>
<a id="a46d1d920446ddefc1569ffbe2485a31e" name="a46d1d920446ddefc1569ffbe2485a31e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46d1d920446ddefc1569ffbe2485a31e">&#9670;&#160;</a></span>INITIALIZE_PASS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INITIALIZE_PASS </td>
          <td>(</td>
          <td class="paramtype">GCMachineCodeAnalysis</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;gc-analysis&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Analyze <a class="el" href="COFFYAML_8cpp.html#a9dbc9c66cf3908e866b252feca6395a4">Machine</a> Code For Garbage Collection&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">false</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">false</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="GCRootLowering_8cpp_source.html#l00257">257</a> of file <a class="el" href="GCRootLowering_8cpp_source.html">GCRootLowering.cpp</a>.</p>

</div>
</div>
<a id="af6a8fc5324b2cf8a0a85f04893fada09" name="af6a8fc5324b2cf8a0a85f04893fada09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6a8fc5324b2cf8a0a85f04893fada09">&#9670;&#160;</a></span>INITIALIZE_PASS_BEGIN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INITIALIZE_PASS_BEGIN </td>
          <td>(</td>
          <td class="paramtype">LowerIntrinsics</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;gc-lowering&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;GC Lowering&quot;</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">false</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">false</td>          <td class="paramname"><span class="paramname"><em></em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="GCRootLowering_8cpp_source.html#l00100">100</a> of file <a class="el" href="GCRootLowering_8cpp_source.html">GCRootLowering.cpp</a>.</p>

</div>
</div>
<a id="a30fa2dcf27667bbd19dd20ccdac2ce96" name="a30fa2dcf27667bbd19dd20ccdac2ce96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30fa2dcf27667bbd19dd20ccdac2ce96">&#9670;&#160;</a></span>InsertRootInitializers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classbool.html">bool</a> InsertRootInitializers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classllvm_1_1Function.html">Function</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>F</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classllvm_1_1ArrayRef.html">ArrayRef</a>&lt; <a class="el" href="classllvm_1_1AllocaInst.html">AllocaInst</a> * &gt;</td>          <td class="paramname"><span class="paramname"><em>Roots</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="GCRootLowering_8cpp_source.html#l00163">163</a> of file <a class="el" href="GCRootLowering_8cpp_source.html">GCRootLowering.cpp</a>.</p>

<p class="reference">References <a class="el" href="Casting_8h_source.html#l00565">llvm::cast()</a>, <a class="el" href="GCRootLowering_8cpp_source.html#l00137">CouldBecomeSafePoint()</a>, <a class="el" href="SmallPtrSet_8h_source.html#l00412">llvm::SmallPtrSetImpl&lt; PtrType &gt;::count()</a>, <a class="el" href="Casting_8h_source.html#l00649">llvm::dyn_cast()</a>, <a class="el" href="MD5_8cpp_source.html#l00055">F</a>, <a class="el" href="Constants_8cpp_source.html#l01800">llvm::ConstantPointerNull::get()</a>, <a class="el" href="SmallPtrSet_8h_source.html#l00344">llvm::SmallPtrSetImpl&lt; PtrType &gt;::insert()</a>, and <a class="el" href="Casting_8h_source.html#l00548">llvm::isa()</a>.</p>

<p class="reference">Referenced by <a class="el" href="GCRootLowering_8cpp_source.html#l00204">DoLowering()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 1 2024 13:46:51 for LLVM by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
